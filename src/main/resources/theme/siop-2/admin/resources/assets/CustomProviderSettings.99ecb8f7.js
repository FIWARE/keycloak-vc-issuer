import{u as U,h as d,F as E,j as e,aB as k,ax as O,az as j,aA as L,l as q,r as _,g as z,aZ as C,P as R,q as F,b3 as B,cU as T,aD as G,aX as K,aC as W}from"./index.2ecf13ca.js";import{a as X,C as x,u as Z,F as N}from"./index.esm.68aaf060.js";import{D as $}from"./DynamicComponents.16b222ec.js";import{F as J}from"./FormAccess.7ed5d8eb.js";import{H as c}from"./HelpItem.49be9c4e.js";import{K as g}from"./KeycloakTextInput.97e36976.js";import{u as M}from"./useParams.921239aa.js";import{E as Q}from"./ExtendedHeader.b33bedff.js";import{S as Y}from"./SettingsCache.66c6a7d0.js";import{a as l,A as ee}from"./FormGroup.24d2e56a.js";import"./ClientSelect.95a4ec0e.js";import"./Select.5d6f6214.js";import"./check.51c67984.js";import"./star-icon.648ddb2a.js";import"./FileUpload.005327fa.js";import"./CodeEditor.0b7c4c70.js";import"./copy-icon.06155c15.js";import"./EmptyStateBody.25bf6e38.js";import"./EmptyStateSecondaryActions.3ed74a6a.js";import"./GroupPickerDialog.38947607.js";import"./ListEmptyState.94d606ed.js";import"./TableToolbar.f167c244.js";import"./plus-circle-icon.f1969120.js";import"./DataListItemRow.7402b99a.js";import"./data-list.f7ff2ea7.js";import"./grip-vertical-icon.6efe1939.js";import"./Modal.2c72168d.js";import"./ActionListItem.c90af00f.js";import"./FlexItem.2ee8dfc9.js";import"./minus-circle-icon.e9e185f2.js";import"./MultiLineInput.7867bd1a.js";import"./PasswordInput.4caf2dff.js";import"./useToggle.97c716af.js";import"./AddRoleMappingModal.c7175fba.js";import"./KeycloakDataTable.5c9a6c7c.js";import"./Td.ff2a9f66.js";import"./Checkbox.56efba4a.js";import"./useLocaleSort.377bcdf5.js";import"./resource.09062762.js";import"./joinPath.69b856b1.js";import"./filter-icon.f568e30b.js";import"./ConfirmDialog.b43fd344.js";import"./KeycloakTextArea.2947a089.js";import"./GridItem.a22d8cac.js";import"./ViewHeader.67577dd4.js";import"./Text.441b2f8e.js";import"./isEqual.7e8157bd.js";import"./NumberInput.71354005.js";import"./plus-icon.a1ecd1af.js";const re=()=>{const{t:r}=U("user-federation"),{control:o,register:t,watch:m}=X(),n=m("config.fullSyncPeriod","-1"),u=m("config.changedSyncPeriod","-1");return d(E,{children:[e(l,{label:r("periodicFullSync"),labelIcon:e(c,{helpText:"user-federation-help:periodicFullSyncHelp",fieldLabelId:"user-federation:periodicFullSync"}),fieldId:"kc-periodic-full-sync",hasNoPaddingTop:!0,children:e(x,{name:"config.fullSyncPeriod",defaultValue:"-1",control:o,render:({field:i})=>e(k,{id:"kc-periodic-full-sync","data-testid":"periodic-full-sync",onChange:s=>{i.onChange(s?"604800":"-1")},isChecked:i.value!=="-1",label:r("common:on"),labelOff:r("common:off"),"aria-label":r("periodicFullSync")})})}),n!=="-1"&&e(l,{hasNoPaddingTop:!0,label:r("fullSyncPeriod"),labelIcon:e(c,{helpText:"user-federation-help:fullSyncPeriodHelp",fieldLabelId:"user-federation:fullSyncPeriod"}),fieldId:"kc-full-sync-period",children:e(g,{type:"number",min:-1,defaultValue:"604800",id:"kc-full-sync-period","data-testid":"full-sync-period",...t("config.fullSyncPeriod")})}),e(l,{label:r("periodicChangedUsersSync"),labelIcon:e(c,{helpText:"user-federation-help:periodicChangedUsersSyncHelp",fieldLabelId:"user-federation:periodicChangedUsersSync"}),fieldId:"kc-periodic-changed-users-sync",hasNoPaddingTop:!0,children:e(x,{name:"config.changedSyncPeriod",defaultValue:"-1",control:o,render:({field:i})=>e(k,{id:"kc-periodic-changed-users-sync","data-testid":"periodic-changed-users-sync",onChange:s=>{i.onChange(s?"86400":"-1")},isChecked:i.value!=="-1",label:r("common:on"),labelOff:r("common:off"),"aria-label":r("periodicChangedUsersSync")})})}),u!=="-1"&&e(l,{label:r("changedUsersSyncPeriod"),labelIcon:e(c,{helpText:"user-federation-help:changedUsersSyncHelp",fieldLabelId:"user-federation:changedUsersSyncPeriod"}),fieldId:"kc-changed-users-sync-period",hasNoPaddingTop:!0,children:e(g,{type:"number",min:-1,defaultValue:"86400",id:"kc-changed-users-sync-period","data-testid":"changed-users-sync-period",...t("config.changedSyncPeriod")})})]})};function Me(){const{t:r}=U("user-federation"),{id:o,providerId:t}=M(),m=O(),n=Z({mode:"onChange"}),{register:u,reset:i,setValue:s,handleSubmit:S,formState:{errors:b,isDirty:A}}=n,{adminClient:p}=j(),{addAlert:w,addError:H}=L(),{realm:f}=q(),[D,V]=_.exports.useState(""),v=(z().componentTypes?.["org.keycloak.storage.UserStorageProvider"]||[]).find(a=>a.id===t);C(async()=>{if(o)return await p.components.findOne({id:o})},a=>{if(a)W(a,s);else if(o)throw new Error(r("common:notFound"))},[]),C(()=>p.realms.findOne({realm:f}),a=>V(a?.id),[]);const P=async a=>{const I=G({...a,config:Object.fromEntries(Object.entries(a.config||{}).map(([h,y])=>[h,Array.isArray(y)?y:[y]])),providerId:t,providerType:"org.keycloak.storage.UserStorageProvider",parentId:D});try{o?await p.components.update({id:o},I):(await p.components.create(I),m(T({realm:f}))),i({...a}),w(r(o?"saveSuccess":"createSuccess"),K.success)}catch(h){H(`user-federation:${o?"saveError":"createError"}`,h)}};return d(N,{...n,children:[e(Q,{provider:t,save:()=>S(P)()}),e(R,{variant:"light",children:d(J,{role:"manage-realm",isHorizontal:!0,className:"keycloak__user-federation__custom-form",onSubmit:S(P),children:[e(l,{label:r("uiDisplayName"),labelIcon:e(c,{helpText:"user-federation-help:uiDisplayNameHelp",fieldLabelId:"user-federation:uiDisplayName"}),helperTextInvalid:r("validateName"),validated:b.name?"error":"default",fieldId:"kc-ui-display-name",isRequired:!0,children:e(g,{isRequired:!0,id:"kc-ui-display-name","data-testid":"ui-name",validated:b.name?"error":"default",...u("name",{required:!0})})}),d(N,{...n,children:[e($,{properties:v?.properties||[]}),v?.metadata.synchronizable&&e(re,{})]}),e(Y,{form:n,unWrap:!0}),d(ee,{children:[e(F,{isDisabled:!A,variant:"primary",type:"submit","data-testid":"custom-save",children:r("common:save")}),e(F,{variant:"link",component:a=>e(B,{...a,to:T({realm:f})}),"data-testid":"custom-cancel",children:r("common:cancel")})]})]})})]})}export{Me as default};
//# sourceMappingURL=CustomProviderSettings.99ecb8f7.js.map
