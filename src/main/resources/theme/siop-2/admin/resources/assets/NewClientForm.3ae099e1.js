import{h as g,p as c,j as n,q as B,ad as H,bu as ze,bv as Ce,F as E,a5 as X,ag as xe,o as Q,_ as Y,r as _,s as ye,z as Te,u as Z,bH as Ie,l as ke,az as Be,ax as _e,aA as Le,P as Ae,bN as De,aD as Fe,aX as Ee,bM as We}from"./index.2ecf13ca.js";import{a as Oe,C as Pe,u as je,F as Me}from"./index.esm.68aaf060.js";import{F as ee}from"./FormAccess.7ed5d8eb.js";import{V as Ve}from"./ViewHeader.67577dd4.js";import{C as He,a as Ge}from"./ClientDescription.b8d8147e.js";import{T as Je,H as Ke}from"./HelpItem.49be9c4e.js";import{g as $e}from"./utils.988d95db.js";import{a as Re}from"./FormGroup.24d2e56a.js";import{S as Ue,b as qe,a as Xe}from"./Select.5d6f6214.js";import{L as Qe}from"./LoginSettings.09b94b6d.js";import{M as Ye,a as Ze}from"./Modal.2c72168d.js";import"./copy-icon.06155c15.js";import"./GridItem.a22d8cac.js";import"./Text.441b2f8e.js";import"./Checkbox.56efba4a.js";import"./check.51c67984.js";import"./KeycloakTextArea.2947a089.js";import"./KeycloakTextInput.97e36976.js";import"./star-icon.648ddb2a.js";import"./MultiLineInput.7867bd1a.js";import"./minus-circle-icon.e9e185f2.js";import"./plus-circle-icon.f1969120.js";const l={button:"pf-c-button",card:"pf-c-card",drawer:"pf-c-drawer",modalBox:"pf-c-modal-box",modifiers:{finished:"pf-m-finished",expanded:"pf-m-expanded",current:"pf-m-current",expandable:"pf-m-expandable",disabled:"pf-m-disabled",noPadding:"pf-m-no-padding"},pageMainWizard:"pf-c-page__main-wizard",themeDark:"pf-theme-dark",wizard:"pf-c-wizard",wizardClose:"pf-c-wizard__close",wizardDescription:"pf-c-wizard__description",wizardFooter:"pf-c-wizard__footer",wizardFooterCancel:"pf-c-wizard__footer-cancel",wizardHeader:"pf-c-wizard__header",wizardInnerWrap:"pf-c-wizard__inner-wrap",wizardMain:"pf-c-wizard__main",wizardMainBody:"pf-c-wizard__main-body",wizardNav:"pf-c-wizard__nav",wizardNavItem:"pf-c-wizard__nav-item",wizardNavLink:"pf-c-wizard__nav-link",wizardNavLinkText:"pf-c-wizard__nav-link-text",wizardNavLinkToggle:"pf-c-wizard__nav-link-toggle",wizardNavLinkToggleIcon:"pf-c-wizard__nav-link-toggle-icon",wizardNavList:"pf-c-wizard__nav-list",wizardOuterWrap:"pf-c-wizard__outer-wrap",wizardTitle:"pf-c-wizard__title",wizardToggle:"pf-c-wizard__toggle",wizardToggleIcon:"pf-c-wizard__toggle-icon",wizardToggleList:"pf-c-wizard__toggle-list",wizardToggleListItem:"pf-c-wizard__toggle-list-item",wizardToggleNum:"pf-c-wizard__toggle-num",wizardToggleSeparator:"pf-c-wizard__toggle-separator"},te=({onNext:o,onBack:r,onClose:d,isValid:t,firstStep:e,activeStep:a,nextButtonText:i,backButtonText:s,cancelButtonText:p})=>g("footer",{className:c(l.wizardFooter),children:[n(B,{variant:H.primary,type:"submit",onClick:o,isDisabled:!t,children:i}),!a.hideBackButton&&n(B,{variant:H.secondary,onClick:r,isDisabled:e,children:s}),!a.hideCancelButton&&n("div",{className:l.wizardFooterCancel,children:n(B,{variant:H.link,onClick:d,children:p})})]});te.displayName="WizardFooterInternal";const ae=({hasDrawer:o,wrapper:r,children:d})=>o?r(d):d;ae.displayName="WizardDrawerWrapper";const ne=({children:o,hasNoBodyPadding:r=!1,"aria-label":d,"aria-labelledby":t,mainComponent:e="div",hasDrawer:a,isDrawerExpanded:i,onExpandDrawer:s,activeStep:p})=>n(e,{"aria-label":d,"aria-labelledby":t,className:c(l.wizardMain),children:n(ae,{hasDrawer:a&&p.drawerPanelContent,wrapper:f=>n(ze,{isInline:!0,isExpanded:i,onExpand:s,children:n(Ce,{panelContent:p.drawerPanelContent,children:f})}),children:n("div",{className:c(l.wizardMainBody,r&&l.modifiers.noPadding),children:o})})});ne.displayName="WizardBody";const ie=({isNavOpen:o,onNavToggle:r,nav:d,steps:t,activeStep:e,children:a,hasNoBodyPadding:i=!1,"aria-label":s="Wizard Toggle",mainAriaLabelledBy:p=null,mainAriaLabel:m=null,isInPage:f=!0,hasDrawer:u,isDrawerExpanded:N,onExpandDrawer:x})=>{let b,z,v;for(let h=0;h<t.length;h++)if(e.id&&t[h].id===e.id||t[h].name===e.name){b=h+1,z=t[h].name;break}else if(t[h].steps){for(const T of t[h].steps)if(e.id&&T.id===e.id||T.name===e.name){b=h+1,z=t[h].name,v=T.name;break}}return g(E,{children:[g("button",{onClick:()=>r(!o),className:c(l.wizardToggle,o&&"pf-m-expanded"),"aria-label":s,"aria-expanded":o,children:[g("span",{className:c(l.wizardToggleList),children:[g("span",{className:c(l.wizardToggleListItem),children:[n("span",{className:c(l.wizardToggleNum),children:b})," ",z,v&&n(X,{className:c(l.wizardToggleSeparator),"aria-hidden":"true"})]}),v&&n("span",{className:c(l.wizardToggleListItem),children:v})]}),n("span",{className:c(l.wizardToggleIcon),children:n(xe,{"aria-hidden":"true"})})]}),g("div",{className:c(l.wizardOuterWrap),children:[g("div",{className:c(l.wizardInnerWrap),children:[d(o),g(ne,{mainComponent:f?"div":"main","aria-label":m,"aria-labelledby":p,hasNoBodyPadding:i,activeStep:e,isDrawerExpanded:N,onExpandDrawer:x,hasDrawer:u,children:[u&&!N&&e.drawerToggleButton,e.component]})]}),a]})]})};ie.displayName="WizardToggle";const P=({children:o,"aria-label":r,"aria-labelledby":d,isOpen:t=!1,returnList:e=!1,ouiaId:a,ouiaSafe:i=!0})=>{const s=Q(P.displayName,a,i),p=n("ol",{className:c(l.wizardNavList),children:o});return e?p:n("nav",{...Object.assign({className:c(l.wizardNav,t&&l.modifiers.expanded),"aria-label":r,"aria-labelledby":d},s),children:n("ol",{className:c(l.wizardNavList),children:o})})};P.displayName="WizardNav";const F=o=>{var{children:r=null,content:d="",isCurrent:t=!1,isDisabled:e=!1,step:a,onNavItemClick:i=()=>{},navItemComponent:s="button",href:p=null,isExpandable:m=!1,id:f,ouiaId:u,ouiaSafe:N=!0}=o,x=Y(o,["children","content","isCurrent","isDisabled","step","onNavItemClick","navItemComponent","href","isExpandable","id","ouiaId","ouiaSafe"]);const b=Q(F.displayName,u,N),z=s,[v,h]=_.exports.useState(!1);_.exports.useEffect(()=>{h(t)},[t]);const T={disabled:e},L={tabIndex:e?-1:void 0,href:p};return g("li",{className:c(l.wizardNavItem,m&&l.modifiers.expandable,m&&v&&l.modifiers.expanded),children:[n(z,{...Object.assign({},x,s==="a"?Object.assign({},L):Object.assign({},T),f&&{id:f.toString()},{onClick:()=>m?h(!v||t):i(a),className:c(l.wizardNavLink,t&&l.modifiers.current,e&&l.modifiers.disabled),"aria-disabled":e?!0:null,"aria-current":t&&!r?"step":!1},m&&{"aria-expanded":v},b),children:m?g(E,{children:[n("span",{className:c(l.wizardNavLinkText),children:d}),n("span",{className:c(l.wizardNavLinkToggle),children:n("span",{className:c(l.wizardNavLinkToggleIcon),children:n(X,{})})})]}):d}),r]})};F.displayName="WizardNavItem";const re=_.exports.createContext({goToStepById:()=>null,goToStepByName:()=>null,onNext:()=>null,onBack:()=>null,onClose:()=>null,activeStep:{name:null}}),et=re.Provider,tt=re.Consumer,se=({onClose:o=()=>{},title:r,description:d,hideClose:t,closeButtonAriaLabel:e,titleId:a,descriptionComponent:i="p",descriptionId:s})=>g("div",{className:c(l.wizardHeader),children:[!t&&n(B,{variant:"plain",className:c(l.wizardClose),"aria-label":e,onClick:o,children:n(ye,{"aria-hidden":"true"})}),n(Je,{headingLevel:"h2",size:"3xl",className:c(l.wizardTitle),"aria-label":r,id:a,children:r||n(E,{children:"\xA0"})}),d&&n(i,{className:c(l.wizardDescription),id:s,children:d})]});se.displayName="WizardHeader";class D extends _.exports.Component{constructor(r){super(r),this.handleKeyClicks=t=>{t.key===Te.Escape&&(this.state.isNavOpen?this.setState({isNavOpen:!this.state.isNavOpen}):this.props.isOpen&&this.props.onClose())},this.onNext=()=>{const{onNext:t,onClose:e,onSave:a}=this.props,{currentStep:i}=this.state,s=this.getFlattenedSteps(),p=s.length;if(i>=p)return a?a():e();{let m=i;for(let b=i;b<=p;b++){if(!s[b])return;if(!s[b].isDisabled){m=b+1;break}}this.setCurrentStep(m,s[m-1]);const{id:f,name:u}=s[i-1],{id:N,name:x}=s[m-1];return t&&t({id:N,name:x},{prevId:f,prevName:u})}},this.onBack=()=>{const{onBack:t}=this.props,{currentStep:e}=this.state,a=this.getFlattenedSteps();if(a.length<e){const i=a.length;this.setCurrentStep(i,a[i-1])}else{let i=e;for(let u=e;u>=0;u--){if(!a[u-2])return;if(!a[u-2].isDisabled){i=u-1<=1?1:u-1;break}}this.setCurrentStep(i,a[i-1]);const{id:s,name:p}=a[i],{id:m,name:f}=a[i-1];return t&&t({id:m,name:f},{prevId:s,prevName:p})}},this.goToStep=t=>{const e=this.getFlattenedSteps();if(e[t-1].isDisabled)return;const{onGoToStep:a}=this.props,{currentStep:i}=this.state,s=e.length;t<1?t=1:t>s&&(t=s),this.setCurrentStep(t,e[t-1]),this.setState({isNavOpen:!1});const{id:p,name:m}=e[i-1],{id:f,name:u}=e[t-1];return a&&a({id:f,name:u},{prevId:p,prevName:m})},this.goToStepById=t=>{const e=this.getFlattenedSteps();let a;for(let i=0;i<e.length;i++)if(e[i].id===t){a=i+1;break}a&&this.setCurrentStep(a,e[a-1])},this.goToStepByName=t=>{const e=this.getFlattenedSteps();let a;for(let i=0;i<e.length;i++)if(e[i].name===t){a=i+1;break}a&&this.setCurrentStep(a,e[a-1])},this.getFlattenedSteps=()=>{const{steps:t}=this.props,e=[];for(const a of t)if(a.steps)for(const i of a.steps)e.push(i);else e.push(a);return e},this.getFlattenedStepsIndex=(t,e)=>{for(let a=0;a<t.length;a++)if(t[a].name===e)return a+1;return 0},this.initSteps=t=>{for(let e=0;e<t.length;e++){if(t[e].steps)for(let a=0;a<t[e].steps.length;a++)t[e].steps[a]=Object.assign({canJumpTo:!0},t[e].steps[a]);t[e]=Object.assign({canJumpTo:!0},t[e])}return t},this.getElement=t=>typeof t=="function"?t():t||document.body;const d=D.currentId++;if(this.titleId=r.titleId||`pf-wizard-title-${d}`,this.descriptionId=r.descriptionId||`pf-wizard-description-${d}`,this.state={currentStep:this.props.startAtStep&&Number.isInteger(this.props.startAtStep)?this.props.startAtStep:1,isNavOpen:!1},r.onCurrentStepChanged){const t=this.getFlattenedSteps();if(t.length>=this.state.currentStep){const e=t[this.state.currentStep-1];r.onCurrentStepChanged(e)}}this.drawerRef=_.exports.createRef()}setCurrentStep(r,d){this.setState({currentStep:r}),this.props.onCurrentStepChanged&&this.props.onCurrentStepChanged(d)}componentDidMount(){const r=typeof document<"u"?document.body:null;r&&r.addEventListener("keydown",this.handleKeyClicks,!1)}componentWillUnmount(){const r=typeof document<"u"&&document.body||null;r&&r.removeEventListener("keydown",this.handleKeyClicks,!1)}componentDidUpdate(r){r.startAtStep!==this.props.startAtStep&&this.setState({currentStep:this.props.startAtStep})}render(){const r=this.props,{width:d,height:t,title:e,description:a,descriptionComponent:i,onClose:s,onSave:p,onBack:m,onNext:f,onGoToStep:u,className:N,steps:x,startAtStep:b,nextButtonText:z="Next",backButtonText:v="Back",cancelButtonText:h="Cancel",hideClose:T,closeButtonAriaLabel:L="Close",navAriaLabel:C,navAriaLabelledBy:I,mainAriaLabel:j,mainAriaLabelledBy:W,hasNoBodyPadding:le,footer:de,appendTo:nt,isOpen:M,titleId:it,descriptionId:rt,isNavExpandable:ce,onCurrentStepChanged:st,hasDrawer:pe,isDrawerExpanded:me,onExpandDrawer:ue}=r,he=Y(r,["width","height","title","description","descriptionComponent","onClose","onSave","onBack","onNext","onGoToStep","className","steps","startAtStep","nextButtonText","backButtonText","cancelButtonText","hideClose","closeButtonAriaLabel","navAriaLabel","navAriaLabelledBy","mainAriaLabel","mainAriaLabelledBy","hasNoBodyPadding","footer","appendTo","isOpen","titleId","descriptionId","isNavExpandable","onCurrentStepChanged","hasDrawer","isDrawerExpanded","onExpandDrawer"]),{currentStep:G}=this.state,k=this.getFlattenedSteps(),fe=k.length<G?k.length:G,w=k[fe-1],ge=this.initSteps(x),be=w===k[0],we=w&&w.enableNext!==void 0?w.enableNext:!0,Se=V=>{const $={isOpen:V,"aria-label":C,"aria-labelledby":(e||I)&&(I||this.titleId)};return n(P,{...Object.assign({},$),children:ge.map((S,R)=>{if(S.isFinishedStep)return;let O,A;if(S.steps){let U=!1,q=!1;for(const y of S.steps)w.name===y.name&&(U=!0),y.canJumpTo&&(q=!0);return A=this.getFlattenedStepsIndex(k,S.steps[0].name),n(F,{id:S.id,content:S.name,isExpandable:ce,isCurrent:U,isDisabled:!q,step:A,onNavItemClick:this.goToStep,children:n(P,{...Object.assign({},$,{returnList:!0}),children:S.steps.map((y,ve)=>{if(!y.isFinishedStep)return A=this.getFlattenedStepsIndex(k,y.name),O=y.canJumpTo&&!y.isDisabled,n(F,{id:y.id,content:y.name,isCurrent:w.name===y.name,isDisabled:!O,step:A,onNavItemClick:this.goToStep},`child_${ve}`)})})},R)}return A=this.getFlattenedStepsIndex(k,S.name),O=S.canJumpTo&&!S.isDisabled,n(F,{...Object.assign({},S.stepNavItemProps,{key:R,id:S.id,content:S.name,isCurrent:w.name===S.name,isDisabled:!O,step:A,onNavItemClick:this.goToStep})})})})},Ne={goToStepById:this.goToStepById,goToStepByName:this.goToStepByName,onNext:this.onNext,onBack:this.onBack,onClose:s,activeStep:w},J=Object.assign(Object.assign({},t?{height:t}:{}),d?{width:d}:{}),K=n(et,{value:Ne,children:g("div",{...Object.assign({},he,{className:c(l.wizard,w&&w.isFinishedStep&&"pf-m-finished",N),style:Object.keys(J).length?J:void 0}),children:[e&&n(se,{titleId:this.titleId,descriptionId:this.descriptionId,onClose:s,title:e,description:a,descriptionComponent:i,closeButtonAriaLabel:L,hideClose:T}),n(ie,{hasDrawer:pe,isDrawerExpanded:me,onExpandDrawer:ue,mainAriaLabel:j,isInPage:M===void 0,mainAriaLabelledBy:(e||W)&&(W||this.titleId),isNavOpen:this.state.isNavOpen,onNavToggle:V=>this.setState({isNavOpen:V}),nav:Se,steps:x,activeStep:w,hasNoBodyPadding:le,children:de||n(te,{onNext:this.onNext,onBack:this.onBack,onClose:s,isValid:we,firstStep:be,activeStep:w,nextButtonText:w&&w.nextButtonText||z,backButtonText:v,cancelButtonText:h})})]})});return M!==void 0?n(Ye,{width:d!==null?d:void 0,isOpen:M,variant:Ze.large,"aria-labelledby":this.titleId,"aria-describedby":this.descriptionId,showClose:!1,hasNoBodyWrapper:!0,children:K}):K}}D.displayName="Wizard";D.currentId=0;D.defaultProps={title:null,description:"",descriptionComponent:"p",className:"",startAtStep:1,nextButtonText:"Next",backButtonText:"Back",cancelButtonText:"Cancel",hideClose:!1,closeButtonAriaLabel:"Close",navAriaLabel:null,navAriaLabelledBy:null,mainAriaLabel:null,mainAriaLabelledBy:null,hasNoBodyPadding:!1,onBack:null,onNext:null,onGoToStep:null,width:null,height:null,footer:null,onClose:()=>{},appendTo:null,isOpen:void 0,isNavExpandable:!1,hasDrawer:!1,isDrawerExpanded:!1,onExpandDrawer:()=>{}};const oe=({children:o})=>n("footer",{className:c(l.wizardFooter),children:o});oe.displayName="WizardFooter";const at=()=>{const{t:o}=Z("clients"),{control:r,formState:{errors:d}}=Oe(),t=Ie(),[e,a]=_.exports.useState(!1);return g(ee,{isHorizontal:!0,role:"manage-clients",children:[n(Re,{label:o("clientType"),fieldId:"kc-type",validated:d.protocol?"error":"default",labelIcon:n(Ke,{helpText:"clients-help:clientType",fieldLabelId:"clients:clientType"}),children:n(Pe,{name:"protocol",defaultValue:"",control:r,render:({field:i})=>n(Ue,{id:"kc-type",onToggle:a,onSelect:(s,p)=>{i.onChange(p.toString()),a(!1)},selections:i.value,variant:qe.single,"aria-label":o("selectEncryptionType"),isOpen:e,children:t.map(s=>n(Xe,{selected:s===i.value,value:s,"data-testid":`option-${s}`,children:$e(o,s)},s))})})}),n(He,{hasConfigureAccess:!0})]})};function Bt(){const{t:o}=Z("clients"),{realm:r}=ke(),{adminClient:d}=Be(),t=_e(),[e,a]=_.exports.useState(0),{addAlert:i,addError:s}=Le(),p=je({defaultValues:{protocol:"openid-connect",clientId:"",name:"",description:"",publicClient:!0,authorizationServicesEnabled:!1,serviceAccountsEnabled:!1,implicitFlowEnabled:!1,directAccessGrantsEnabled:!0,standardFlowEnabled:!0,frontchannelLogout:!0,attributes:{saml_idp_initiated_sso_url_name:""}}}),{getValues:m,watch:f,trigger:u}=p,N=f("protocol"),x=async()=>{const C=Fe(m());try{const I=await d.clients.create({...C,clientId:C.clientId?.trim()});i(o("createSuccess"),Ee.success),t(We({realm:r,clientId:I.id,tab:"settings"}))}catch(I){s("clients:createError",I)}},b=async C=>{!await u()||(z()||a(e+1),C?.())},z=()=>N==="openid-connect"?e===2:e===1,v=()=>{a(e-1)},h=C=>{C.id==="generalSettings"?a(0):C.id==="capabilityConfig"?a(1):a(2)},T=()=>n(oe,{children:n(tt,{children:({activeStep:C,onNext:I,onBack:j,onClose:W})=>g(E,{children:[n(B,{variant:"primary","data-testid":z()?"save":"next",type:"submit",onClick:()=>{b(I)},children:z()?o("common:save"):o("common:next")}),n(B,{variant:"secondary","data-testid":"back",onClick:()=>{v(),j()},isDisabled:C.name===o("generalSettings"),children:o("common:back")}),n(B,{"data-testid":"cancel",variant:"link",onClick:W,children:o("common:cancel")})]})})}),L=o("createClient");return g(E,{children:[n(Ve,{titleKey:"clients:createClient",subKey:"clients:clientsExplain"}),n(Ae,{variant:"light",children:n(Me,{...p,children:n(D,{onClose:()=>t(De({realm:r})),navAriaLabel:`${L} steps`,mainAriaLabel:`${L} content`,steps:[{id:"generalSettings",name:o("generalSettings"),component:n(at,{})},...N!=="saml"?[{id:"capabilityConfig",name:o("capabilityConfig"),component:n(Ge,{protocol:N}),canJumpTo:e>=1}]:[],{id:"loginSettings",name:o("loginSettings"),component:n(ee,{isHorizontal:!0,role:"manage-clients",children:n(Qe,{protocol:N})}),canJumpTo:e>=1}],footer:n(T,{}),onSave:x,onGoToStep:h})})})]})}export{Bt as default};
//# sourceMappingURL=NewClientForm.3ae099e1.js.map
