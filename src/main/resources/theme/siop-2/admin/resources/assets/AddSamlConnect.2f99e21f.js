import{a as P,u as T,F as A}from"./index.esm.1e7ace95.js";import{u as b,az as S,l as E,h as m,F,j as e,m as C,b5 as k,b6 as w,ax as D,aA as V,P as j,q as y,b3 as H,cw as U,aX as g,cx as $}from"./index.7cbfb18a.js";import{F as q}from"./FormAccess.3a7ea209.js";import{V as z}from"./ViewHeader.083cd951.js";import{T as L,H as h}from"./HelpItem.719382e8.js";import{F as G}from"./FileUploadForm.ebfa6eb7.js";import{K}from"./KeycloakTextInput.9afb01cd.js";import{D as O}from"./DiscoveryEndpointField.540a892d.js";import{D as B,S as N}from"./SamlGeneralSettings.25e6527b.js";import{a as I,A as R}from"./FormGroup.60c77f60.js";import"./copy-icon.dbf95270.js";import"./GridItem.63e5e367.js";import"./Text.28ece842.js";import"./FileUpload.c211f5c1.js";import"./CodeEditor.5b99e2f5.js";import"./EmptyStateBody.1533f3a6.js";import"./EmptyStateSecondaryActions.511adeb0.js";import"./Modal.11970fe7.js";import"./discovery-settings.6bf57500.js";import"./ExpandableSection.0b0d95f4.js";import"./Select.fbe867d5.js";import"./check.51c67984.js";import"./star-icon.a6efdd26.js";import"./NumberInput.619d2bbb.js";import"./plus-icon.f70ae4c8.js";import"./DisplayOrder.b6d3afed.js";const _=()=>{const{t}=b("identity-providers"),p="saml",{adminClient:a}=S(),{realm:n}=E(),{setValue:u,register:v,setError:l,clearErrors:c,formState:{errors:i}}=P(),f=r=>{Object.entries(r).map(([d,s])=>u(`config.${d}`,s))},o=async r=>{if(c("discoveryError"),!r)return;const d=new FormData;d.append("providerId",p),d.append("file",new Blob([r]));try{const s=await fetch(`${k(a.baseUrl)}admin/realms/${n}/identity-provider/import-config`,{method:"POST",body:d,headers:w(await a.getAccessToken())});if(s.ok){const x=await s.json();f(x)}else l("discoveryError",{type:"manual",message:s.statusText})}catch(s){l("discoveryError",{type:"manual",message:s.message})}};return m(F,{children:[e(L,{headingLevel:"h4",size:"xl",className:"kc-form-panel__title",children:t("samlSettings")}),e(I,{label:t("serviceProviderEntityId"),fieldId:"kc-service-provider-entity-id",labelIcon:e(h,{helpText:"identity-providers-help:serviceProviderEntityId",fieldLabelId:"identity-providers:serviceProviderEntityId"}),isRequired:!0,helperTextInvalid:t("common:required"),validated:i.config?.entityId?"error":"default",children:e(K,{"data-testid":"serviceProviderEntityId",id:"kc-service-provider-entity-id",validated:i.config?.entityId?"error":"default",defaultValue:`${C.authServerUrl}/realms/${n}`,...v("config.entityId",{required:!0})})}),e(O,{id:"saml",fileUpload:e(I,{label:t("importConfig"),fieldId:"kc-import-config",labelIcon:e(h,{helpText:"identity-providers-help:importConfig",fieldLabelId:"identity-providers:importConfig"}),validated:i.discoveryError?"error":"default",helperTextInvalid:i.discoveryError?.message,children:e(G,{id:"kc-import-config",extension:".xml",hideDefaultPreview:!0,unWrap:!0,validated:i.discoveryError?"error":"default",onChange:r=>o(r)})}),children:r=>e(B,{readOnly:r})})]})};function Ie(){const{t}=b("identity-providers"),p=D(),a="saml",n=T({defaultValues:{alias:a,config:{allowCreate:"true"}}}),{handleSubmit:u,formState:{isDirty:v}}=n,{adminClient:l}=S(),{addAlert:c}=V(),{realm:i}=E(),f=async o=>{delete o.discoveryEndpoint;try{await l.identityProviders.create({...o,providerId:a}),c(t("createSuccess"),g.success),p($({realm:i,providerId:a,alias:o.alias,tab:"settings"}))}catch(r){c(t("createError",{error:r.response?.data?.errorMessage||r}),g.danger)}};return m(F,{children:[e(z,{titleKey:t("addSamlProvider")}),e(j,{variant:"light",children:e(A,{...n,children:m(q,{role:"manage-identity-providers",isHorizontal:!0,onSubmit:u(f),children:[e(N,{id:a}),e(_,{}),m(R,{children:[e(y,{isDisabled:!v,variant:"primary",type:"submit","data-testid":"createProvider",children:t("common:add")}),e(y,{variant:"link","data-testid":"cancel",component:o=>e(H,{...o,to:U({realm:i})}),children:t("common:cancel")})]})]})})})]})}export{Ie as default};
//# sourceMappingURL=AddSamlConnect.2f99e21f.js.map
