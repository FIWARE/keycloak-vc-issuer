import{u as v,ax as x,az as D,l as E,r as b,aZ as L,j as s,K as k,h as n,P as w,aB as K,F as j,b3 as H,bS as P}from"./index.2ecf13ca.js";import{H as _}from"./HelpItem.49be9c4e.js";import{u as A}from"./useLocaleSort.377bcdf5.js";import{u as B}from"./ConfirmDialog.b43fd344.js";import{T as G}from"./Trans.1ed7a62f.js";import{C as p}from"./Card.3271e4cd.js";import{C as g}from"./CardTitle.ab8f9378.js";import{C as d}from"./CardBody.8e0a3a4b.js";import{F as M,a as $}from"./FormGroup.24d2e56a.js";import{T as z,a as O,b as C,c as T,d as R,e as u,M as U}from"./Td.ff2a9f66.js";const is=({id:a,type:m})=>{const{t:i}=v("common"),y=x(),{adminClient:r}=D(),{realm:t}=E(),[h,F]=b.exports.useState(""),[l,c]=b.exports.useState(),S=A(),f=e=>{switch(m){case"clients":return r.clients.updateFineGrainPermission({id:a},{enabled:e});case"users":return r.realms.updateUsersManagementPermissions({realm:t,enabled:e});case"groups":return r.groups.updatePermission({id:a},{enabled:e});case"roles":return r.roles.updatePermission({id:a},{enabled:e});case"identityProviders":return r.identityProviders.updatePermission({alias:a},{enabled:e})}};L(()=>Promise.all([r.clients.find({search:!0,clientId:t==="master"?"master-realm":"realm-management"}),(()=>{switch(m){case"clients":return r.clients.listFineGrainPermissions({id:a});case"users":return r.realms.getUsersManagementPermissions({realm:t});case"groups":return r.groups.listPermissions({id:a});case"roles":return r.roles.listPermissions({id:a});case"identityProviders":return r.identityProviders.listPermissions({alias:a})}})()]),([e,o])=>{F(e[0]?.id),c(o)},[]);const[I,N]=B({titleKey:"common:permissionsDisable",messageKey:"common:permissionsDisableConfirm",continueButtonLabel:"common:confirm",onConfirm:async()=>{const e=await f(!1);c(e)}});return l?n(w,{variant:"light",children:[s(N,{}),n(p,{isFlat:!0,children:[s(g,{children:i("permissions")}),n(d,{children:[i(`${m}PermissionsHint`),s(M,{isHorizontal:!0,className:"pf-u-pt-md",children:s($,{hasNoPaddingTop:!0,className:"permission-label",label:i("permissionsEnabled"),fieldId:"permissionsEnabled",labelIcon:s(_,{helpText:"clients-help:permissionsEnabled",fieldLabelId:"clients:permissionsEnabled"}),children:s(K,{id:"permissionsEnabled","data-testid":"permissionSwitch",label:i("common:on"),labelOff:i("common:off"),isChecked:l.enabled,onChange:async e=>{if(e){const o=await f(e);c(o)}else I()},"aria-label":i("permissionsEnabled")})})})]})]}),l.enabled&&n(j,{children:[n(p,{isFlat:!0,className:"pf-u-mt-lg",children:[s(g,{children:i("permissionsList")}),s(d,{children:n(G,{i18nKey:"common:permissionsListIntro",children:[" ",s("strong",{children:{realm:t==="master"?"master-realm":"realm-management"}}),"."]})})]}),s(p,{isFlat:!0,className:"keycloak__permission__permission-table",children:s(d,{className:"pf-u-p-0",children:n(z,{"aria-label":i("permissionsList"),variant:"compact",children:[s(O,{children:n(C,{children:[s(T,{id:"permissionsScopeName",children:i("permissionsScopeName")}),s(T,{id:"description",children:i("description")})]})}),s(R,{children:S(Object.entries(l.scopePermissions||{}),([e])=>e).map(([e,o])=>n(C,{children:[s(u,{children:s(H,{to:P({realm:t,id:h,permissionType:"scope",permissionId:o}),children:e})}),s(u,{children:i(`scopePermissions.${m}.${e}-description`)}),s(u,{isActionCell:!0,children:s(U,{items:[{title:i("common:edit"),onClick(){y(P({realm:t,id:h,permissionType:"scope",permissionId:o}))}}]})})]},o))})]})})})]})]}):s(k,{})};export{is as P};
//# sourceMappingURL=PermissionTab.8539997c.js.map
