import{u as j,az as q,aA as G,r as b,ax as H,l as L,g as _,bK as N,aZ as $,ad as z,aX as F,h as u,F as U,j as o,ao as X,P as Z,aw as l,q as S,b3 as J,bL as Q,bG as W,bM as Y,aD as ee,aC as oe}from"./index.7cbfb18a.js";import{u as te,F as re}from"./index.esm.1e7ace95.js";import{u as ae}from"./ConfirmDialog.4dc691c5.js";import{D as pe}from"./DynamicComponents.7f569784.js";import{F as ie}from"./FormAccess.3a7ea209.js";import{H as ne}from"./HelpItem.719382e8.js";import{K as T}from"./KeycloakTextInput.9afb01cd.js";import{V as se}from"./ViewHeader.083cd951.js";import{u as me}from"./useParams.3f76335e.js";import{a as C,A as ce}from"./FormGroup.60c77f60.js";import"./Modal.11970fe7.js";import"./ClientSelect.2d31aa2e.js";import"./Select.fbe867d5.js";import"./check.51c67984.js";import"./star-icon.a6efdd26.js";import"./FileUpload.c211f5c1.js";import"./CodeEditor.5b99e2f5.js";import"./copy-icon.dbf95270.js";import"./EmptyStateBody.1533f3a6.js";import"./EmptyStateSecondaryActions.511adeb0.js";import"./GroupPickerDialog.174f65c8.js";import"./ListEmptyState.fef0510e.js";import"./TableToolbar.51ae2a5f.js";import"./plus-circle-icon.aa8a939a.js";import"./DataListItemRow.df3ed5f3.js";import"./data-list.f7ff2ea7.js";import"./grip-vertical-icon.7e109111.js";import"./ActionListItem.65cb5d9a.js";import"./FlexItem.ae9c1d3c.js";import"./minus-circle-icon.c093f419.js";import"./MultiLineInput.091fd21a.js";import"./PasswordInput.aa539188.js";import"./useToggle.461e82f2.js";import"./AddRoleMappingModal.c8e6830c.js";import"./KeycloakDataTable.ae870e97.js";import"./Td.1e0c90e7.js";import"./Checkbox.7d63c785.js";import"./useLocaleSort.b8a659bb.js";import"./resource.2cd5a37e.js";import"./joinPath.69b856b1.js";import"./filter-icon.a9b0a5f3.js";import"./KeycloakTextArea.d98120cb.js";import"./GridItem.63e5e367.js";import"./Text.28ece842.js";function oo(){const{t}=j("client-scopes"),{adminClient:i}=q(),{addAlert:f,addError:g}=G(),{id:r,mapperId:a}=me(),y=te(),{register:I,setValue:D,formState:{errors:h},handleSubmit:P}=y,[d,x]=b.exports.useState(),[A,V]=b.exports.useState(),k=H(),{realm:M}=L(),w=_(),E=/^[{]?[0-9a-fA-F]{8}-([0-9a-fA-F]{4}-){3}[0-9a-fA-F]{12}[}]?$/,s=!!a.match(E),m=!!N(Q.path),v=()=>m?W({realm:M,id:r,tab:"mappers"}):Y({realm:M,clientId:r,tab:"mappers"});$(async()=>{let e;if(s){if(m?e=await i.clientScopes.findProtocolMapper({id:r,mapperId:a}):e=await i.clients.findProtocolMapperById({id:r,mapperId:a}),!e)throw new Error(t("common:notFound"));const p=w.protocolMapperTypes[e.protocol].find(c=>c.id===e.protocolMapper);return{config:{protocol:e.protocol,protocolMapper:e.protocolMapper},mapping:p,data:e}}else{const n=m?await i.clientScopes.findOne({id:r}):await i.clients.findOne({id:r});if(!n)throw new Error(t("common:notFound"));const c=w.protocolMapperTypes[n.protocol].find(R=>R.id===a);if(!c)throw new Error(t("common:notFound"));return{mapping:c,config:{protocol:n.protocol,protocolMapper:a}}}},({config:e,mapping:n,data:p})=>{V(e),x(n),p&&oe(p,D)},[]);const[K,O]=ae({titleKey:"common:deleteMappingTitle",messageKey:"common:deleteMappingConfirm",continueButtonLabel:"common:delete",continueButtonVariant:z.danger,onConfirm:async()=>{try{m?await i.clientScopes.delProtocolMapper({id:r,mapperId:a}):await i.clients.delProtocolMapper({id:r,mapperId:a}),f(t("common:mappingDeletedSuccess"),F.success),k(v())}catch(e){g("common:mappingDeletedError",e)}}}),B=async e=>{const n=s?"Updated":"Created";try{const p={...A,...ee(e)};s?m?await i.clientScopes.updateProtocolMapper({id:r,mapperId:a},{id:a,...p}):await i.clients.updateProtocolMapper({id:r,mapperId:a},{id:a,...p}):m?await i.clientScopes.addProtocolMapper({id:r},p):await i.clients.addProtocolMapper({id:r},p),f(t(`common:mapping${n}Success`),F.success)}catch(p){g(`common:mapping${n}Error`,p)}};return u(U,{children:[o(O,{}),o(se,{titleKey:s?d?.name:t("common:addMapper"),subKey:s?a:"client-scopes:addMapperExplain",dropdownItems:s?[o(X,{value:"delete",onClick:K,children:t("common:delete")},"delete")]:void 0}),o(Z,{variant:"light",children:u(ie,{isHorizontal:!0,onSubmit:P(B),role:"manage-clients",className:"keycloak__client-scope-mapping-details__form",children:[o(C,{label:t("common:mapperType"),fieldId:"mapperType",children:o(T,{type:"text",id:"mapperType",name:"mapperType",isReadOnly:!0,value:d?.name})}),o(C,{label:t("common:name"),labelIcon:o(ne,{helpText:"client-scopes-help:mapperName",fieldLabelId:"name"}),fieldId:"name",isRequired:!0,validated:h.name?l.error:l.default,helperTextInvalid:t("common:required"),children:o(T,{id:"name",isReadOnly:s,validated:h.name?l.error:l.default,...I("name",{required:!0})})}),o(re,{...y,children:o(pe,{properties:d?.properties||[]})}),u(ce,{children:[o(S,{variant:"primary",type:"submit",children:t("common:save")}),o(S,{variant:"link",component:e=>o(J,{...e,to:v()}),children:t("common:cancel")})]})]})})]})}export{oo as default};
//# sourceMappingURL=MappingDetails.cef3948f.js.map
