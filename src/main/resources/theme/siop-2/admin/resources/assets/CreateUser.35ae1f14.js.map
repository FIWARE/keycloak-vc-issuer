{"version":3,"file":"CreateUser.35ae1f14.js","sources":["../../src/user/CreateUser.tsx"],"sourcesContent":["import type GroupRepresentation from \"@keycloak/keycloak-admin-client/lib/defs/groupRepresentation\";\nimport type UserRepresentation from \"@keycloak/keycloak-admin-client/lib/defs/userRepresentation\";\nimport { AlertVariant, PageSection } from \"@patternfly/react-core\";\nimport { useState } from \"react\";\nimport { FormProvider, useForm } from \"react-hook-form\";\nimport { useTranslation } from \"react-i18next\";\nimport { useNavigate } from \"react-router-dom\";\n\nimport { useAlerts } from \"../components/alert/Alerts\";\nimport { ViewHeader } from \"../components/view-header/ViewHeader\";\nimport { useAdminClient } from \"../context/auth/AdminClient\";\nimport { useRealm } from \"../context/realm-context/RealmContext\";\nimport { UserProfileProvider } from \"../realm-settings/user-profile/UserProfileContext\";\nimport { toUser } from \"./routes/User\";\nimport { UserForm } from \"./UserForm\";\nimport {\n  isUserProfileError,\n  userProfileErrorToString,\n} from \"./UserProfileFields\";\n\nimport \"./user-section.css\";\n\nexport default function CreateUser() {\n  const { t } = useTranslation(\"users\");\n  const { addAlert, addError } = useAlerts();\n  const navigate = useNavigate();\n  const { adminClient } = useAdminClient();\n  const { realm } = useRealm();\n  const userForm = useForm<UserRepresentation>({ mode: \"onChange\" });\n  const [addedGroups, setAddedGroups] = useState<GroupRepresentation[]>([]);\n\n  const save = async (formUser: UserRepresentation) => {\n    try {\n      const createdUser = await adminClient.users.create({\n        ...formUser,\n        username: formUser.username?.trim(),\n        groups: addedGroups.map((group) => group.path!),\n        enabled: true,\n      });\n\n      addAlert(t(\"userCreated\"), AlertVariant.success);\n      navigate(toUser({ id: createdUser.id, realm, tab: \"settings\" }));\n    } catch (error) {\n      if (isUserProfileError(error)) {\n        addError(userProfileErrorToString(error), error);\n      } else {\n        addError(\"users:userCreateError\", error);\n      }\n    }\n  };\n\n  return (\n    <>\n      <ViewHeader\n        titleKey={t(\"createUser\")}\n        className=\"kc-username-view-header\"\n      />\n      <PageSection variant=\"light\" className=\"pf-u-p-0\">\n        <UserProfileProvider>\n          <FormProvider {...userForm}>\n            <PageSection variant=\"light\">\n              <UserForm onGroupsUpdate={setAddedGroups} save={save} />\n            </PageSection>\n          </FormProvider>\n        </UserProfileProvider>\n      </PageSection>\n    </>\n  );\n}\n"],"names":["CreateUser","t","useTranslation","addAlert","addError","useAlerts","navigate","useNavigate","adminClient","useAdminClient","realm","useRealm","userForm","useForm","mode","addedGroups","setAddedGroups","useState","save","formUser","createdUser","users","create","username","trim","groups","map","group","path","enabled","AlertVariant","success","toUser","id","tab","error","isUserProfileError","userProfileErrorToString","_Fragment","_jsx","ViewHeader","PageSection","UserProfileProvider","FormProvider","UserForm"],"mappings":"w0CAsBA,SAAwBA,IAAa,CAC7B,KAAA,CAAEC,CAAAA,EAAMC,EAAe,OAAO,EAC9B,CAAEC,SAAAA,EAAUC,SAAAA,GAAaC,EAAW,EACpCC,EAAWC,IACX,CAAEC,YAAAA,GAAgBC,EAAgB,EAClC,CAAEC,MAAAA,GAAUC,EAAU,EACtBC,EAAWC,EAA4B,CAAEC,KAAM,UAAA,CAAY,EAC3D,CAACC,EAAaC,CAAc,EAAIC,EAAAA,QAAAA,SAAgC,CAAE,CAAA,EAElEC,EAAO,MAAOC,GAAiC,CAC/C,GAAA,CACF,MAAMC,EAAc,MAAMZ,EAAYa,MAAMC,OAAO,CACjD,GAAGH,EACHI,SAAUJ,EAASI,UAAUC,KAAM,EACnCC,OAAQV,EAAYW,IAAKC,GAAUA,EAAMC,IAAK,EAC9CC,QAAS,EAAA,CACV,EAED1B,EAASF,EAAE,aAAa,EAAG6B,EAAaC,OAAO,EAC/CzB,EAAS0B,EAAO,CAAEC,GAAIb,EAAYa,GAAIvB,MAAAA,EAAOwB,IAAK,UAAY,CAAA,CAAC,QACxDC,GACHC,EAAmBD,CAAK,EACjBE,EAAAA,EAAyBF,CAAK,EAAGA,CAAK,EAE/C/B,EAAS,wBAAyB+B,CAAK,CAE3C,CAAA,EAGF,SACEG,EAAA,CAAA,SAAA,CACEC,EAACC,EAAU,CACT,SAAUvC,EAAE,YAAY,EACxB,UAAU,yBAAA,CACV,EACFsC,EAACE,EAAW,CAAC,QAAQ,QAAQ,UAAU,WAAU,WAC9CC,EAAmB,CAAA,WACjBC,EAAY,CAAA,GAAK/B,EAAQ,WACvB6B,EAAW,CAAC,QAAQ,QAAO,WACzBG,EAAQ,CAAC,eAAgB5B,EAAgB,KAAAE,CAAA,CAAW,CAAA,CAAG,CAAA,CAC5C,CAAA,CACD,CAAA,CAEL,CAAA,CAAA,CACb,CAEP"}