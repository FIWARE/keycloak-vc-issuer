import{u as M,az as C,aA as x,r as E,aE as D,h,P as I,j as e,aB as R,F as v,G as P,aX as A,ax as F,aZ as H,K,c1 as b,co as w}from"./index.7cbfb18a.js";import{M as L}from"./MapperList.69f09839.js";import{R as O,u as j}from"./RoutableTabs.58e36a71.js";import{V as k}from"./ViewHeader.083cd951.js";import{u as G}from"./useParams.3f76335e.js";import{F as N}from"./FormAccess.3a7ea209.js";import{H as V}from"./HelpItem.719382e8.js";import{R as z}from"./AddRoleMappingModal.c8e6830c.js";import{a as B}from"./FormGroup.60c77f60.js";import{T,a as y}from"./Tabs.fae3d04f.js";import"./ListEmptyState.fef0510e.js";import"./TableToolbar.51ae2a5f.js";import"./EmptyStateSecondaryActions.511adeb0.js";import"./EmptyStateBody.1533f3a6.js";import"./plus-circle-icon.aa8a939a.js";import"./KeycloakDataTable.ae870e97.js";import"./Td.1e0c90e7.js";import"./star-icon.a6efdd26.js";import"./check.51c67984.js";import"./grip-vertical-icon.7e109111.js";import"./Checkbox.7d63c785.js";import"./Modal.11970fe7.js";import"./useLocaleSort.b8a659bb.js";import"./Text.28ece842.js";import"./DataListItemRow.df3ed5f3.js";import"./data-list.f7ff2ea7.js";import"./index.esm.1e7ace95.js";import"./copy-icon.dbf95270.js";import"./GridItem.63e5e367.js";import"./resource.2cd5a37e.js";import"./joinPath.69b856b1.js";import"./filter-icon.a9b0a5f3.js";import"./ConfirmDialog.4dc691c5.js";import"./plus-icon.f70ae4c8.js";import"./MenuList.22670a64.js";const X=({client:d})=>{const{t:s}=M("clients"),{adminClient:r}=C(),{addAlert:m,addError:c}=x(),[t,f]=E.exports.useState(d),{hasAccess:i}=D(),u=i("manage-clients")||t.access?.manage,S=async l=>{try{const n=l.filter(a=>a.client===void 0).map(a=>a.role).flat();await Promise.all([r.clients.addRealmScopeMappings({id:t.id},n),...l.filter(a=>a.client!==void 0).map(a=>r.clients.addClientScopeMappings({id:t.id,client:a.client.id},[a.role]))]),m(s("clientScopeSuccess"),A.success)}catch(n){c("clients:clientScopeError",n)}},g=async()=>{const l={...t,fullScopeAllowed:!t.fullScopeAllowed};try{await r.clients.update({id:t.id},l),m(s("clientScopeSuccess"),A.success),f(l)}catch(n){c("clients:clientScopeError",n)}};return h(I,{children:[e(N,{role:"manage-clients",fineGrainedAccess:t.access?.manage,isHorizontal:!0,children:e(B,{hasNoPaddingTop:!0,label:s("fullScopeAllowed"),labelIcon:e(V,{helpText:"clients-help:fullScopeAllowed",fieldLabelId:"clients:fullScopeAllowed"}),fieldId:"fullScopeAllowed",children:e(R,{id:"fullScopeAllowed",label:s("common:on"),labelOff:s("common:off"),isChecked:t.fullScopeAllowed,onChange:g,"aria-label":s("fullScopeAllowed")})})}),!t.fullScopeAllowed&&h(v,{children:[e(P,{}),e(z,{name:t.clientId,id:t.id,type:"clients",save:S,isManager:u})]})]})};function Ee(){const{t:d}=M("clients"),s=F(),{realm:r,clientId:m}=G(),{adminClient:c}=C(),{addAlert:t,addError:f}=x(),[i,u]=E.exports.useState();H(()=>c.clients.findOne({id:m}),u,[]);const S=o=>j(b({realm:r,clientId:m,tab:o})),g=S("mappers"),l=S("scope");if(!i)return e(K,{});const n=async o=>{if(Array.isArray(o))try{await c.clients.addMultipleProtocolMappers({id:i.id},o),u(await c.clients.findOne({id:i.id})),t(d("common:mappingCreatedSuccess"),A.success)}catch(p){f("common:mappingCreatedError",p)}else{const p=o;s(w({realm:r,id:i.id,mapperId:p.id}))}},a=async o=>{try{await c.clients.delProtocolMapper({id:i.id,mapperId:o.id}),u({...i,protocolMappers:i.protocolMappers?.filter(p=>p.id!==o.id)}),t(d("common:mappingDeletedSuccess"),A.success)}catch(p){f("common:mappingDeletedError",p)}return!0};return h(v,{children:[e(k,{titleKey:i.clientId,subKey:"clients-help:dedicatedScopeExplain",divider:!1}),e(I,{variant:"light",className:"pf-u-p-0",children:h(O,{isBox:!0,mountOnEnter:!0,defaultLocation:b({realm:r,clientId:m,tab:"mappers"}),children:[e(T,{title:e(y,{children:d("mappers")}),"data-testid":"mappersTab",...g,children:e(L,{model:i,onAdd:n,onDelete:a,detailLink:o=>w({realm:r,id:i.id,mapperId:o})})}),e(T,{title:e(y,{children:d("scope")}),"data-testid":"scopeTab",...l,children:e(X,{client:i})})]})})]})}export{Ee as default};
//# sourceMappingURL=DedicatedScopes.a2d28c1e.js.map
