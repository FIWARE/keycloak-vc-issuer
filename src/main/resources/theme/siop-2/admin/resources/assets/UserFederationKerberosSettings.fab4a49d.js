import{b as q,C as g,u as x,F as C}from"./index.esm.68aaf060.js";import{u as k,az as T,l as y,r as A,aZ as P,h as l,F,j as e,aB as v,ax as H,aA as L,P as S,q as I,cU as D,aX as N}from"./index.2ecf13ca.js";import{u as O}from"./useParams.921239aa.js";import{F as E}from"./FormAccess.7ed5d8eb.js";import{H as d}from"./HelpItem.49be9c4e.js";import{K as u}from"./KeycloakTextInput.97e36976.js";import{W as V,H as K,S as M}from"./SettingsCache.66c6a7d0.js";import{i as U}from"./isEqual.7e8157bd.js";import{a as n,F as $,A as j}from"./FormGroup.24d2e56a.js";import{S as z,b as W,a as w}from"./Select.5d6f6214.js";import"./copy-icon.06155c15.js";import"./GridItem.a22d8cac.js";import"./ConfirmDialog.b43fd344.js";import"./Modal.2c72168d.js";import"./ViewHeader.67577dd4.js";import"./Text.441b2f8e.js";import"./useToggle.97c716af.js";import"./NumberInput.71354005.js";import"./plus-icon.a1ecd1af.js";import"./check.51c67984.js";import"./star-icon.648ddb2a.js";const Y=({form:r,showSectionHeading:i=!1,showSectionDescription:p=!1})=>{const{t:a}=k("user-federation"),{t:m}=k("user-federation-help"),{adminClient:o}=T(),{realm:f}=y(),[h,c]=A.exports.useState(!1),b=q({control:r.control,name:"config.allowPasswordAuthentication"});return P(()=>o.realms.findOne({realm:f}),t=>r.setValue("parentId",t.id),[]),l(F,{children:[i&&e(V,{title:a("requiredSettings"),description:m("kerberosRequiredSettingsDescription"),showDescription:p}),l(E,{role:"manage-realm",isHorizontal:!0,children:[l(n,{label:a("uiDisplayName"),labelIcon:e(d,{helpText:"user-federation-help:uiDisplayNameHelp",fieldLabelId:"user-federation:uiDisplayName"}),fieldId:"kc-ui-display-name",isRequired:!0,validated:r.formState.errors.name?"error":"default",helperTextInvalid:r.formState.errors.name?.message,children:[e(u,{hidden:!0,id:"kc-ui-providerId",defaultValue:"kerberos",...r.register("providerId")}),e(u,{hidden:!0,id:"kc-ui-providerType",defaultValue:"org.keycloak.storage.UserStorageProvider",...r.register("providerType")}),e(u,{hidden:!0,id:"kc-ui-parentId",defaultValue:f,...r.register("parentId")}),e(u,{isRequired:!0,id:"kc-ui-name","data-testid":"kerberos-name",validated:r.formState.errors.name?"error":"default","aria-label":a("uiDisplayName"),...r.register("name",{required:{value:!0,message:a("validateName")}})})]}),e(n,{label:a("kerberosRealm"),labelIcon:e(d,{helpText:"user-federation-help:kerberosRealmHelp",fieldLabelId:"user-federation:kc-kerberos-realm"}),fieldId:"kc-kerberos-realm",isRequired:!0,validated:r.formState.errors.config?.kerberosRealm?.[0]?"error":"default",helperTextInvalid:r.formState.errors.config?.kerberosRealm?.[0].message,children:e(u,{isRequired:!0,id:"kc-kerberos-realm","data-testid":"kerberos-realm",validated:r.formState.errors.config?.kerberosRealm?.[0]?"error":"default",...r.register("config.kerberosRealm.0",{required:{value:!0,message:a("validateRealm")}})})}),e(n,{label:a("serverPrincipal"),labelIcon:e(d,{helpText:"user-federation-help:serverPrincipalHelp",fieldLabelId:"user-federation:serverPrincipal"}),fieldId:"kc-server-principal",isRequired:!0,validated:r.formState.errors.config?.serverPrincipal?.[0]?"error":"default",helperTextInvalid:r.formState.errors.config?.serverPrincipal?.[0].message,children:e(u,{isRequired:!0,id:"kc-server-principal","data-testid":"kerberos-principal",validated:r.formState.errors.config?.serverPrincipal?.[0]?"error":"default",...r.register("config.serverPrincipal.0",{required:{value:!0,message:a("validateServerPrincipal")}})})}),e(n,{label:a("keyTab"),labelIcon:e(d,{helpText:"user-federation-help:keyTabHelp",fieldLabelId:"user-federation:keyTab"}),fieldId:"kc-key-tab",isRequired:!0,validated:r.formState.errors.config?.keyTab?.[0]?"error":"default",helperTextInvalid:r.formState.errors.config?.keyTab?.[0].message,children:e(u,{isRequired:!0,id:"kc-key-tab","data-testid":"kerberos-keytab",validated:r.formState.errors.config?.keyTab?.[0]?"error":"default",...r.register("config.keyTab.0",{required:{value:!0,message:a("validateKeyTab")}})})}),l(n,{label:a("debug"),labelIcon:e(d,{helpText:"user-federation-help:debugHelp",fieldLabelId:"user-federation:debug"}),fieldId:"kc-debug",hasNoPaddingTop:!0,children:[" ",e(g,{name:"config.debug",defaultValue:["false"],control:r.control,render:({field:t})=>e(v,{id:"kc-debug","data-testid":"debug",onChange:s=>t.onChange([`${s}`]),isChecked:t.value?.[0]==="true",label:a("common:on"),labelOff:a("common:off"),"aria-label":a("debug")})})]}),e(n,{label:a("allowPasswordAuthentication"),labelIcon:e(d,{helpText:"user-federation-help:allowPasswordAuthenticationHelp",fieldLabelId:"user-federation:allowPasswordAuthentication"}),fieldId:"kc-allow-password-authentication",hasNoPaddingTop:!0,children:e(g,{name:"config.allowPasswordAuthentication",defaultValue:["false"],control:r.control,render:({field:t})=>e(v,{id:"kc-allow-password-authentication","data-testid":"allow-password-authentication",onChange:s=>t.onChange([`${s}`]),isChecked:t.value?.[0]==="true",label:a("common:on"),labelOff:a("common:off"),"aria-label":a("allowPasswordAuthentication")})})}),U(b,["true"])?l(n,{label:a("editMode"),labelIcon:e(d,{helpText:"user-federation-help:editModeKerberosHelp",fieldLabelId:"user-federation:editMode"}),isRequired:!0,fieldId:"kc-edit-mode",children:[" ",e(g,{name:"config.editMode[0]",defaultValue:"READ_ONLY",control:r.control,rules:{required:!0},render:({field:t})=>l(z,{toggleId:"kc-edit-mode",required:!0,onToggle:()=>c(!h),isOpen:h,onSelect:(s,R)=>{t.onChange(R),c(!1)},selections:t.value,variant:W.single,children:[e(w,{value:"READ_ONLY",isPlaceholder:!0},0),e(w,{value:"UNSYNCED"},1)]})})]}):null,e(n,{label:a("updateFirstLogin"),labelIcon:e(d,{helpText:"user-federation-help:updateFirstLoginHelp",fieldLabelId:"user-federation:updateFirstLogin"}),fieldId:"kc-update-first-login",hasNoPaddingTop:!0,children:e(g,{name:"config.updateProfileFirstLogin",defaultValue:["false"],control:r.control,render:({field:t})=>e(v,{id:"kc-update-first-login","data-testid":"update-first-login",onChange:s=>t.onChange([`${s}`]),isChecked:t.value?.[0]==="true",label:a("common:on"),labelOff:a("common:off"),"aria-label":a("updateFirstLogin")})})})]})]})};function fe(){const{t:r}=k("user-federation"),i=x({mode:"onChange"}),p=H(),{adminClient:a}=T(),{realm:m}=y(),{id:o}=O(),{addAlert:f,addError:h}=L();P(async()=>{if(o)return a.components.findOne({id:o})},t=>{if(t)c(t);else if(o)throw new Error(r("common:notFound"))},[]);const c=t=>{i.reset({...t})},b=async t=>{try{o?await a.components.update({id:o},t):(await a.components.create(t),p(`/${m}/user-federation`)),c(t),f(r(o?"saveSuccess":"createSuccess"),N.success)}catch(s){h(`user-federation:${o?"saveError":"createError"}`,s)}};return l(F,{children:[e(C,{...i,children:e(K,{provider:"Kerberos",save:()=>i.handleSubmit(b)()})}),e(S,{variant:"light",children:e(Y,{form:i,showSectionHeading:!0})}),l(S,{variant:"light",isFilled:!0,children:[e(M,{form:i,showSectionHeading:!0}),e($,{onSubmit:i.handleSubmit(b),children:l(j,{children:[e(I,{isDisabled:!i.formState.isDirty,variant:"primary",type:"submit","data-testid":"kerberos-save",children:r("common:save")}),e(I,{variant:"link",onClick:()=>p(D({realm:m})),"data-testid":"kerberos-cancel",children:r("common:cancel")})]})})]})]})}export{fe as default};
//# sourceMappingURL=UserFederationKerberosSettings.fab4a49d.js.map
