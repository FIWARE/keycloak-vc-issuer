import{u as U,h as d,F as E,j as e,aB as k,ax as O,az as j,aA as L,l as q,r as _,g as z,aZ as C,P as R,q as F,b3 as B,cU as T,aD as G,aX as K,aC as W}from"./index.7cbfb18a.js";import{a as X,C as x,u as Z,F as N}from"./index.esm.1e7ace95.js";import{D as $}from"./DynamicComponents.7f569784.js";import{F as J}from"./FormAccess.3a7ea209.js";import{H as c}from"./HelpItem.719382e8.js";import{K as g}from"./KeycloakTextInput.9afb01cd.js";import{u as M}from"./useParams.3f76335e.js";import{E as Q}from"./ExtendedHeader.419e5275.js";import{S as Y}from"./SettingsCache.cbce1b12.js";import{a as l,A as ee}from"./FormGroup.60c77f60.js";import"./ClientSelect.2d31aa2e.js";import"./Select.fbe867d5.js";import"./check.51c67984.js";import"./star-icon.a6efdd26.js";import"./FileUpload.c211f5c1.js";import"./CodeEditor.5b99e2f5.js";import"./copy-icon.dbf95270.js";import"./EmptyStateBody.1533f3a6.js";import"./EmptyStateSecondaryActions.511adeb0.js";import"./GroupPickerDialog.174f65c8.js";import"./ListEmptyState.fef0510e.js";import"./TableToolbar.51ae2a5f.js";import"./plus-circle-icon.aa8a939a.js";import"./DataListItemRow.df3ed5f3.js";import"./data-list.f7ff2ea7.js";import"./grip-vertical-icon.7e109111.js";import"./Modal.11970fe7.js";import"./ActionListItem.65cb5d9a.js";import"./FlexItem.ae9c1d3c.js";import"./minus-circle-icon.c093f419.js";import"./MultiLineInput.091fd21a.js";import"./PasswordInput.aa539188.js";import"./useToggle.461e82f2.js";import"./AddRoleMappingModal.c8e6830c.js";import"./KeycloakDataTable.ae870e97.js";import"./Td.1e0c90e7.js";import"./Checkbox.7d63c785.js";import"./useLocaleSort.b8a659bb.js";import"./resource.2cd5a37e.js";import"./joinPath.69b856b1.js";import"./filter-icon.a9b0a5f3.js";import"./ConfirmDialog.4dc691c5.js";import"./KeycloakTextArea.d98120cb.js";import"./GridItem.63e5e367.js";import"./ViewHeader.083cd951.js";import"./Text.28ece842.js";import"./isEqual.c47179ef.js";import"./NumberInput.619d2bbb.js";import"./plus-icon.f70ae4c8.js";const re=()=>{const{t:r}=U("user-federation"),{control:o,register:t,watch:m}=X(),n=m("config.fullSyncPeriod","-1"),u=m("config.changedSyncPeriod","-1");return d(E,{children:[e(l,{label:r("periodicFullSync"),labelIcon:e(c,{helpText:"user-federation-help:periodicFullSyncHelp",fieldLabelId:"user-federation:periodicFullSync"}),fieldId:"kc-periodic-full-sync",hasNoPaddingTop:!0,children:e(x,{name:"config.fullSyncPeriod",defaultValue:"-1",control:o,render:({field:i})=>e(k,{id:"kc-periodic-full-sync","data-testid":"periodic-full-sync",onChange:s=>{i.onChange(s?"604800":"-1")},isChecked:i.value!=="-1",label:r("common:on"),labelOff:r("common:off"),"aria-label":r("periodicFullSync")})})}),n!=="-1"&&e(l,{hasNoPaddingTop:!0,label:r("fullSyncPeriod"),labelIcon:e(c,{helpText:"user-federation-help:fullSyncPeriodHelp",fieldLabelId:"user-federation:fullSyncPeriod"}),fieldId:"kc-full-sync-period",children:e(g,{type:"number",min:-1,defaultValue:"604800",id:"kc-full-sync-period","data-testid":"full-sync-period",...t("config.fullSyncPeriod")})}),e(l,{label:r("periodicChangedUsersSync"),labelIcon:e(c,{helpText:"user-federation-help:periodicChangedUsersSyncHelp",fieldLabelId:"user-federation:periodicChangedUsersSync"}),fieldId:"kc-periodic-changed-users-sync",hasNoPaddingTop:!0,children:e(x,{name:"config.changedSyncPeriod",defaultValue:"-1",control:o,render:({field:i})=>e(k,{id:"kc-periodic-changed-users-sync","data-testid":"periodic-changed-users-sync",onChange:s=>{i.onChange(s?"86400":"-1")},isChecked:i.value!=="-1",label:r("common:on"),labelOff:r("common:off"),"aria-label":r("periodicChangedUsersSync")})})}),u!=="-1"&&e(l,{label:r("changedUsersSyncPeriod"),labelIcon:e(c,{helpText:"user-federation-help:changedUsersSyncHelp",fieldLabelId:"user-federation:changedUsersSyncPeriod"}),fieldId:"kc-changed-users-sync-period",hasNoPaddingTop:!0,children:e(g,{type:"number",min:-1,defaultValue:"86400",id:"kc-changed-users-sync-period","data-testid":"changed-users-sync-period",...t("config.changedSyncPeriod")})})]})};function Me(){const{t:r}=U("user-federation"),{id:o,providerId:t}=M(),m=O(),n=Z({mode:"onChange"}),{register:u,reset:i,setValue:s,handleSubmit:S,formState:{errors:b,isDirty:A}}=n,{adminClient:p}=j(),{addAlert:w,addError:H}=L(),{realm:f}=q(),[D,V]=_.exports.useState(""),v=(z().componentTypes?.["org.keycloak.storage.UserStorageProvider"]||[]).find(a=>a.id===t);C(async()=>{if(o)return await p.components.findOne({id:o})},a=>{if(a)W(a,s);else if(o)throw new Error(r("common:notFound"))},[]),C(()=>p.realms.findOne({realm:f}),a=>V(a?.id),[]);const P=async a=>{const I=G({...a,config:Object.fromEntries(Object.entries(a.config||{}).map(([h,y])=>[h,Array.isArray(y)?y:[y]])),providerId:t,providerType:"org.keycloak.storage.UserStorageProvider",parentId:D});try{o?await p.components.update({id:o},I):(await p.components.create(I),m(T({realm:f}))),i({...a}),w(r(o?"saveSuccess":"createSuccess"),K.success)}catch(h){H(`user-federation:${o?"saveError":"createError"}`,h)}};return d(N,{...n,children:[e(Q,{provider:t,save:()=>S(P)()}),e(R,{variant:"light",children:d(J,{role:"manage-realm",isHorizontal:!0,className:"keycloak__user-federation__custom-form",onSubmit:S(P),children:[e(l,{label:r("uiDisplayName"),labelIcon:e(c,{helpText:"user-federation-help:uiDisplayNameHelp",fieldLabelId:"user-federation:uiDisplayName"}),helperTextInvalid:r("validateName"),validated:b.name?"error":"default",fieldId:"kc-ui-display-name",isRequired:!0,children:e(g,{isRequired:!0,id:"kc-ui-display-name","data-testid":"ui-name",validated:b.name?"error":"default",...u("name",{required:!0})})}),d(N,{...n,children:[e($,{properties:v?.properties||[]}),v?.metadata.synchronizable&&e(re,{})]}),e(Y,{form:n,unWrap:!0}),d(ee,{children:[e(F,{isDisabled:!A,variant:"primary",type:"submit","data-testid":"custom-save",children:r("common:save")}),e(F,{variant:"link",component:a=>e(B,{...a,to:T({realm:f})}),"data-testid":"custom-cancel",children:r("common:cancel")})]})]})})]})}export{Me as default};
//# sourceMappingURL=CustomProviderSettings.cbc39124.js.map
