import{e as la,h as o,F as Z,j as e,ac as Bt,p as ia,U as Tt,az as se,r as m,aZ as Ce,u as F,l as le,aA as me,P as ee,cE as ut,aB as Q,q as N,bP as lt,cF as ra,b3 as fe,c2 as oa,aX as te,g as _e,G as je,ad as ae,aC as xe,bz as at,b5 as Pt,ax as $e,K as Ae,bE as Xe,cG as gt,cD as Gt,af as ca,ae as zt,am as _t,aG as da,ao as Ye,cH as ma,aw as he,cI as Te,bh as wt,T as dt,bO as ua,bQ as Ze,L as st,cJ as At,cK as pa,cL as ft,cM as ha,cN as ga,cO as fa,cP as Rt,cQ as ba,cR as va,cS as Dt,cT as Nt,R as ya,cU as Ot,al as Sa,ay as jt,c8 as pt,a3 as Mt,t as Ta,m as Ca,b1 as ka,an as Ia,aD as xa}from"./index.2ecf13ca.js";import{u as La}from"./useParams.921239aa.js";import{u as be,b as Ie,C as R,F as Ct,a as $t}from"./index.esm.68aaf060.js";import{u as ue}from"./ConfirmDialog.b43fd344.js";import{R as it,u as rt}from"./RoutableTabs.ce00f00c.js";import{F as bt,V as Ea}from"./ViewHeader.67577dd4.js";import{u as qt,F as Wt}from"./useIsFeatureEnabled.d8b1daf2.js";import{F as Y,b as Pa,S as Jt,a as Pe}from"./FormAccess.7ed5d8eb.js";import{H as P,c as ye,a as Xt,f as wa,T as Qt,b as Aa,P as Ra}from"./HelpItem.49be9c4e.js";import{K as re}from"./KeycloakTextInput.97e36976.js";import{P as Da}from"./PasswordInput.4caf2dff.js";import{F as ce}from"./FormPanel.3fe898ae.js";import{u as Be}from"./useToggle.97c716af.js";/* empty css                               */import{f as Kt,a as b,A as ve,F as kt}from"./FormGroup.24d2e56a.js";import{C as vt}from"./Checkbox.56efba4a.js";import{a as ht}from"./ActionListItem.c90af00f.js";import{K as Ve,T as Na,m as Oa,n as Ma}from"./KeycloakDataTable.5c9a6c7c.js";import{L as we,P as Ka}from"./ListEmptyState.94d606ed.js";import{M as Ge,a as ze}from"./Modal.2c72168d.js";import{T as J,t as Va}from"./TimeSelector.ba2ee1d5.js";import{S as de,b as ge,a as ne,e as Vt}from"./Select.5d6f6214.js";import{i as Yt}from"./isEqual.7e8157bd.js";import{b as It,T as B,a as G}from"./Tabs.3b19dcd9.js";import{K as Fa}from"./KeyValueInput.8d334a75.js";import{y as Ft,ag as Ue,L as Ua,al as Ha,am as Ba,an as Ga}from"./Td.ff2a9f66.js";import{F as Zt}from"./filter-icon.f568e30b.js";import{D as ea}from"./DraggableTable.12d5d25c.js";import{KeyProviderForm as za}from"./KeyProviderForm.db74dc64.js";import{T as Ke,a as _a}from"./Text.441b2f8e.js";import{J as ja}from"./JsonFileUpload.060aa7cc.js";import{e as $a,D as qa,a as Wa,c as Ja,d as Xa}from"./DataListItemRow.7402b99a.js";import{F as ta,a as He}from"./FlexItem.2ee8dfc9.js";import{R as ot}from"./Radio.9cf26071.js";import{C as xt,L as Lt}from"./CodeEditor.0b7c4c70.js";import{T as ct}from"./Trans.1ed7a62f.js";import{N as yt}from"./NumberInput.71354005.js";import{u as Et,U as Qa}from"./UserProfileContext.1a5ea02c.js";import{R as Ya}from"./AddRoleMappingModal.c7175fba.js";import{G as Za}from"./GroupPickerDialog.38947607.js";import{Q as en}from"./question-circle-icon.cdbe36b5.js";import"./copy-icon.06155c15.js";import"./GridItem.a22d8cac.js";import"./CardHeader.2467be54.js";import"./Card.3271e4cd.js";import"./CardTitle.ab8f9378.js";import"./CardBody.8e0a3a4b.js";import"./check.51c67984.js";import"./EmptyStateBody.25bf6e38.js";import"./TableToolbar.f167c244.js";import"./EmptyStateSecondaryActions.3ed74a6a.js";import"./plus-circle-icon.f1969120.js";import"./star-icon.648ddb2a.js";import"./plus-icon.a1ecd1af.js";import"./MenuList.32e086d6.js";import"./minus-circle-icon.e9e185f2.js";import"./grip-vertical-icon.6efe1939.js";import"./data-list.f7ff2ea7.js";import"./DynamicComponents.16b222ec.js";import"./ClientSelect.95a4ec0e.js";import"./FileUpload.005327fa.js";import"./MultiLineInput.7867bd1a.js";import"./KeycloakTextArea.2947a089.js";import"./useLocaleSort.377bcdf5.js";import"./resource.09062762.js";import"./joinPath.69b856b1.js";import"./FileUploadForm.e2de83e5.js";function tn(a,n){return n=typeof n=="function"?n:void 0,a&&a.length?la(a,void 0,n):[]}const St=({value:a,rowIndex:n,cellIndex:t,props:s,handleTextInputChange:l,inputAriaLabel:r,isDisabled:d=!1})=>o(Z,{children:[e("div",{className:Ft.inlineEditValue,children:a}),o("div",{className:Ft.inlineEditInput,children:[e(Bt,{isDisabled:d,value:s.editableValue!==void 0?s.editableValue:a,validated:s.isValid!==!1?"default":"error",type:"text",onChange:(g,h)=>{l(g,h,n,t)},"aria-label":r}),e("div",{className:ia(Kt.formHelperText,Kt.modifiers.error),"aria-live":"polite",children:s.errorText})]})]});St.displayName="EditableTextCell";function an(){const{whoAmI:a}=Tt(),{adminClient:n}=se(),[t,s]=m.exports.useState(),l=a.getUserId();return Ce(()=>n.users.findOne({id:l}),s,[l]),t}const nn=({realm:a})=>{const{t:n}=F("realm-settings"),{adminClient:t}=se(),{realm:s}=le(),{addAlert:l,addError:r}=me(),d=an(),[g,h]=m.exports.useState(a),{register:i,control:S,handleSubmit:f,watch:C,reset:u,getValues:L,formState:{errors:y}}=be({defaultValues:g}),E=()=>u(g),v=C("smtpServer.from",""),p=C("smtpServer.host",""),[c,k]=Be(),M=Ie({control:S,name:"smtpServer.auth",defaultValue:""}),U=async I=>{try{const V={...g,...I};V.smtpServer?.port===""&&(V.smtpServer.port=null),await t.realms.update({realm:s},V),h(V),l(n("saveSuccess"),te.success)}catch(V){r("realm-settings:saveError",V)}},A=async()=>{const I=x=>Number(x),V=x=>x===(!0).toString(),z=new Map([["port",I],["ssl",V],["starttls",V],["auth",V]]),D={...L().smtpServer};for(const[x,H]of z.entries())D[x]=H(D[x]);D.port===0&&(D.port=null);try{k(),await t.realms.testSMTPConnection({realm:g.realm},D),l(n("testConnectionSuccess"),te.success)}catch(x){r("realm-settings:testConnectionError",x)}k()};return o(ee,{variant:"light",children:[e(ce,{title:n("template"),className:"kc-email-template",children:o(Y,{isHorizontal:!0,role:"manage-realm",className:"pf-u-mt-lg",onSubmit:f(U),children:[e(b,{label:n("from"),fieldId:"kc-display-name",isRequired:!0,validated:y.smtpServer?.from?"error":"default",helperTextInvalid:n("users:emailInvalid"),children:e(re,{type:"email",id:"kc-sender-email-address","data-testid":"sender-email-address",placeholder:"Sender email address",validated:y.smtpServer?.from?"error":"default",...i("smtpServer.from",{pattern:ut,required:!0})})}),e(b,{label:n("fromDisplayName"),fieldId:"kc-from-display-name",labelIcon:e(P,{helpText:"realm-settings-help:fromDisplayName",fieldLabelId:"realm-settings:authentication"}),children:e(re,{id:"kc-from-display-name","data-testid":"from-display-name",placeholder:"Display name for Sender email address",...i("smtpServer.fromDisplayName")})}),e(b,{label:n("replyTo"),fieldId:"kc-reply-to",validated:y.smtpServer?.replyTo?"error":"default",helperTextInvalid:n("users:emailInvalid"),children:e(re,{type:"email",id:"kc-reply-to",placeholder:"Reply to email address",validated:y.smtpServer?.replyTo?"error":"default",...i("smtpServer.replyTo",{pattern:ut})})}),e(b,{label:n("replyToDisplayName"),fieldId:"kc-reply-to-display-name",labelIcon:e(P,{helpText:"realm-settings-help:replyToDisplayName",fieldLabelId:"realm-settings:replyToDisplayName"}),children:e(re,{id:"kc-reply-to-display-name",placeholder:'Display name for "reply to" email address',...i("smtpServer.replyToDisplayName")})}),e(b,{label:n("envelopeFrom"),fieldId:"kc-envelope-from",labelIcon:e(P,{helpText:"realm-settings-help:envelopeFrom",fieldLabelId:"realm-settings:envelopeFrom"}),children:e(re,{id:"kc-envelope-from",placeholder:"Sender envelope email address",...i("smtpServer.envelopeFrom")})})]})}),e(ce,{className:"kc-email-connection",title:n("connectionAndAuthentication"),children:o(Y,{isHorizontal:!0,role:"manage-realm",className:"pf-u-mt-lg",onSubmit:f(U),children:[e(b,{label:n("host"),fieldId:"kc-host",isRequired:!0,validated:y.smtpServer?.host?"error":"default",helperTextInvalid:n("common:required"),children:e(re,{id:"kc-host",placeholder:"SMTP host",validated:y.smtpServer?.host?"error":"default",...i("smtpServer.host",{required:!0})})}),e(b,{label:n("port"),fieldId:"kc-port",children:e(re,{id:"kc-port",placeholder:"SMTP port (defaults to 25)",...i("smtpServer.port")})}),o(b,{label:n("encryption"),fieldId:"kc-html-display-name",children:[e(R,{name:"smtpServer.ssl",control:S,defaultValue:"false",render:({field:I})=>e(vt,{id:"kc-enable-ssl","data-testid":"enable-ssl",label:n("enableSSL"),isChecked:I.value==="true",onChange:V=>I.onChange(""+V)})}),e(R,{name:"smtpServer.starttls",control:S,defaultValue:"false",render:({field:I})=>e(vt,{id:"kc-enable-start-tls","data-testid":"enable-start-tls",label:n("enableStartTLS"),isChecked:I.value==="true",onChange:V=>I.onChange(""+V)})})]}),e(b,{hasNoPaddingTop:!0,label:n("authentication"),fieldId:"kc-authentication",children:e(R,{name:"smtpServer.auth",control:S,defaultValue:"",render:({field:I})=>e(Q,{id:"kc-authentication-switch","data-testid":"email-authentication-switch",label:n("common:enabled"),labelOff:n("common:disabled"),isChecked:I.value==="true",onChange:V=>{I.onChange(""+V)},"aria-label":n("authentication")})})}),M==="true"&&o(Z,{children:[e(b,{label:n("username"),fieldId:"kc-username",isRequired:!0,validated:y.smtpServer?.user?"error":"default",helperTextInvalid:n("common:required"),children:e(re,{id:"kc-username","data-testid":"username-input",placeholder:"Login username",validated:y.smtpServer?.user?"error":"default",...i("smtpServer.user",{required:!0})})}),e(b,{label:n("password"),fieldId:"kc-username",isRequired:!0,validated:y.smtpServer?.password?"error":"default",helperTextInvalid:n("common:required"),labelIcon:e(P,{helpText:"realm-settings-help:password",fieldLabelId:"realm-settings:password"}),children:e(Da,{id:"kc-password","data-testid":"password-input","aria-label":n("password"),validated:y.smtpServer?.password?"error":"default",...i("smtpServer.password",{required:!0})})})]}),o(ve,{children:[e(ht,{children:e(N,{variant:"primary",type:"submit","data-testid":"email-tab-save",children:n("common:save")})}),e(ht,{children:e(N,{variant:"secondary",onClick:()=>A(),"data-testid":"test-connection-button",isDisabled:!(ut.test(v)&&p)||!d?.email,"aria-describedby":"descriptionTestConnection",isLoading:c,spinnerAriaValueText:n("testingConnection"),children:n("common:testConnection")})}),e(ht,{children:e(N,{variant:"link",onClick:E,"data-testid":"email-tab-revert",children:n("common:revert")})})]}),d&&e(b,{id:"descriptionTestConnection",children:d.email?e(lt,{variant:"info",isInline:!0,title:n("testConnectionHint.withEmail",{email:d.email})}):e(lt,{variant:"warning",isInline:!0,title:n("testConnectionHint.withoutEmail",{userName:d.username}),actionLinks:e(ra,{component:I=>e(fe,{...I,to:oa({realm:s,id:d.id,tab:"settings"})}),children:n("testConnectionHint.withoutEmailAction")})})})]})})]})};function aa({loader:a,addTypes:n,onSelect:t,onDelete:s}){const{t:l}=F("realm-settings"),r=d=>e(m.exports.Fragment,{children:l(`eventTypes.${d.id}.description`)},d.id);return e(Ve,{ariaLabelKey:"userEventsRegistered",searchPlaceholderKey:"realm-settings:searchEventType",loader:a,onSelect:t||void 0,canSelectAll:!!t,toolbarItem:n&&e(ye,{children:e(N,{id:"addTypes",onClick:n,"data-testid":"addTypes",children:l("addSavedTypes")})}),actions:s?[{title:l("common:remove"),onRowClick:s}]:[],columns:[{name:"id",displayKey:"realm-settings:eventType",cellFormatters:[d=>l(`eventTypes.${d}.name`)]},{name:"description",displayKey:"description",cellRenderer:r}],emptyState:e(we,{message:l("emptyEvents"),instructions:l("emptyEventsInstructions")})})}const sn=({onConfirm:a,onClose:n,configured:t})=>{const{t:s}=F("realm-settings"),{enums:l}=_e(),[r,d]=m.exports.useState([]);return e(Ge,{variant:ze.medium,title:s("addTypes"),isOpen:!0,onClose:n,actions:[e(N,{"data-testid":"addEventTypeConfirm",variant:"primary",onClick:()=>a(r),children:s("common:add")},"confirm"),e(N,{"data-testid":"moveCancel",variant:"link",onClick:n,children:s("common:cancel")},"cancel")],children:e(aa,{onSelect:g=>d(g),loader:()=>Promise.resolve(l.eventType.filter(g=>!t.includes(g)).map(g=>({id:g})))})})},Ut=({type:a,form:n,reset:t,clear:s})=>{const{t:l}=F("realm-settings"),{control:r,watch:d,setValue:g,formState:{isDirty:h}}=n,i=a==="admin"?"adminEventsEnabled":"eventsEnabled",S=d(i),[f,C]=ue({titleKey:"realm-settings:events-disable-title",messageKey:"realm-settings:events-disable-confirm",continueButtonLabel:"realm-settings:confirm",onConfirm:()=>g(i,!1)});return o(Z,{children:[e(C,{}),e(b,{hasNoPaddingTop:!0,label:l("saveEvents"),fieldId:i,labelIcon:e(P,{helpText:`realm-settings-help:save-${a}-events`,fieldLabelId:"realm-settings:saveEvents"}),children:e(R,{name:i,defaultValue:!1,control:r,render:({field:u})=>e(Q,{"data-testid":i,id:`${i}-switch`,label:l("common:on"),labelOff:l("common:off"),isChecked:u.value,onChange:L=>{L?u.onChange(L):f()},"aria-label":l("saveEvents")})})}),S&&o(Z,{children:[a==="admin"&&e(b,{hasNoPaddingTop:!0,label:l("includeRepresentation"),fieldId:"includeRepresentation",labelIcon:e(P,{helpText:"realm-settings-help:includeRepresentation",fieldLabelId:"realm-settings:includeRepresentation"}),children:e(R,{name:"adminEventsDetailsEnabled",defaultValue:!1,control:r,render:({field:u})=>e(Q,{"data-testid":"includeRepresentation",id:"includeRepresentation",label:l("common:on"),labelOff:l("common:off"),isChecked:u.value,onChange:u.onChange,"aria-label":l("includeRepresentation")})})}),e(b,{label:l("expiration"),fieldId:"expiration",labelIcon:e(P,{helpText:"realm-settings-help:expiration",fieldLabelId:"realm-settings:expiration"}),children:e(R,{name:a==="user"?"eventsExpiration":"adminEventsExpiration",defaultValue:"",control:r,render:({field:u})=>e(J,{value:u.value,onChange:u.onChange,units:["minute","hour","day"]})})})]}),o(ve,{children:[e(N,{variant:"primary",type:"submit",id:`save-${a}`,"data-testid":`save-${a}`,isDisabled:!h,children:l("common:save")}),e(N,{variant:"link",onClick:t,children:l("common:revert")})]}),e(je,{}),e(b,{label:l(a==="user"?"clearUserEvents":"clearAdminEvents"),fieldId:`clear-${a}-events`,labelIcon:e(P,{helpText:`realm-settings-help:${a}-clearEvents`,fieldLabelId:`realm-settings:clear-${a}-events`}),children:e(N,{variant:"danger",id:`clear-${a}-events`,"data-testid":`clear-${a}-events`,onClick:()=>s(),children:l(a==="user"?"clearUserEvents":"clearAdminEvents")})})]})},ln=({form:a,reset:n})=>{const{t}=F("realm-settings"),{control:s,formState:{isDirty:l}}=a,[r,d]=m.exports.useState(!1),h=_e().providers?.eventsListener.providers;return o(Z,{children:[e(b,{hasNoPaddingTop:!0,label:t("eventListeners"),fieldId:"kc-eventListeners",labelIcon:e(P,{helpText:t("eventListenersHelpText"),fieldLabelId:"realm-settings:eventListeners"}),children:e(R,{name:"eventsListeners",defaultValue:"",control:s,render:({field:i})=>e(de,{name:"eventsListeners",className:"kc_eventListeners_select","data-testid":"eventListeners-select",chipGroupProps:{numChips:3,expandedText:t("common:hide"),collapsedText:t("common:showRemaining")},variant:ge.typeaheadMulti,typeAheadAriaLabel:"Select",onToggle:S=>d(S),selections:i.value,onSelect:(S,f)=>{const C=f.toString(),u=i.value.includes(C)?i.value.filter(L=>L!==C):[...i.value,C];i.onChange(u)},onClear:S=>{S.stopPropagation(),i.onChange([])},isOpen:r,"aria-labelledby":"eventsListeners",children:Object.keys(h).map(S=>e(ne,{value:S},S))})})}),o(ve,{children:[e(N,{variant:"primary",type:"submit","data-testid":"saveEventListenerBtn",isDisabled:!l,children:t("common:save")}),e(N,{variant:"link","data-testid":"revertEventListenerBtn",onClick:n,children:t("common:revert")})]})]})},rn=({realm:a})=>{const{t:n}=F("realm-settings"),t=be(),{setValue:s,handleSubmit:l}=t,[r,d]=m.exports.useState(0),g=()=>d(new Date().getTime()),[h,i]=m.exports.useState(0),S=()=>i(new Date().getTime()),[f,C]=m.exports.useState("event"),[u,L]=m.exports.useState(),[y,E]=m.exports.useState(),[v,p]=m.exports.useState(!1),{adminClient:c}=se(),{addAlert:k,addError:M}=me(),{realm:U}=le(),A=O=>{L(O),xe(O||{},s)},I=async O=>{E(O),V()},[V,z]=ue({titleKey:"realm-settings:deleteEvents",messageKey:"realm-settings:deleteEventsConfirm",continueButtonLabel:"common:clear",continueButtonVariant:ae.danger,onConfirm:async()=>{try{switch(y){case"admin":await c.realms.clearAdminEvents({realm:U});break;case"user":await c.realms.clearEvents({realm:U});break}k(n(`${y}-events-cleared`),te.success)}catch(O){M(`realm-settings:${y}-events-cleared-error`,O)}}});Ce(()=>c.realms.getConfigEvents({realm:U}),O=>{A({...O,adminEventsExpiration:a.attributes?.adminEventsExpiration}),S()},[r]);const D=async O=>{const _=!Yt(u?.eventsListeners,O.eventsListeners),{adminEventsExpiration:j,...pe}=O;a.attributes?.adminEventsExpiration!==j&&await c.realms.update({realm:U},{...a,attributes:{...a.attributes||{},adminEventsExpiration:j}});try{await c.realms.updateConfigEvents({realm:U},pe),A({...u,...pe,adminEventsExpiration:j}),k(n(_?"realm-settings:saveEventListenersSuccess":"realm-settings:eventConfigSuccessfully"),te.success)}catch(Se){M(n(_?"realm-settings:saveEventListenersError":"realm-settings:eventConfigError"),Se)}},x=async O=>{const _=O.map(pe=>pe.id),j=u.enabledEventTypes?.concat(_);await H(j)},H=async(O=[])=>{const _={...t.getValues(),enabledEventTypes:O};await D(_),p(!1),g()};return o(Z,{children:[e(z,{}),v&&e(sn,{onConfirm:O=>x(O),configured:u?.enabledEventTypes||[],onClose:()=>p(!1)}),o(It,{activeKey:f,onSelect:(O,_)=>C(_),children:[e(B,{eventKey:"event",title:e(G,{children:n("eventListeners")}),"data-testid":"rs-event-listeners-tab",children:e(ee,{children:e(Y,{role:"manage-events",isHorizontal:!0,onSubmit:l(D),children:e(ln,{form:t,reset:()=>A(u)})})})}),o(B,{eventKey:"user",title:e(G,{children:n("userEventsSettings")}),"data-testid":"rs-events-tab",children:[e(ee,{children:e(Y,{role:"manage-events",isHorizontal:!0,onSubmit:l(D),children:e(Ut,{type:"user",form:t,reset:()=>A(u),clear:()=>I("user")})})}),u?.eventsEnabled&&e(ee,{children:e(aa,{addTypes:()=>p(!0),loader:()=>Promise.resolve(u.enabledEventTypes?.map(O=>({id:O}))||[]),onDelete:O=>{const _=u.enabledEventTypes?.filter(j=>j!==O.id);H(_),L({...u,enabledEventTypes:_})}},h)})]}),e(B,{eventKey:"admin",title:e(G,{children:n("adminEventsSettings")}),"data-testid":"rs-admin-events-tab",children:e(ee,{children:e(Y,{role:"manage-events",isHorizontal:!0,onSubmit:l(D),children:e(Ut,{type:"admin",form:t,reset:()=>A(u),clear:()=>I("admin")})})})})]})]})},on=({realm:a,save:n})=>{const{t}=F("realm-settings"),{adminClient:s}=se(),{realm:l}=le(),r=be(),{register:d,control:g,handleSubmit:h,setValue:i,formState:{isDirty:S,errors:f}}=r,C=qt(),[u,L]=m.exports.useState(!1),y=["all","external","none"],E=()=>{if(xe(a,i),a.attributes?.["acr.loa.map"]){const v=Object.entries(JSON.parse(a.attributes["acr.loa.map"])).flatMap(([p,c])=>({key:p,value:c}));v.concat({key:"",value:""}),i(at("attributes.acr.loa.map"),v)}};return m.exports.useEffect(E,[]),e(ee,{variant:"light",children:o(Y,{isHorizontal:!0,role:"manage-realm",className:"pf-u-mt-lg",onSubmit:h(n),children:[e(b,{label:t("realmId"),fieldId:"kc-realm-id",isRequired:!0,validated:f.realm?"error":"default",helperTextInvalid:f.realm?.message,children:e(R,{name:"realm",control:g,rules:{required:{value:!0,message:t("common:required")},pattern:{value:/^[a-zA-Z0-9-_]+$/,message:t("realm:invalidRealmName")}},defaultValue:"",render:({field:v})=>e(Pa,{"data-testid":"realmName",onChange:v.onChange,children:v.value})})}),e(b,{label:t("displayName"),fieldId:"kc-display-name",children:e(re,{id:"kc-display-name",...d("displayName")})}),e(b,{label:t("htmlDisplayName"),fieldId:"kc-html-display-name",children:e(re,{id:"kc-html-display-name",...d("displayNameHtml")})}),e(b,{label:t("frontendUrl"),fieldId:"kc-frontend-url",labelIcon:e(P,{helpText:"realm-settings-help:frontendUrl",fieldLabelId:"realm-settings:frontendUrl"}),children:e(re,{type:"url",id:"kc-frontend-url",...d(at("attributes.frontendUrl"))})}),e(b,{label:t("requireSsl"),fieldId:"kc-require-ssl",labelIcon:e(P,{helpText:"realm-settings-help:requireSsl",fieldLabelId:"realm-settings:requireSsl"}),children:e(R,{name:"sslRequired",defaultValue:"none",control:g,render:({field:v})=>e(de,{toggleId:"kc-require-ssl",onToggle:()=>L(!u),onSelect:(p,c)=>{v.onChange(c),L(!1)},selections:v.value,variant:ge.single,"aria-label":t("requireSsl"),isOpen:u,children:y.map(p=>e(ne,{selected:p===v.value,value:p,children:t(`sslType.${p}`)},p))})})}),e(b,{label:t("clients:acrToLoAMapping"),fieldId:"acrToLoAMapping",labelIcon:e(P,{helpText:"clients-help:acrToLoAMapping",fieldLabelId:"clients:acrToLoAMapping"}),children:e(Ct,{...r,children:e(Fa,{name:at("attributes.acr.loa.map")})})}),e(b,{hasNoPaddingTop:!0,label:t("userManagedAccess"),labelIcon:e(P,{helpText:"realm-settings-help:userManagedAccess",fieldLabelId:"realm-settings:userManagedAccess"}),fieldId:"kc-user-managed-access",children:e(R,{name:"userManagedAccessAllowed",control:g,defaultValue:!1,render:({field:v})=>e(Q,{id:"kc-user-managed-access","data-testid":"user-managed-access-switch",label:t("common:on"),labelOff:t("common:off"),isChecked:v.value,onChange:v.onChange,"aria-label":t("userManagedAccess")})})}),C(Wt.DeclarativeUserProfile)&&e(b,{hasNoPaddingTop:!0,label:t("userProfileEnabled"),labelIcon:e(P,{helpText:"realm-settings-help:userProfileEnabled",fieldLabelId:"realm-settings:userProfileEnabled"}),fieldId:"kc-user-profile-enabled",children:e(R,{name:at("attributes.userProfileEnabled"),control:g,defaultValue:"false",render:({field:v})=>e(Q,{id:"kc-user-profile-enabled","data-testid":"user-profile-enabled-switch",label:t("common:on"),labelOff:t("common:off"),isChecked:v.value==="true",onChange:p=>v.onChange(p.toString()),"aria-label":t("userProfileEnabled")})})}),e(b,{label:t("endpoints"),labelIcon:e(P,{helpText:"realm-settings-help:endpoints",fieldLabelId:"realm-settings:endpoints"}),fieldId:"kc-endpoints",children:o(Jt,{children:[e(Pe,{children:e(bt,{href:`${Pt(s.baseUrl)}realms/${l}/.well-known/openid-configuration`,title:t("openIDEndpointConfiguration")})}),e(Pe,{children:e(bt,{href:`${Pt(s.baseUrl)}realms/${l}/protocol/saml/descriptor`,title:t("samlIdentityProviderMetadata")})})]})}),o(ve,{children:[e(N,{variant:"primary",type:"submit","data-testid":"general-tab-save",isDisabled:!S,children:t("common:save")}),e(N,{"data-testid":"general-tab-revert",variant:"link",onClick:E,children:t("common:revert")})]})]})})},Qe=["ACTIVE","PASSIVE","DISABLED"],cn=({onFilter:a})=>{const{t:n}=F("realm-settings"),[t,s]=m.exports.useState(Qe[0]),[l,r]=Be();return e(de,{width:300,"data-testid":"filter-type-select",isOpen:l,className:"kc-filter-type-select",variant:ge.single,onToggle:r,toggleIcon:e(Zt,{}),onSelect:(d,g)=>{const h=Qe.find(i=>i===g.toString())||Qe[0];s(h),a(h),r()},selections:t,children:Qe.map(d=>e(ne,{"data-testid":`${d}-option`,value:d,children:n(`keysFilter.${d}`)},d))})},dn=({realmComponents:a})=>{const{t:n}=F("realm-settings"),t=$e(),[s,l]=m.exports.useState(""),[r,d]=m.exports.useState(""),{adminClient:g}=se(),{realm:h}=le(),[i,S]=m.exports.useState(),[f,C]=m.exports.useState();Ce(async()=>(await g.realms.getKeys({realm:h})).keys?.map(k=>{const M=a.find(U=>U.id===k.providerId);return{...k,provider:M?.name}}),S,[]);const[u,L]=ue({titleKey:n("publicKeys").slice(0,-1),messageKey:s,continueButtonLabel:"common:close",continueButtonVariant:ae.primary,onConfirm:()=>Promise.resolve()}),[y,E]=ue({titleKey:n("certificate"),messageKey:r,continueButtonLabel:"common:close",continueButtonVariant:ae.primary,onConfirm:()=>Promise.resolve()}),v=({provider:c})=>c,p=({type:c,publicKey:k,certificate:M})=>{if(c==="EC")return e(N,{onClick:()=>{u(),l(k)},variant:"secondary",id:"kc-public-key",children:n("publicKeys").slice(0,-1)});if(c==="RSA")return o("div",{className:"button-wrapper",children:[e(N,{onClick:()=>{u(),l(k)},variant:"secondary",id:k,children:n("publicKeys").slice(0,-1)}),e(N,{onClick:()=>{y(),d(M)},variant:"secondary",id:M,className:"kc-certificate",children:n("certificate")})]})};return i?o(ee,{variant:"light",padding:{default:"noPadding"},children:[e(L,{}),e(E,{}),e(Ve,{isNotCompact:!0,className:"kc-keys-list",loader:f||i,ariaLabelKey:"realm-settings:keysList",searchPlaceholderKey:"realm-settings:searchKey",searchTypeComponent:e(cn,{onFilter:c=>C(c!==Qe[0]?i.filter(({status:k})=>k===c):void 0)}),canSelectAll:!0,columns:[{name:"algorithm",displayKey:"realm-settings:algorithm",cellFormatters:[Xe()],transforms:[Ue(15)]},{name:"type",displayKey:"type",cellFormatters:[Xe()],transforms:[Ue(10)]},{name:"kid",displayKey:"realm-settings:kid",cellFormatters:[Xe()],transforms:[Ue(10)]},{name:"use",displayKey:"realm-settings:use",cellFormatters:[Xe()],transforms:[Ue(10)]},{name:"provider",displayKey:"realm-settings:provider",cellRenderer:v,cellFormatters:[Xe()],transforms:[Ue(10)]},{name:"publicKeys",displayKey:"realm-settings:publicKeys",cellRenderer:p,cellFormatters:[],transforms:[Ue(20)]}],isSearching:!!f,emptyState:e(we,{hasIcon:!0,message:n("noKeys"),instructions:n("noKeysDescription"),primaryActionText:n("addProvider"),onPrimaryAction:()=>t(gt({realm:h,tab:"providers"}))})})]}):e(Ae,{})},mn=({providerType:a,onClose:n})=>{const{t}=F("realm-settings");return e(Ge,{className:"add-provider-modal",variant:ze.medium,title:t("addProvider"),isOpen:!0,onClose:n,children:e(za,{providerType:a,onClose:n})})},un=({realmComponents:a,refresh:n})=>{const{t}=F("realm-settings"),{addAlert:s,addError:l}=me(),{adminClient:r}=se(),{realm:d}=le(),[g,h]=m.exports.useState(""),[i,S]=m.exports.useState([]),[f,C]=Be(),L=_e().componentTypes?.[Gt]??[],y=L.map(x=>x.id),[E,v]=m.exports.useState(!1),[p,c]=m.exports.useState(),[k,M]=m.exports.useState(),U=m.exports.useMemo(()=>a.map(x=>{const H=L.find(O=>x.providerId===O.id);return{...x,providerDescription:H?.helpText}}),[a]),[A,I]=ue({titleKey:"realm-settings:deleteProviderTitle",messageKey:t("deleteProviderConfirm",{provider:k?.name}),continueButtonLabel:"common:delete",continueButtonVariant:ae.danger,onConfirm:async()=>{try{await r.components.del({id:k.id,realm:d}),n(),s(t("deleteProviderSuccess"),te.success)}catch(x){l("realm-settings:deleteProviderError",x)}}}),V=()=>{if(g!==""){h(g);const x=U.filter(H=>H.name?.includes(g)||H.providerId?.includes(g));S(x)}else h(""),S(U)},z=x=>{x.key==="Enter"&&V()},D=x=>{h(x)};return o(Z,{children:[f&&p&&e(mn,{providerType:p,onClose:()=>{C(),n()}}),e(I,{}),o(ee,{variant:"light",padding:{default:"noPadding"},children:[e(Xt,{children:o(wa,{className:"providers-toolbar",children:[e(ye,{children:o(ca,{children:[e(Bt,{name:"inputGroupName",id:"inputGroupName","data-testid":"provider-search-input",type:"search","aria-label":t("common:search"),placeholder:t("common:search"),onChange:D,onKeyDown:z}),e(N,{variant:ae.control,"aria-label":t("common:search"),onClick:V,children:e(zt,{})})]})}),e(ye,{children:e(_t,{"data-testid":"addProviderDropdown",className:"add-provider-dropdown",isOpen:E,toggle:e(da,{onToggle:x=>v(x),isPrimary:!0,children:t("addProvider")}),dropdownItems:[y.map(x=>e(Ye,{onClick:()=>{C(),v(!1),c(x)},"data-testid":`option-${x}`,children:x},x))]})})]})}),e(ea,{variant:"compact",className:"kc-draggable-table",keyField:"id",data:i.length===0?U:i,onDragFinish:async(x,H)=>{const O=U.map(_=>{const j={..._};return delete j.providerDescription,r.components.update({id:_.id},{...j,config:{priority:[(H.length-H.indexOf(_.id)+100).toString()]}})});try{await Promise.all(O),n(),s(t("saveProviderListSuccess"),te.success)}catch(_){l("realm-settings:saveProviderError",_)}},columns:[{name:"name",displayKey:"realm-settings:name",cellRenderer:x=>e(fe,{"data-testid":"provider-name-link",to:ma({realm:d,id:x.id,providerType:x.providerId}),children:x.name},x.name)},{name:"providerId",displayKey:"realm-settings:provider"},{name:"providerDescription",displayKey:"realm-settings:providerDescription"}],actions:[{title:t("common:delete"),onClick:(x,H,O)=>{M(O),A()}}]})]})]})},pn=a=>[...a].sort((t,s)=>{const l=Number(t.config?.priority),r=Number(s.config?.priority);return(isNaN(r)?0:r)-(isNaN(l)?0:l)}),hn=()=>{const{t:a}=F("realm-settings"),{adminClient:n}=se(),{realm:t}=le(),[s,l]=m.exports.useState(),[r,d]=m.exports.useState(0),g=()=>{d(r+1)};Ce(()=>n.components.find({type:Gt,realm:t}),f=>l(pn(f)),[r]);const h=f=>rt(gt({realm:t,tab:f})),i=h("list"),S=h("providers");return s?o(it,{mountOnEnter:!0,unmountOnExit:!0,defaultLocation:gt({realm:t,tab:"list"}),children:[e(B,{id:"keysList","data-testid":"rs-keys-list-tab","aria-label":"keys-list-subtab",title:e(G,{children:a("keysList")}),...i,children:e(dn,{realmComponents:s})}),e(B,{id:"providers","data-testid":"rs-providers-tab","aria-label":"rs-providers-tab",title:e(G,{children:a("providers")}),...S,children:e(un,{realmComponents:s,refresh:g})})]}):e(Ae,{})},gn=({handleModalToggle:a,save:n,form:{register:t,handleSubmit:s,formState:{errors:l}}})=>{const{t:r}=F("realm-settings");return e(Ge,{variant:ze.small,title:r("addMessageBundle"),isOpen:!0,onClose:a,actions:[e(N,{"data-testid":"add-bundle-confirm-button",variant:"primary",type:"submit",form:"bundle-form",children:r("common:create")},"confirm"),e(N,{id:"modal-cancel","data-testid":"cancel",variant:ae.link,onClick:()=>{a()},children:r("common:cancel")},"cancel")],children:o(kt,{id:"bundle-form",isHorizontal:!0,onSubmit:s(n),children:[e(b,{label:r("common:key"),name:"key",fieldId:"key-id",helperTextInvalid:r("common:required"),validated:l.key?he.error:he.default,isRequired:!0,children:e(re,{"data-testid":"key-input",autoFocus:!0,id:"key-id",validated:l.key?he.error:he.default,...t("key",{required:!0})})}),e(b,{label:r("common:value"),name:"add-value",fieldId:"value-id",helperTextInvalid:r("common:required"),validated:l.value?he.error:he.default,isRequired:!0,children:e(re,{"data-testid":"value-input",id:"value-id",validated:l.value?he.error:he.default,...t("value",{required:!0})})})]})})},Ee=a=>{try{return new Intl.DisplayNames([a],{type:"language"}).of(a)}catch{return a}},fn=({save:a,realm:n})=>{const{t}=F("realm-settings"),{adminClient:s}=se(),[l,r]=m.exports.useState(!1),[d,g]=m.exports.useState(!1),[h,i]=m.exports.useState(!1),[S,f]=m.exports.useState(!1),[C,u]=m.exports.useState(Te),{setValue:L,getValues:y,control:E,handleSubmit:v,formState:p}=be(),[c,k]=m.exports.useState(!1),[M,U]=m.exports.useState([]),[A,I]=m.exports.useState([]),V=_e().themes,z=m.exports.useMemo(()=>{const w=Object.values(V).flatMap(K=>K.flatMap(({locales:X})=>X||[]));return Array.from(new Set(w))},[V]),D=be({mode:"onChange"}),{addAlert:x,addError:H}=me(),{realm:O}=le(),{whoAmI:_}=Tt(),j=n.supportedLocales?.length?n.supportedLocales:[Te],pe=()=>{xe(n,L),L("supportedLocales",j)};m.exports.useEffect(pe,[]);const Se=Ie({control:E,name:"supportedLocales",defaultValue:j}),q=Ie({control:E,name:"internationalizationEnabled",defaultValue:n.internationalizationEnabled}),[qe,oe]=m.exports.useState(0),[Le,et]=m.exports.useState(10),[Re,Fe]=m.exports.useState(0),[De,mt]=m.exports.useState(""),We=()=>{oe(qe+1)};Ce(async()=>{let w=await s.realms.getRealmLocalizationTexts({first:Re,max:Le,realm:n.realm,selectedLocale:C||y("defaultLocale")||_.getLocale()}).catch(()=>[]);const K=X=>Object.entries(w).filter(W=>W[X].includes(De));if(De){const X=tn(K(0).concat(K(1)),Yt);w=Object.fromEntries(X)}return{result:w}},({result:w})=>{const K=Object.entries(w).slice(Re,Re+Le+1);U(K);const X=K.map(W=>({rowEditBtnAriaLabel:()=>t("rowEditBtnAriaLabel",{messageBundle:W[1]}),rowSaveBtnAriaLabel:()=>t("rowSaveBtnAriaLabel",{messageBundle:W[1]}),rowCancelBtnAriaLabel:()=>t("rowCancelBtnAriaLabel",{messageBundle:W[1]}),cells:[{title:(ie,ke,Oe,Je)=>e(St,{value:ie,rowIndex:ke,cellIndex:Oe,props:Je,isDisabled:!0,handleTextInputChange:tt,inputAriaLabel:W[0]}),props:{value:W[0]}},{title:(ie,ke,Oe,Je)=>e(St,{value:ie,rowIndex:ke,cellIndex:Oe,props:Je,handleTextInputChange:tt,inputAriaLabel:W[1]}),props:{value:W[1]}}]}));return I(X),K},[qe,De,Re,Le]);const tt=(w,K,X,W)=>{I(ie=>{const ke=wt(ie),Oe=ke[X]?.cells?.[W];return Oe.props.editableValue=w,ke})},T=async(w,K,X)=>{if(K===void 0)return;const W=wt(A);let ie;const ke=!!X&&Object.keys(X).length>0;if(ke?ie=Ha(W[K],w,X):w==="cancel"?ie=Ba(W[K]):ie=Ga(W[K],w),W[K]=ie,!ke&&w==="save"){const Oe=(ie.cells?.[0]).props.value,Je=(ie.cells?.[1]).props.value;try{await s.realms.addLocalization({realm:n.realm,selectedLocale:C||y("defaultLocale")||Te,key:Oe},Je),x(t("updateMessageBundleSuccess"),te.success)}catch{x(t("updateMessageBundleError"),te.danger)}}I(W)},$=()=>{r(!l)},Ne=[e(Vt,{label:t("defaultLocale"),children:e(ne,{value:Te,children:Ee(Te)},Te)},"group1"),e(je,{},"divider"),e(Vt,{label:t("supportedLocales"),children:Se.map(w=>e(ne,{value:w,children:Ee(w)},w))},"group2")],na=async w=>{try{await s.realms.addLocalization({realm:O,selectedLocale:C||y("defaultLocale")||Te,key:w.key},w.value),s.setConfig({realmName:O}),We(),x(t("addMessageBundleSuccess"),te.success)}catch(K){H(t("addMessageBundleError"),K)}},sa=async w=>{try{await s.realms.deleteRealmLocalizationTexts({realm:O,selectedLocale:C,key:w}),We(),x(t("deleteMessageBundleSuccess"))}catch(K){H("realm-settings:deleteMessageBundleError",K)}};return o(Z,{children:[l&&e(gn,{handleModalToggle:$,save:w=>{na(w),$()},form:D}),o(ee,{variant:"light",children:[o(Y,{isHorizontal:!0,role:"manage-realm",className:"pf-u-mt-lg",onSubmit:v(a),children:[e(b,{label:t("internationalization"),fieldId:"kc-internationalization",labelIcon:e(P,{helpText:"realm-settings-help:internationalization",fieldLabelId:"realm-settings:internationalization"}),children:e(R,{name:"internationalizationEnabled",control:E,defaultValue:n.internationalizationEnabled,render:({field:w})=>e(Q,{id:"kc-l-internationalization",label:t("common:enabled"),labelOff:t("common:disabled"),isChecked:w.value,"data-testid":w.value?"internationalization-enabled":"internationalization-disabled",onChange:w.onChange,"aria-label":t("internationalization")})})}),q&&o(Z,{children:[e(b,{label:t("supportedLocales"),fieldId:"kc-l-supported-locales",children:e(R,{name:"supportedLocales",control:E,defaultValue:j,render:({field:w})=>e(de,{toggleId:"kc-l-supported-locales",onToggle:K=>{g(K)},onSelect:(K,X)=>{const W=X;w.value.includes(W)?w.onChange(w.value.filter(ie=>ie!==W)):w.onChange([...w.value,W])},onClear:()=>{w.onChange([])},selections:w.value,variant:ge.typeaheadMulti,"aria-label":t("supportedLocales"),isOpen:d,placeholderText:t("selectLocales"),children:z.map(K=>e(ne,{selected:w.value.includes(K),value:K,children:Ee(K)},K))})})}),e(b,{label:t("defaultLocale"),fieldId:"kc-l-default-locale",children:e(R,{name:"defaultLocale",control:E,defaultValue:Te,render:({field:w})=>e(de,{toggleId:"kc-default-locale",onToggle:()=>i(!h),onSelect:(K,X)=>{w.onChange(X),i(!1)},selections:w.value?Ee(w.value):n.defaultLocale!==""?Ee(n.defaultLocale||Te):t("placeholderText"),variant:ge.single,"aria-label":t("defaultLocale"),isOpen:h,placeholderText:t("placeholderText"),"data-testid":"select-default-locale",children:Se.map((K,X)=>e(ne,{value:K,children:Ee(K)},`default-locale-${X}`))})})})]}),o(ve,{children:[e(N,{variant:"primary",isDisabled:!p.isDirty,type:"submit","data-testid":"localization-tab-save",children:t("common:save")}),e(N,{variant:"link",onClick:pe,children:t("common:revert")})]})]}),o(ce,{className:"kc-message-bundles",title:"Edit message bundles",children:[e(dt,{className:"messageBundleDescription",children:t("messageBundleDescription")}),e("div",{className:"tableBorder",children:o(Ka,{count:M.length,first:Re,max:Le,onNextClick:Fe,onPreviousClick:Fe,onPerPageSelect:(w,K)=>{Fe(w),et(K)},inputGroupName:"common:search",inputGroupOnEnter:w=>{mt(w),Fe(0),et(10)},inputGroupPlaceholder:t("searchForMessageBundle"),toolbarItem:e(N,{"data-testid":"add-bundle-button",onClick:()=>r(!0),children:t("addMessageBundle")}),searchTypeComponent:e(ye,{children:e(de,{width:180,"data-testid":"filter-by-locale-select",isOpen:S,className:"kc-filter-by-locale-select",variant:ge.single,isDisabled:!q,onToggle:w=>f(w),onSelect:(w,K)=>{u(K.toString()),k(!0),We(),f(!1)},selections:c?Ee(C):n.defaultLocale!==""?Ee(Te):t("placeholderText"),children:Ne})}),children:[M.length===0&&!De&&e(we,{hasIcon:!0,message:t("noMessageBundles"),instructions:t("noMessageBundlesInstructions"),onPrimaryAction:$}),M.length===0&&De&&e(we,{hasIcon:!0,icon:zt,isSearchVariant:!0,message:t("common:noSearchResults"),instructions:t("common:noSearchResultsInstructions")}),M.length!==0&&o(Na,{"aria-label":t("editableRowsTable"),"data-testid":"editable-rows-table",variant:Ua.compact,cells:[t("common:key"),t("common:value")],rows:A,onRowEdit:(w,K,X,W,ie)=>T(K,W,ie),actions:[{title:t("common:delete"),onClick:(w,K)=>sa((A[K].cells?.[0]).props.value)}],children:[e(Oa,{}),e(Ma,{})]})]})})]})]})]})},bn=({realm:a,refresh:n})=>{const{t}=F("realm-settings"),{addAlert:s,addError:l}=me(),{adminClient:r}=se(),{realm:d}=le(),g=async h=>{const i=Array.isArray(h)?Object.keys(h[0])[0]:Object.keys(h)[0];try{await r.realms.update({realm:d},Array.isArray(h)?h.reduce((S,f)=>Object.assign(S,f),a):Object.assign(a,h)),s(t("enableSwitchSuccess",{switch:t(i)})),n()}catch(S){l(t("enableSwitchError"),S)}};return o(ee,{variant:"light",children:[e(ce,{className:"kc-login-screen",title:t("loginScreenCustomization"),children:o(Y,{isHorizontal:!0,role:"manage-realm",children:[e(b,{label:t("registrationAllowed"),fieldId:"kc-user-reg",labelIcon:e(P,{helpText:t("userRegistrationHelpText"),fieldLabelId:"realm-settings:registrationAllowed"}),hasNoPaddingTop:!0,children:e(Q,{id:"kc-user-reg-switch","data-testid":"user-reg-switch",value:a.registrationAllowed?"on":"off",label:t("common:on"),labelOff:t("common:off"),isChecked:a.registrationAllowed,onChange:h=>{g({registrationAllowed:h})},"aria-label":t("registrationAllowed")})}),e(b,{label:t("resetPasswordAllowed"),fieldId:"kc-forgot-pw",labelIcon:e(P,{helpText:"realm-settings:forgotPasswordHelpText",fieldLabelId:"realm-settings:resetPasswordAllowed"}),hasNoPaddingTop:!0,children:e(Q,{id:"kc-forgot-pw-switch","data-testid":"forgot-pw-switch",name:"resetPasswordAllowed",value:a.resetPasswordAllowed?"on":"off",label:t("common:on"),labelOff:t("common:off"),isChecked:a.resetPasswordAllowed,onChange:h=>{g({resetPasswordAllowed:h})},"aria-label":t("resetPasswordAllowed")})}),e(b,{label:t("rememberMe"),fieldId:"kc-remember-me",labelIcon:e(P,{helpText:"realm-settings:rememberMeHelpText",fieldLabelId:"realm-settings:rememberMe"}),hasNoPaddingTop:!0,children:e(Q,{id:"kc-remember-me-switch","data-testid":"remember-me-switch",value:a.rememberMe?"on":"off",label:t("common:on"),labelOff:t("common:off"),isChecked:a.rememberMe,onChange:h=>{g({rememberMe:h})},"aria-label":t("rememberMe")})})]})}),e(ce,{className:"kc-email-settings",title:t("emailSettings"),children:o(Y,{isHorizontal:!0,role:"manage-realm",children:[e(b,{label:t("registrationEmailAsUsername"),fieldId:"kc-email-as-username",labelIcon:e(P,{helpText:"realm-settings:emailAsUsernameHelpText",fieldLabelId:"realm-settings:registrationEmailAsUsername"}),hasNoPaddingTop:!0,children:e(Q,{id:"kc-email-as-username-switch","data-testid":"email-as-username-switch",value:a.registrationEmailAsUsername?"on":"off",label:t("common:on"),labelOff:t("common:off"),isChecked:a.registrationEmailAsUsername,onChange:h=>{g([{registrationEmailAsUsername:h},{duplicateEmailsAllowed:!1}])},"aria-label":t("registrationEmailAsUsername")})}),e(b,{label:t("loginWithEmailAllowed"),fieldId:"kc-login-with-email",labelIcon:e(P,{helpText:"realm-settings:loginWithEmailHelpText",fieldLabelId:"realm-settings:loginWithEmailAllowed"}),hasNoPaddingTop:!0,children:e(Q,{id:"kc-login-with-email-switch","data-testid":"login-with-email-switch",value:a.loginWithEmailAllowed?"on":"off",label:t("common:on"),labelOff:t("common:off"),isChecked:a.loginWithEmailAllowed,onChange:h=>{g([{loginWithEmailAllowed:h},{duplicateEmailsAllowed:!1}])},"aria-label":t("loginWithEmailAllowed")})}),e(b,{label:t("duplicateEmailsAllowed"),fieldId:"kc-duplicate-emails",labelIcon:e(P,{helpText:"realm-settings:duplicateEmailsHelpText",fieldLabelId:"realm-settings:duplicateEmailsAllowed"}),hasNoPaddingTop:!0,children:e(Q,{id:"kc-duplicate-emails-switch","data-testid":"duplicate-emails-switch",label:t("common:on"),labelOff:t("common:off"),isChecked:a.duplicateEmailsAllowed||a.loginWithEmailAllowed&&a.registrationEmailAsUsername,onChange:h=>{g({duplicateEmailsAllowed:h})},isDisabled:a.loginWithEmailAllowed||a.registrationEmailAsUsername,"aria-label":t("duplicateEmailsAllowed")})}),e(b,{label:t("verifyEmail"),fieldId:"kc-verify-email",labelIcon:e(P,{helpText:"realm-settings:verifyEmailHelpText",fieldLabelId:"realm-settings:verifyEmail"}),hasNoPaddingTop:!0,children:e(Q,{id:"kc-verify-email-switch","data-testid":"verify-email-switch",name:"verifyEmail",value:a.verifyEmail?"on":"off",label:t("common:on"),labelOff:t("common:off"),isChecked:a.verifyEmail,onChange:h=>{g({verifyEmail:h})},"aria-label":t("verifyEmail")})})]})}),e(ce,{className:"kc-user-info-settings",title:t("userInfoSettings"),children:e(Y,{isHorizontal:!0,role:"manage-realm",children:e(b,{label:t("editUsernameAllowed"),fieldId:"kc-edit-username",labelIcon:e(P,{helpText:"realm-settings-help:editUsername",fieldLabelId:"realm-settings:editUsernameAllowed"}),hasNoPaddingTop:!0,children:e(Q,{id:"kc-edit-username-switch","data-testid":"edit-username-switch",value:a.editUsernameAllowed?"on":"off",label:t("common:on"),labelOff:t("common:off"),isChecked:a.editUsernameAllowed,onChange:h=>{g({editUsernameAllowed:h})},"aria-label":t("editUsernameAllowed")})})})})]})};const vn=({isOpen:a,onClose:n})=>{const{t}=F("realm-settings"),{realm:s}=le(),{adminClient:l}=se(),{addAlert:r,addError:d}=me(),[g,h]=m.exports.useState(!1),[i,S]=m.exports.useState(!1),[f,C]=m.exports.useState(!1),u=g||i;async function L(){C(!0);try{const y=await l.realms.export({realm:s,exportClients:i,exportGroupsAndRoles:g});ua.exports.saveAs(new Blob([Ze(y)],{type:"application/json"}),"realm-export.json"),r(t("exportSuccess"),te.success),n()}catch(y){d("exportFail",y)}C(!1)}return o(Ge,{variant:ze.small,title:t("partialExport"),isOpen:a,onClose:n,actions:[e(N,{"data-testid":"export-button",isDisabled:f,onClick:L,children:t("common:export")},"export"),e(N,{"data-testid":"cancel-button",variant:ae.link,onClick:n,children:t("common:cancel")},"cancel")],children:[e(dt,{children:e(Ke,{children:t("partialExportHeaderText")})}),o(kt,{isHorizontal:!0,className:"keycloak__realm-settings__partial-import_form",children:[e(b,{label:t("includeGroupsAndRoles"),fieldId:"include-groups-and-roles-check",hasNoPaddingTop:!0,children:e(Q,{id:"include-groups-and-roles-check","data-testid":"include-groups-and-roles-check",isChecked:g,onChange:h,label:t("common:on"),labelOff:t("common:off"),"aria-label":t("includeGroupsAndRoles")})}),e(b,{label:t("includeClients"),fieldId:"include-clients-check",hasNoPaddingTop:!0,children:e(Q,{id:"include-clients-check","data-testid":"include-clients-check",onChange:S,isChecked:i,label:t("common:on"),labelOff:t("common:off"),"aria-label":t("includeClients")})})]}),u&&e(lt,{"data-testid":"warning-message",variant:"warning",title:t("exportWarningTitle"),isInline:!0,children:t("exportWarningDescription")})]})},Ht={users:!1,clients:!1,groups:!1,identityProviders:!1,realmRoles:!1,clientRoles:!1},yn=a=>{const{t:n}=F("realm-settings"),{adminClient:t}=se(),{realm:s}=le(),[l,r]=m.exports.useState(),d=!!l,[g,h]=m.exports.useState(!1),[i,S]=m.exports.useState(!1),[f,C]=m.exports.useState(!1),[u,L]=m.exports.useState("FAIL"),[y,E]=m.exports.useState({}),[v,p]=m.exports.useState(),{addError:c}=me(),[k,M]=m.exports.useState(Ht),U=Object.values(k).some(T=>T),A=()=>{M(Ht)},I=()=>{r(void 0),E({}),L("FAIL"),A()};m.exports.useEffect(()=>{C(!1),p(void 0),I()},[a.open]);const V=T=>{I(),r(T),Array.isArray(T)?T.length>0&&E(T[0]):E(T)},z=T=>{E(T),h(!1),A()},D=(T,$)=>{const Ne=$.currentTarget.name;M({...k,[Ne]:T})},x=T=>T.map($=>e(ne,{value:$,"data-testid":$.id+"-select-option",children:$.realm||$.id},$.id)),H=(T,$)=>{L($),S(!1)},O=()=>[e(ne,{value:"FAIL",children:n("FAIL")},"fail"),e(ne,{value:"SKIP",children:n("SKIP")},"skip"),e(ne,{value:"OVERWRITE",children:n("OVERWRITE")},"overwrite")],_=()=>j("users")||j("groups")||j("clients")||j("identityProviders")||pe()||Se(),j=T=>{const $=y[T];return $!==void 0&&$.length>0},pe=()=>{const T=y.roles?.realm;return T!==void 0&&T.length>0},Se=()=>{const T=y.roles?.client;return T!==void 0&&Object.keys(T).length>0},q=T=>d?T==="realmRoles"?y.roles?.realm?.length??0:T==="clientRoles"?Se()?qe(y.roles.client):0:y[T]?.length??0:0,qe=T=>Object.values(T).reduce(($,Ne)=>$+Ne.length,0),oe=(T,$)=>e(qa,{"aria-labelledby":`${T}-list-item`,children:e(Wa,{children:e(Ja,{dataListCells:[e(Xa,{children:e(vt,{id:`${T}-checkbox`,label:`${q(T)} ${$}`,"aria-labelledby":`${T}-checkbox`,name:T,isChecked:k[T],onChange:D,"data-testid":T+"-checkbox"})},T)]})})}),Le=()=>{const T={ifResourceExists:u,id:y.id,realm:y.realm};return k.users&&(T.users=y.users),k.groups&&(T.groups=y.groups),k.identityProviders&&(T.identityProviders=y.identityProviders),k.clients&&(T.clients=y.clients),(k.realmRoles||k.clientRoles)&&(T.roles=y.roles,k.realmRoles||delete T.roles?.realm,k.clientRoles||delete T.roles?.client),T};async function et(){if(!f){C(!0);try{const T=await t.realms.partialImport({realm:s,rep:Le()});p(T)}catch(T){c("realm-settings:importFail",T)}C(!1)}}const Re=()=>e(Ge,{variant:ze.medium,title:n("partialImport"),isOpen:a.open,onClose:a.toggleDialog,actions:[e(N,{id:"modal-import","data-testid":"import-button",isDisabled:!U,onClick:()=>{et()},children:n("import")},"import"),e(N,{id:"modal-cancel","data-testid":"cancel-button",variant:ae.link,onClick:()=>{a.toggleDialog()},children:n("common:cancel")},"cancel")],children:o(Jt,{hasGutter:!0,children:[e(Pe,{children:e(dt,{children:e(Ke,{children:n("partialImportHeaderText")})})}),e(Pe,{children:e(ja,{id:"partial-import-file",allowEditingUploadedText:!0,onChange:V})}),d&&_()&&o(Z,{children:[e(Pe,{children:e(je,{})}),Array.isArray(l)&&l.length>1&&o(Pe,{children:[o(Ke,{children:[n("selectRealm"),":"]}),e(de,{toggleId:"realm-selector",isOpen:g,onToggle:()=>h(!g),onSelect:(T,$)=>z($),placeholderText:y.realm||y.id,children:x(l)})]}),o(Pe,{children:[o(Ke,{children:[n("chooseResources"),":"]}),o($a,{"aria-label":n("resourcesToImport"),isCompact:!0,children:[j("users")&&oe("users",n("common:users")),j("groups")&&oe("groups",n("common:groups")),j("clients")&&oe("clients",n("common:clients")),j("identityProviders")&&oe("identityProviders",n("common:identityProviders")),pe()&&oe("realmRoles",n("common:realmRoles")),Se()&&oe("clientRoles",n("common:clientRoles"))]})]}),o(Pe,{children:[o(Ke,{children:[n("selectIfResourceExists"),":"]}),e(de,{isOpen:i,direction:"up",onToggle:()=>{S(!i)},onSelect:H,placeholderText:n(u),children:O()})]})]})]})}),Fe=()=>`${n("importAdded",{count:v?.added})}  ${n("importSkipped",{count:v?.skipped})} ${n("importOverwritten",{count:v?.overwritten})}`,De=async(T=0,$=15)=>{if(!v)return[];const Ne=Math.min(T+$,v.results.length);return v.results.slice(T,Ne)},mt=T=>{switch(T.action){case"ADDED":return e(st,{color:"green",children:n("added")},T.id);case"SKIPPED":return e(st,{color:"orange",children:n("skipped")},T.id);case"OVERWRITTEN":return e(st,{color:"purple",children:n("overwritten")},T.id)}},We=T=>{const $=new Map([["CLIENT",n("common:clients")],["REALM_ROLE",n("common:realmRoles")],["USER",n("common:users")],["CLIENT_ROLE",n("common:clientRoles")],["IDP",n("common:identityProviders")],["GROUP",n("common:groups")]]);return e("span",{children:$.get(T.resourceType)})},tt=()=>o(Ge,{variant:ze.medium,title:n("partialImport"),isOpen:a.open,onClose:a.toggleDialog,actions:[e(N,{id:"modal-close","data-testid":"close-button",variant:ae.primary,onClick:()=>{a.toggleDialog()},children:n("common:close")},"close")],children:[e(lt,{variant:"success",isInline:!0,title:Fe()}),e(Ve,{loader:De,isPaginated:!0,ariaLabelKey:"realm-settings:partialImport",columns:[{name:"action",displayKey:"common:action",cellRenderer:mt},{name:"resourceType",displayKey:"common:type",cellRenderer:We},{name:"resourceName",displayKey:"common:name"},{name:"id",displayKey:"common:id"}]})]});return v?tt():Re()},Sn=()=>{const{t:a}=F("realm-settings"),{adminClient:n}=se(),{addAlert:t,addError:s}=me(),{realm:l}=le(),r=$e(),[d,g]=m.exports.useState(!1),[h,i]=m.exports.useState(),[S,f]=m.exports.useState(),[C,u]=m.exports.useState(0),[L,y]=m.exports.useState(),[E,v]=m.exports.useState(),p=()=>u(C+1),c=be({mode:"onChange"});Ce(()=>n.clientPolicies.listPolicies(),D=>{i(D.policies),v(D.policies||[]),y(Ze(D.policies))},[C]);const k=async()=>h??[],M=async()=>{const D=c.getValues(),x=h?.map(H=>{const O=D[H.name];return{...H,enabled:O}});try{await n.clientPolicies.updatePolicy({policies:x}),r(ft({realm:l,tab:"policies"})),t(a("realm-settings:updateClientPolicySuccess"),te.success)}catch(H){s("realm-settings:updateClientPolicyError",H)}},U=({name:D})=>e(fe,{to:pa({realm:l,policyName:D}),children:D}),A=({clientPolicy:D})=>{const[x,H]=ue({titleKey:"realm-settings:disablePolicyConfirmTitle",messageKey:"realm-settings:disablePolicyConfirm",continueButtonLabel:"common:disable",onConfirm:()=>{c.setValue(D.name,!1),M()}});return o(Z,{children:[e(H,{}),e(R,{name:D.name,"data-testid":`${D.name}-switch`,defaultValue:D.enabled,control:c.control,render:({field:O})=>e(Q,{label:a("common:enabled"),labelOff:a("common:disabled"),isChecked:O.value,onChange:_=>{_?(O.onChange(_),M()):x()},"aria-label":D.name})})]})},I=async()=>{if(!!L)try{const D=JSON.parse(L);try{await n.clientPolicies.updatePolicy({policies:D}),t(a("realm-settings:updateClientPoliciesSuccess"),te.success),p()}catch(x){s("realm-settings:updateClientPoliciesError",x)}}catch(D){console.warn("Invalid json, ignoring value using {}"),s("realm-settings:updateClientPoliciesError",D)}},[V,z]=ue({titleKey:a("deleteClientPolicyConfirmTitle"),messageKey:a("deleteClientPolicyConfirm",{policyName:S?.name}),continueButtonLabel:a("delete"),continueButtonVariant:ae.danger,onConfirm:async()=>{const D=h?.filter(x=>x.name!==S?.name);try{await n.clientPolicies.updatePolicy({policies:D}),t(a("deleteClientPolicySuccess"),te.success),p()}catch(x){s(a("deleteClientPolicyError"),x)}}});return h?o(Z,{children:[e(z,{}),e(ee,{children:o(ta,{className:"kc-policies-config-section",children:[e(He,{children:e(Qt,{headingLevel:"h1",size:"md",children:a("policiesConfigType")})}),e(He,{children:e(ot,{isChecked:!d,name:"policiesView",onChange:()=>g(!1),label:a("policiesConfigTypes.formView"),id:"formView-policiesView","data-testid":"formView-policiesView",className:"kc-form-radio-btn pf-u-mr-sm pf-u-ml-sm"})}),e(He,{children:e(ot,{isChecked:d,name:"policiesView",onChange:()=>g(!0),label:a("policiesConfigTypes.jsonEditor"),id:"jsonEditor-policiesView","data-testid":"jsonEditor-policiesView",className:"kc-editor-radio-btn"})})]})}),e(je,{}),d?o(Z,{children:[e("div",{className:"pf-u-mt-md pf-u-ml-lg",children:e(xt,{isLineNumbersVisible:!0,isLanguageLabelVisible:!0,isReadOnly:!1,code:L,language:Lt.json,height:"30rem",onChange:y})}),o("div",{className:"pf-u-mt-md",children:[e(N,{variant:ae.primary,className:"pf-u-mr-md pf-u-ml-lg","data-testid":"jsonEditor-policies-saveBtn",onClick:I,children:a("save")}),e(N,{variant:ae.link,"data-testid":"jsonEditor-reloadBtn",onClick:()=>{y(Ze(E))},children:a("reload")})]})]}):e(Ve,{emptyState:e(we,{message:a("realm-settings:noClientPolicies"),instructions:a("realm-settings:noClientPoliciesInstructions"),primaryActionText:a("realm-settings:createClientPolicy"),onPrimaryAction:()=>r(At({realm:l}))}),ariaLabelKey:"realm-settings:clientPolicies",searchPlaceholderKey:"realm-settings:clientPolicySearch",loader:k,toolbarItem:e(ye,{children:e(N,{id:"createPolicy",component:D=>e(fe,{...D,to:At({realm:l})}),"data-testid":"createPolicy",children:a("createClientPolicy")})}),actions:[{title:a("common:delete"),onRowClick:D=>{V(),f(D)}}],columns:[{name:"name",cellRenderer:U},{name:"enabled",displayKey:"realm-settings:status",cellRenderer:D=>e(A,{clientPolicy:D})},{name:"description"}]},h.length)]}):e(Ae,{})};function Tn(){const{t:a}=F("realm-settings"),{adminClient:n}=se(),{realm:t}=le(),{addAlert:s,addError:l}=me(),[r,d]=m.exports.useState(),[g,h]=m.exports.useState(),[i,S]=m.exports.useState(),[f,C]=m.exports.useState(!1),[u,L]=m.exports.useState(),[y,E]=m.exports.useState(0);Ce(()=>n.clientPolicies.listProfiles({includeGlobalProfiles:!0}),A=>{h(A.globalProfiles);const I=A.globalProfiles?.map(D=>({...D,global:!0})),V=A.profiles?.map(D=>({...D,global:!1})),z=I?.concat(V??[]);d(z||[]),L(JSON.stringify(z,null,2))},[y]);const v=async()=>r??[],p=A=>ga(A,"global"),[c,k]=ue({titleKey:a("deleteClientProfileConfirmTitle"),messageKey:a("deleteClientProfileConfirm",{profileName:i?.name}),continueButtonLabel:a("delete"),continueButtonVariant:ae.danger,onConfirm:async()=>{const A=r?.filter(I=>I.name!==i?.name&&!I.global).map(I=>p(I));try{await n.clientPolicies.createProfiles({profiles:A,globalProfiles:g}),s(a("deleteClientSuccess"),te.success),E(y+1)}catch(I){l(a("deleteClientError"),I)}}}),M=A=>o(fe,{to:fa({realm:t,profileName:A.name}),children:[A.name," ",A.global&&e(st,{color:"blue",children:a("global")})]},A.name);if(!r)return e(Ae,{});const U=async()=>{if(!!u)try{const A=JSON.parse(u),I=A.filter(z=>!z.global).map(z=>p(z)),V=A.filter(z=>z.global).map(z=>p(z));try{await n.clientPolicies.createProfiles({profiles:I,globalProfiles:V}),s(a("realm-settings:updateClientProfilesSuccess"),te.success),E(y+1)}catch(z){l("realm-settings:updateClientProfilesError",z)}}catch{console.warn("Invalid json, ignoring value using {}")}};return o(Z,{children:[e(k,{}),e(ee,{children:o(ta,{className:"kc-profiles-config-section",children:[e(He,{children:e(Qt,{headingLevel:"h1",size:"md",children:a("profilesConfigType")})}),e(He,{children:e(ot,{isChecked:!f,name:"profilesView",onChange:()=>C(!1),label:a("profilesConfigTypes.formView"),id:"formView-profilesView",className:"kc-form-radio-btn pf-u-mr-sm pf-u-ml-sm","data-testid":"formView-profilesView"})}),e(He,{children:e(ot,{isChecked:f,name:"profilesView",onChange:()=>C(!0),label:a("profilesConfigTypes.jsonEditor"),id:"jsonEditor-profilesView",className:"kc-editor-radio-btn","data-testid":"jsonEditor-profilesView"})})]})}),e(je,{}),f?o(b,{fieldId:"jsonEditor",children:[e("div",{className:"pf-u-mt-md pf-u-ml-lg",children:e(xt,{isLineNumbersVisible:!0,isLanguageLabelVisible:!0,isReadOnly:!1,code:u,language:Lt.json,height:"30rem",onChange:A=>{L(A??"")}})}),e(ve,{children:o("div",{className:"pf-u-mt-md",children:[e(N,{variant:ae.primary,className:"pf-u-mr-md pf-u-ml-lg",onClick:U,"data-testid":"jsonEditor-saveBtn",children:a("save")}),e(N,{variant:ae.link,onClick:()=>{L(Ze(r))},"data-testid":"jsonEditor-reloadBtn",children:a("reload")})]})})]}):e(Ve,{ariaLabelKey:"realm-settings:profiles",searchPlaceholderKey:"realm-settings:clientProfileSearch",loader:v,toolbarItem:e(ye,{children:e(N,{id:"createProfile",component:A=>e(fe,{...A,to:ha({realm:t,tab:"profiles"})}),"data-testid":"createProfile",children:a("createClientProfile")})}),isRowDisabled:A=>A.global,actions:[{title:a("common:delete"),onRowClick:A=>{S(A),c()}}],columns:[{name:"name",displayKey:a("common:name"),cellRenderer:M},{name:"description",displayKey:a("clientProfileDescription")}],emptyState:e(we,{message:a("emptyClientProfiles"),instructions:a("emptyClientProfilesInstructions")})},r.length)]})}const Me=({fieldName:a,url:n})=>{const{t}=F("realm-settings"),{register:s}=$t(),l=a.substr(a.indexOf(".")+1);return e(b,{label:t(l),fieldId:l,labelIcon:e(P,{helpText:o(ct,{i18nKey:`realm-settings-help:${l}`,children:["Default value prevents pages from being included",e(bt,{href:n,title:t("common:learnMore")})]}),fieldLabelId:l}),children:e(re,{id:l,...s(a)})})};const Cn=({realm:a,save:n})=>{const{t}=F(),s=be(),{setValue:l,formState:{isDirty:r},handleSubmit:d}=s,g=()=>xe(a,l);return m.exports.useEffect(g,[]),e(Ct,{...s,children:o(Y,{isHorizontal:!0,role:"manage-realm",className:"keycloak__security-defences__form",onSubmit:d(n),children:[e(Me,{fieldName:"browserSecurityHeaders.xFrameOptions",url:"https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/X-Frame-Options"}),e(Me,{fieldName:"browserSecurityHeaders.contentSecurityPolicy",url:"https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Content-Security-Policy"}),e(Me,{fieldName:"browserSecurityHeaders.contentSecurityPolicyReportOnly",url:"https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Content-Security-Policy-Report-Only"}),e(Me,{fieldName:"browserSecurityHeaders.xContentTypeOptions",url:"https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/X-Content-Type-Options"}),e(Me,{fieldName:"browserSecurityHeaders.xRobotsTag",url:"https://developers.google.com/search/docs/advanced/robots/robots_meta_tag"}),e(Me,{fieldName:"browserSecurityHeaders.xXSSProtection",url:"https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/X-XSS-Protection"}),e(Me,{fieldName:"browserSecurityHeaders.strictTransportSecurity",url:"https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Strict-Transport-Security"}),o(ve,{children:[e(N,{variant:"primary",type:"submit","data-testid":"headers-form-tab-save",isDisabled:!r,children:t("common:save")}),e(N,{variant:"link",onClick:g,children:t("common:revert")})]})]})})},nt=({name:a,style:n})=>{const{t}=F("realm-settings"),{control:s,formState:{errors:l}}=$t();return e(b,{style:n,label:t(a),fieldId:a,labelIcon:e(P,{helpText:`realm-settings-help:${a}`,fieldLabelId:`realm-settings:${a}`}),validated:l[a]?he.error:he.default,helperTextInvalid:t("common:required"),children:e(R,{name:a,defaultValue:"",control:s,rules:{required:!0},render:({field:r})=>e(J,{"data-testid":a,value:r.value,onChange:r.onChange,validated:l[a]?he.error:he.default})})})},kn=({realm:a,save:n})=>{const{t}=F("realm-settings"),s=be(),{setValue:l,handleSubmit:r,control:d,formState:{isDirty:g}}=s,h=Ie({control:d,name:"bruteForceProtected"}),i=Ie({control:d,name:"permanentLockout"}),S=()=>xe(a,l);return m.exports.useEffect(S,[]),e(Ct,{...s,children:o(Y,{role:"manage-realm",isHorizontal:!0,onSubmit:r(n),children:[e(b,{label:t("common:enabled"),fieldId:"bruteForceProtected",hasNoPaddingTop:!0,children:e(R,{name:"bruteForceProtected",defaultValue:!1,control:d,render:({field:f})=>e(Q,{id:"bruteForceProtected",label:t("common:on"),labelOff:t("common:off"),isChecked:f.value,onChange:f.onChange})})}),h&&o(Z,{children:[e(b,{label:t("failureFactor"),labelIcon:e(P,{helpText:"realm-settings-help:failureFactor",fieldLabelId:"realm-settings:failureFactor"}),fieldId:"failureFactor",children:e(R,{name:"failureFactor",defaultValue:0,control:d,rules:{required:!0},render:({field:f})=>e(yt,{type:"text",id:"failureFactor",value:f.value,onPlus:()=>f.onChange(f.value+1),onMinus:()=>f.onChange(f.value-1),onChange:C=>f.onChange(Number(C.target.value))})})}),e(b,{label:t("permanentLockout"),fieldId:"permanentLockout",hasNoPaddingTop:!0,children:e(R,{name:"permanentLockout",defaultValue:!1,control:d,render:({field:f})=>e(Q,{id:"permanentLockout",label:t("common:on"),labelOff:t("common:off"),isChecked:f.value,onChange:f.onChange,"aria-label":t("permanentLockout")})})}),!i&&o(Z,{children:[e(nt,{name:"waitIncrementSeconds"}),e(nt,{name:"maxFailureWaitSeconds"}),e(nt,{name:"maxDeltaTimeSeconds"})]}),e(b,{label:t("quickLoginCheckMilliSeconds"),labelIcon:e(P,{helpText:"realm-settings-help:quickLoginCheckMilliSeconds",fieldLabelId:"realm-settings:quickLoginCheckMilliSeconds"}),fieldId:"quickLoginCheckMilliSeconds",children:e(R,{name:"quickLoginCheckMilliSeconds",defaultValue:0,control:d,render:({field:f})=>e(yt,{type:"text",id:"quickLoginCheckMilliSeconds",value:f.value,onPlus:()=>f.onChange(f.value+1),onMinus:()=>f.onChange(f.value-1),onChange:C=>f.onChange(Number(C.target.value))})})}),e(nt,{name:"minimumQuickLoginWaitSeconds"})]}),o(ve,{children:[e(N,{variant:"primary",type:"submit","data-testid":"brute-force-tab-save",isDisabled:!g,children:t("common:save")}),e(N,{variant:"link",onClick:S,children:t("common:revert")})]})]})})},In=({realm:a,save:n})=>{const{t}=F("realm-settings"),[s,l]=m.exports.useState(10);return o(It,{activeKey:s,onSelect:(r,d)=>l(d),children:[e(B,{id:"headers",eventKey:10,title:e(G,{children:t("headers")}),children:e(ee,{variant:"light",children:e(Cn,{realm:a,save:n})})}),e(B,{id:"bruteForce",eventKey:20,title:e(G,{children:t("bruteForceDetection")}),children:e(ee,{variant:"light",children:e(kn,{realm:a,save:n})})})]})},xn=({realm:a,save:n})=>{const{t}=F("realm-settings"),{setValue:s,control:l,handleSubmit:r,formState:d}=be(),g=Ie({control:l,name:"offlineSessionMaxLifespanEnabled"}),h=()=>{xe(a,s)};return m.exports.useEffect(h,[]),o(ee,{variant:"light",children:[e(ce,{title:t("SSOSessionSettings"),className:"kc-sso-session-template",children:o(Y,{isHorizontal:!0,role:"manage-realm",onSubmit:r(n),children:[e(b,{label:t("SSOSessionIdle"),fieldId:"SSOSessionIdle",labelIcon:e(P,{helpText:"realm-settings-help:ssoSessionIdle",fieldLabelId:"realm-settings:SSOSessionIdle"}),children:e(R,{name:"ssoSessionIdleTimeout",defaultValue:a.ssoSessionIdleTimeout,control:l,render:({field:i})=>e(J,{className:"kc-sso-session-idle","data-testid":"sso-session-idle-input",value:i.value,onChange:i.onChange,units:["minute","hour","day"]})})}),e(b,{label:t("SSOSessionMax"),fieldId:"SSOSessionMax",labelIcon:e(P,{helpText:"realm-settings-help:ssoSessionMax",fieldLabelId:"realm-settings:SSOSessionMax"}),children:e(R,{name:"ssoSessionMaxLifespan",control:l,render:({field:i})=>e(J,{className:"kc-sso-session-max","data-testid":"sso-session-max-input",value:i.value,onChange:i.onChange,units:["minute","hour","day"]})})}),e(b,{label:t("SSOSessionIdleRememberMe"),fieldId:"SSOSessionIdleRememberMe",labelIcon:e(P,{helpText:"realm-settings-help:ssoSessionIdleRememberMe",fieldLabelId:"realm-settings:SSOSessionIdleRememberMe"}),children:e(R,{name:"ssoSessionIdleTimeoutRememberMe",control:l,render:({field:i})=>e(J,{className:"kc-sso-session-idle-remember-me","data-testid":"sso-session-idle-remember-me-input",value:i.value,onChange:i.onChange,units:["minute","hour","day"]})})}),e(b,{label:t("SSOSessionMaxRememberMe"),fieldId:"SSOSessionMaxRememberMe",labelIcon:e(P,{helpText:"realm-settings-help:ssoSessionMaxRememberMe",fieldLabelId:"realm-settings:SSOSessionMaxRememberMe"}),children:e(R,{name:"ssoSessionMaxLifespanRememberMe",control:l,render:({field:i})=>e(J,{className:"kc-sso-session-max-remember-me","data-testid":"sso-session-max-remember-me-input",value:i.value,onChange:i.onChange,units:["minute","hour","day"]})})})]})}),e(ce,{title:t("clientSessionSettings"),className:"kc-client-session-template",children:o(Y,{isHorizontal:!0,role:"manage-realm",className:"pf-u-mt-lg",onSubmit:r(n),children:[e(b,{label:t("clientSessionIdle"),fieldId:"clientSessionIdle",labelIcon:e(P,{helpText:"realm-settings-help:clientSessionIdle",fieldLabelId:"realm-settings:clientSessionIdle"}),children:e(R,{name:"clientSessionIdleTimeout",control:l,render:({field:i})=>e(J,{className:"kc-client-session-idle","data-testid":"client-session-idle-input",value:i.value,onChange:i.onChange,units:["minute","hour","day"]})})}),e(b,{label:t("clientSessionMax"),fieldId:"clientSessionMax",labelIcon:e(P,{helpText:"realm-settings-help:clientSessionMax",fieldLabelId:"realm-settings:clientSessionMax"}),children:e(R,{name:"clientSessionMaxLifespan",control:l,render:({field:i})=>e(J,{className:"kc-client-session-max","data-testid":"client-session-max-input",value:i.value,onChange:i.onChange,units:["minute","hour","day"]})})})]})}),e(ce,{title:t("offlineSessionSettings"),className:"kc-offline-session-template",children:o(Y,{isHorizontal:!0,role:"manage-realm",className:"pf-u-mt-lg",onSubmit:r(n),children:[e(b,{label:t("offlineSessionIdle"),fieldId:"offlineSessionIdle",labelIcon:e(P,{helpText:"realm-settings-help:offlineSessionIdle",fieldLabelId:"realm-settings:offlineSessionIdle"}),children:e(R,{name:"offlineSessionIdleTimeout",control:l,render:({field:i})=>e(J,{className:"kc-offline-session-idle","data-testid":"offline-session-idle-input","aria-label":"offline-session-idle-input",value:i.value,onChange:i.onChange,units:["minute","hour","day"]})})}),e(b,{hasNoPaddingTop:!0,label:t("offlineSessionMaxLimited"),fieldId:"kc-offlineSessionMaxLimited",labelIcon:e(P,{helpText:"realm-settings-help:offlineSessionMaxLimited",fieldLabelId:"realm-settings:offlineSessionMaxLimited"}),children:e(R,{name:"offlineSessionMaxLifespanEnabled",control:l,defaultValue:!1,render:({field:i})=>e(Q,{id:"kc-offline-session-max","data-testid":"offline-session-max-switch","aria-label":t("offlineSessionMaxLimited"),label:t("common:enabled"),labelOff:t("common:disabled"),isChecked:i.value,onChange:i.onChange})})}),g&&e(b,{label:t("offlineSessionMax"),fieldId:"offlineSessionMax",id:"offline-session-max-label",labelIcon:e(P,{helpText:"realm-settings-help:offlineSessionMax",fieldLabelId:"realm-settings:offlineSessionMax"}),children:e(R,{name:"offlineSessionMaxLifespan",control:l,render:({field:i})=>e(J,{className:"kc-offline-session-max","data-testid":"offline-session-max-input",value:i.value,onChange:i.onChange,units:["minute","hour","day"]})})})]})}),e(ce,{className:"kc-login-settings-template",title:t("loginSettings"),children:o(Y,{isHorizontal:!0,role:"manage-realm",className:"pf-u-mt-lg",onSubmit:r(n),children:[e(b,{label:t("loginTimeout"),id:"kc-login-timeout-label",fieldId:"offlineSessionIdle",labelIcon:e(P,{helpText:"realm-settings-help:loginTimeout",fieldLabelId:"realm-settings:loginTimeout"}),children:e(R,{name:"accessCodeLifespanLogin",control:l,render:({field:i})=>e(J,{className:"kc-login-timeout","data-testid":"login-timeout-input","aria-label":"login-timeout-input",value:i.value,onChange:i.onChange,units:["minute","hour","day"]})})}),e(b,{label:t("loginActionTimeout"),fieldId:"loginActionTimeout",id:"login-action-timeout-label",labelIcon:e(P,{helpText:"realm-settings-help:loginActionTimeout",fieldLabelId:"realm-settings:loginActionTimeout"}),children:e(R,{name:"accessCodeLifespanUserAction",control:l,render:({field:i})=>e(J,{className:"kc-login-action-timeout","data-testid":"login-action-timeout-input",value:i.value,onChange:i.onChange,units:["minute","hour","day"]})})}),o(ve,{children:[e(N,{variant:"primary",type:"submit","data-testid":"sessions-tab-save",isDisabled:!d.isDirty,children:t("common:save")}),e(N,{variant:"link",onClick:h,children:t("common:revert")})]})]})})]})},Ln=({realm:a,save:n})=>{const{t}=F("realm-settings"),[s,l]=m.exports.useState(!1),[r,d]=m.exports.useState(!1),[g,h]=m.exports.useState(!1),[i,S]=m.exports.useState(!1),{control:f,handleSubmit:C,setValue:u}=be(),L=_e().themes,y=()=>{xe(a,u)};return m.exports.useEffect(y,[]),e(ee,{variant:"light",children:o(Y,{isHorizontal:!0,role:"manage-realm",className:"pf-u-mt-lg",onSubmit:C(n),children:[e(b,{label:t("loginTheme"),fieldId:"kc-login-theme",labelIcon:e(P,{helpText:"realm-settings-help:loginTheme",fieldLabelId:"realm-settings:loginTheme"}),children:e(R,{name:"loginTheme",control:f,defaultValue:"",render:({field:E})=>e(de,{toggleId:"kc-login-theme",onToggle:()=>l(!s),onSelect:(v,p)=>{E.onChange(p),l(!1)},selections:E.value,variant:ge.single,"aria-label":t("loginTheme"),isOpen:s,placeholderText:"Select a theme","data-testid":"select-login-theme",children:L.login.map((v,p)=>e(ne,{selected:v.name===E.value,value:v.name,children:t(`${v.name}`)},`login-theme-${p}`))})})}),e(b,{label:t("accountTheme"),fieldId:"kc-account-theme",labelIcon:e(P,{helpText:"realm-settings-help:accountTheme",fieldLabelId:"realm-settings:accountTheme"}),children:e(R,{name:"accountTheme",control:f,defaultValue:"",render:({field:E})=>e(de,{toggleId:"kc-account-theme",onToggle:()=>d(!r),onSelect:(v,p)=>{E.onChange(p),d(!1)},selections:E.value,variant:ge.single,"aria-label":t("accountTheme"),isOpen:r,placeholderText:"Select a theme","data-testid":"select-account-theme",children:L.account.map((v,p)=>e(ne,{selected:v.name===E.value,value:v.name,children:t(`${v.name}`)},`account-theme-${p}`))})})}),e(b,{label:t("adminTheme"),fieldId:"kc-admin-ui-theme",labelIcon:e(P,{helpText:"realm-settings-help:adminUITheme",fieldLabelId:"realm-settings:adminTheme"}),children:e(R,{name:"adminTheme",control:f,defaultValue:"",render:({field:E})=>e(de,{toggleId:"kc-admin-ui-theme",onToggle:()=>h(!g),onSelect:(v,p)=>{E.onChange(p),h(!1)},selections:E.value,variant:ge.single,"aria-label":t("adminUITheme"),isOpen:g,placeholderText:"Select a theme","data-testid":"select-admin-theme",children:L.admin.map((v,p)=>e(ne,{selected:v.name===E.value,value:v.name,children:t(`${v.name}`)},`admin-theme-${p}`))})})}),e(b,{label:t("emailTheme"),fieldId:"kc-email-theme",labelIcon:e(P,{helpText:"realm-settings-help:emailTheme",fieldLabelId:"realm-settings:emailTheme"}),children:e(R,{name:"emailTheme",control:f,defaultValue:"",render:({field:E})=>e(de,{toggleId:"kc-email-theme",onToggle:()=>S(!i),onSelect:(v,p)=>{E.onChange(p),S(!1)},selections:E.value,variant:ge.single,"aria-label":t("emailTheme"),isOpen:i,placeholderText:"Select a theme","data-testid":"select-email-theme",children:L.email.map((v,p)=>e(ne,{selected:v.name===E.value,value:v.name,children:t(`${v.name}`)},`email-theme-${p}`))})})}),o(ve,{children:[e(N,{variant:"primary",type:"submit","data-testid":"themes-tab-save",children:t("common:save")}),e(N,{variant:"link",onClick:y,children:t("common:revert")})]})]})})},En=({realm:a,reset:n,save:t})=>{const{t:s}=F("realm-settings"),l=_e(),{whoAmI:r}=Tt(),[d,g]=m.exports.useState(!1),h=l.componentTypes?.["org.keycloak.keys.KeyProvider"]??[],i=["ES256","ES384","ES512"],S=h[2].properties[4].options,f=h[3].properties[3].options,C=i.concat(S,f),u=be(),{setValue:L,control:y}=u,E=Ie({control:y,name:"offlineSessionMaxLifespanEnabled",defaultValue:a.offlineSessionMaxLifespanEnabled}),v=Ie({control:y,name:"ssoSessionIdleTimeout",defaultValue:36e3}),p=Ie({control:y,name:"revokeRefreshToken",defaultValue:!1});return m.exports.useEffect(()=>{xe(a,L)},[]),o(ee,{variant:"light",children:[e(ce,{title:s("realm-settings:general"),className:"kc-sso-session-template",children:o(Y,{isHorizontal:!0,role:"manage-realm",onSubmit:u.handleSubmit(t),children:[e(b,{label:s("defaultSigAlg"),fieldId:"kc-default-signature-algorithm",labelIcon:e(P,{helpText:"realm-settings-help:defaultSigAlg",fieldLabelId:"realm-settings:algorithm"}),children:e(R,{name:"defaultSignatureAlgorithm",defaultValue:"RS256",control:u.control,render:({field:c})=>e(de,{toggleId:"kc-default-sig-alg",onToggle:()=>g(!d),onSelect:(k,M)=>{c.onChange(M.toString()),g(!1)},selections:[c.value?.toString()],variant:ge.single,"aria-label":s("defaultSigAlg"),isOpen:d,"data-testid":"select-default-sig-alg",children:C.map((k,M)=>e(ne,{selected:k===c.value,value:k},`default-sig-alg-${M}`))})})}),e(b,{label:s("shortVerificationUri"),fieldId:"shortVerificationUri",labelIcon:e(P,{helpText:"realm-settings-help:shortVerificationUriTooltip",fieldLabelId:"realm-settings:shortVerificationUri"}),children:e(R,{name:"attributes.shortVerificationUri",defaultValue:"",control:u.control,render:({field:c})=>e(re,{id:"shortVerificationUri",value:c.value,onChange:c.onChange,placeholder:s("shortVerificationUri")})})})]})}),e(ce,{title:s("realm-settings:refreshTokens"),className:"kc-client-session-template",children:o(Y,{isHorizontal:!0,role:"manage-realm",className:"pf-u-mt-lg",onSubmit:u.handleSubmit(t),children:[e(b,{hasNoPaddingTop:!0,label:s("revokeRefreshToken"),fieldId:"kc-revoke-refresh-token",labelIcon:e(P,{helpText:"realm-settings-help:revokeRefreshToken",fieldLabelId:"realm-settings:revokeRefreshToken"}),children:e(R,{name:"revokeRefreshToken",control:u.control,defaultValue:!1,render:({field:c})=>e(Q,{id:"kc-revoke-refresh-token","data-testid":"revoke-refresh-token-switch","aria-label":s("revokeRefreshToken"),label:s("common:enabled"),labelOff:s("common:disabled"),isChecked:c.value,onChange:c.onChange})})}),p&&e(b,{label:s("refreshTokenMaxReuse"),labelIcon:e(P,{helpText:"realm-settings-help:refreshTokenMaxReuse",fieldLabelId:"realm-settings:refreshTokenMaxReuse"}),fieldId:"refreshTokenMaxReuse",children:e(R,{name:"refreshTokenMaxReuse",defaultValue:0,control:u.control,render:({field:c})=>e(yt,{type:"text",id:"refreshTokenMaxReuseMs",value:c.value,onPlus:()=>c.onChange(c.value+1),onMinus:()=>c.onChange(c.value-1),onChange:k=>c.onChange(Number(k.target.value))})})})]})}),e(ce,{title:s("realm-settings:accessTokens"),className:"kc-offline-session-template",children:o(Y,{isHorizontal:!0,role:"manage-realm",className:"pf-u-mt-lg",onSubmit:u.handleSubmit(t),children:[e(b,{label:s("accessTokenLifespan"),fieldId:"accessTokenLifespan",helperText:s("recommendedSsoTimeout",{time:Va(v,r.getLocale())}),labelIcon:e(P,{helpText:"realm-settings-help:accessTokenLifespan",fieldLabelId:"realm-settings:accessTokenLifespan"}),children:e(R,{name:"accessTokenLifespan",control:u.control,render:({field:c})=>e(J,{validated:c.value>v?"warning":"default",className:"kc-access-token-lifespan","data-testid":"access-token-lifespan-input","aria-label":"access-token-lifespan",value:c.value,onChange:c.onChange,units:["minute","hour","day"]})})}),e(b,{label:s("accessTokenLifespanImplicitFlow"),fieldId:"accessTokenLifespanImplicitFlow",labelIcon:e(P,{helpText:"realm-settings-help:accessTokenLifespanImplicitFlow",fieldLabelId:"realm-settings:accessTokenLifespanImplicitFlow"}),children:e(R,{name:"accessTokenLifespanForImplicitFlow",control:u.control,render:({field:c})=>e(J,{className:"kc-access-token-lifespan-implicit","data-testid":"access-token-lifespan-implicit-input",value:c.value,onChange:c.onChange,units:["minute","hour","day"]})})}),e(b,{label:s("clientLoginTimeout"),fieldId:"clientLoginTimeout",labelIcon:e(P,{helpText:"realm-settings-help:clientLoginTimeout",fieldLabelId:"realm-settings:clientLoginTimeout"}),children:e(R,{name:"accessCodeLifespan",control:u.control,render:({field:c})=>e(J,{className:"kc-client-login-timeout","data-testid":"client-login-timeout-input","aria-label":"client-login-timeout",value:c.value,onChange:c.onChange,units:["minute","hour","day"]})})}),E&&e(b,{label:s("offlineSessionMax"),fieldId:"offlineSessionMax",id:"offline-session-max-label",labelIcon:e(P,{helpText:"realm-settings-help:offlineSessionMax",fieldLabelId:"realm-settings:offlineSessionMax"}),children:e(R,{name:"offlineSessionMaxLifespan",control:u.control,render:({field:c})=>e(J,{className:"kc-offline-session-max","data-testid":"offline-session-max-input",value:c.value,onChange:c.onChange,units:["minute","hour","day"]})})})]})}),e(ce,{className:"kc-login-settings-template",title:s("actionTokens"),children:o(Y,{isHorizontal:!0,role:"manage-realm",className:"pf-u-mt-lg",onSubmit:u.handleSubmit(t),children:[e(b,{label:s("userInitiatedActionLifespan"),id:"kc-user-initiated-action-lifespan",fieldId:"userInitiatedActionLifespan",labelIcon:e(P,{helpText:"realm-settings-help:userInitiatedActionLifespan",fieldLabelId:"realm-settings:userInitiatedActionLifespan"}),children:e(R,{name:"actionTokenGeneratedByUserLifespan",control:u.control,render:({field:c})=>e(J,{className:"kc-user-initiated-action-lifespan","data-testid":"user-initiated-action-lifespan","aria-label":"user-initiated-action-lifespan",value:c.value,onChange:c.onChange,units:["minute","hour","day"]})})}),e(b,{label:s("defaultAdminInitiated"),fieldId:"defaultAdminInitiated",id:"default-admin-initiated-label",labelIcon:e(P,{helpText:"realm-settings-help:defaultAdminInitiatedActionLifespan",fieldLabelId:"realm-settings:defaultAdminInitiated"}),children:e(R,{name:"actionTokenGeneratedByAdminLifespan",control:u.control,render:({field:c})=>e(J,{className:"kc-default-admin-initiated","data-testid":"default-admin-initated-input","aria-label":"default-admin-initated-input",value:c.value,onChange:c.onChange,units:["minute","hour","day"]})})}),e(Ke,{className:"kc-override-action-tokens-subtitle",component:_a.h1,children:s("overrideActionTokens")}),e(b,{label:s("emailVerification"),fieldId:"emailVerification",id:"email-verification",children:e(R,{name:"attributes.actionTokenGeneratedByUserLifespan-verify-email",defaultValue:"",control:u.control,render:({field:c})=>e(J,{className:"kc-email-verification","data-testid":"email-verification-input",value:c.value,onChange:k=>c.onChange(k.toString()),units:["minute","hour","day"]})})}),e(b,{label:s("idpAccountEmailVerification"),fieldId:"idpAccountEmailVerification",id:"idp-acct-label",children:e(R,{name:"attributes.actionTokenGeneratedByUserLifespan-idp-verify-account-via-email",defaultValue:"",control:u.control,render:({field:c})=>e(J,{className:"kc-idp-email-verification","data-testid":"idp-email-verification-input",value:c.value,onChange:c.onChange,units:["minute","hour","day"]})})}),e(b,{label:s("forgotPassword"),fieldId:"forgotPassword",id:"forgot-password-label",children:e(R,{name:"attributes.actionTokenGeneratedByUserLifespan-reset-credentials",defaultValue:"",control:u.control,render:({field:c})=>e(J,{className:"kc-forgot-pw","data-testid":"forgot-pw-input",value:c.value,onChange:c.onChange,units:["minute","hour","day"]})})}),e(b,{label:s("executeActions"),fieldId:"executeActions",id:"execute-actions",children:e(R,{name:"attributes.actionTokenGeneratedByUserLifespan-execute-actions",defaultValue:"",control:u.control,render:({field:c})=>e(J,{className:"kc-execute-actions","data-testid":"execute-actions-input",value:c.value,onChange:c.onChange,units:["minute","hour","day"]})})}),o(ve,{children:[e(N,{variant:"primary",type:"submit","data-testid":"tokens-tab-save",isDisabled:!u.formState.isDirty,children:s("common:save")}),e(N,{variant:"link",onClick:n,children:s("common:revert")})]})]})})]})},Pn=()=>{const{config:a,save:n}=Et(),{t}=F("realm-settings"),s=$e(),{realm:l}=le(),[r,d]=m.exports.useState(0),[g,h]=m.exports.useState();m.exports.useEffect(()=>d(u=>u+1),[a]);async function i(){return a?.groups??[]}const[S,f]=ue({titleKey:"realm-settings:deleteDialogTitle",children:o(ct,{i18nKey:"realm-settings:deleteDialogDescription",children:[" ",e("strong",{children:{group:g?.name}}),"."]}),continueButtonLabel:"common:delete",continueButtonVariant:ae.danger,onConfirm(){const u=(a?.groups??[]).filter(L=>L!==g);n({...a,groups:u},{successMessageKey:"realm-settings:deleteSuccess",errorMessageKey:"realm-settings:deleteAttributeGroupError"})}});function C(u){h(u),S()}return o(ee,{variant:"light",className:"pf-u-p-0",children:[e(f,{}),e(Ve,{loader:i,ariaLabelKey:"realm-settings:tableTitle",toolbarItem:e(ye,{children:e(N,{component:u=>e(fe,{...u,to:Rt({realm:l})}),children:t("createGroupText")})}),columns:[{name:"name",displayKey:"realm-settings:columnName",cellRenderer:u=>e(fe,{to:ba({realm:l,name:u.name}),children:u.name})},{name:"displayHeader",displayKey:"realm-settings:columnDisplayName"},{name:"displayDescription",displayKey:"realm-settings:columnDisplayDescription"}],actions:[{title:t("common:delete"),onRowClick:C}],emptyState:e(we,{message:t("emptyStateMessage"),instructions:t("emptyStateInstructions"),primaryActionText:t("createGroupText"),onPrimaryAction:()=>s(Rt({realm:l}))})},r)]})},wn=["username","email"],An=()=>{const{config:a,save:n}=Et(),{realm:t}=le(),{t:s}=F("realm-settings"),l=$e(),[r,d]=m.exports.useState("allGroups"),[g,h]=Be(),[i,S]=m.exports.useState(a?.attributes),[f,C]=m.exports.useState(""),u=async(p,c)=>{const k=a?.attributes.findIndex(U=>U.name===p.name);let M={};M=a?.attributes[k],a?.attributes.splice(k,1),a?.attributes.splice(c,0,M),n({attributes:a?.attributes,groups:a?.groups},{successMessageKey:"realm-settings:updatedUserProfileSuccess",errorMessageKey:"realm-settings:updatedUserProfileError"})},L=a?.attributes.filter(p=>p.name!==f),[y,E]=ue({titleKey:s("deleteAttributeConfirmTitle"),messageKey:s("deleteAttributeConfirm",{attributeName:f}),continueButtonLabel:s("common:delete"),continueButtonVariant:ae.danger,onConfirm:async()=>{n({attributes:L,groups:a?.groups},{successMessageKey:"realm-settings:deleteAttributeSuccess",errorMessageKey:"realm-settings:deleteAttributeError"}),C("")}}),v=p=>e(fe,{to:Dt({realm:t,attributeName:p.name}),children:p.name},p.name);return a?.attributes?o(Z,{children:[e(Xt,{children:o(Aa,{children:[e(ye,{children:e(de,{width:200,"data-testid":"filter-select",isOpen:g,variant:ge.single,onToggle:h,toggleIcon:e(Zt,{}),onSelect:(p,c)=>{const k=c.toString();d(k),S(k==="allGroups"?a.attributes:a.attributes?.filter(M=>M.group===k)),h()},selections:r==="allGroups"?s(r):r,children:[e(ne,{"data-testid":"all-groups",value:"allGroups",children:s("allGroups")},"allGroups"),...a.attributes.filter(p=>!!p.group).map(p=>e(ne,{"data-testid":`${p.group}-option`,value:p.group},p.group))]})}),e(ye,{className:"kc-toolbar-attributesTab",children:e(N,{"data-testid":"createAttributeBtn",variant:"primary",component:p=>e(fe,{...p,to:va({realm:t})}),children:s("createAttribute")})})]})}),e(je,{}),e(E,{}),e(ea,{keyField:"name",onDragFinish:async(p,c)=>{const k=a.attributes.map(I=>I.name),M=c.indexOf(p),U=k.indexOf(p),A=a.attributes[U];!A.name||u(A,M)},actions:[{title:s("common:edit"),onClick:(p,c,k)=>{l(Dt({realm:t,attributeName:k.name}))}},{title:s("common:delete"),isActionable:({name:p})=>!wn.includes(p),onClick:(p,c,k)=>{C(k.name),y()}}],columns:[{name:"name",displayKey:s("attributeName"),cellRenderer:v},{name:"displayName",displayKey:s("attributeDisplayName")},{name:"group",displayKey:s("attributeGroup")}],data:i||a.attributes})]}):e(Ae,{})},Rn=()=>{const{config:a,save:n,isSaving:t}=Et(),{t:s}=F(),{addError:l}=me(),[r,d]=m.exports.useState();m.exports.useEffect(()=>g(),[a,r]);function g(){r?.setValue(a?Ze(a):"")}async function h(){const i=r?.getValue();if(!!i)try{await n(JSON.parse(i))}catch(S){l("realm-settings:invalidJsonError",S);return}}return o(ee,{variant:"light",children:[e(xt,{language:Lt.json,height:"30rem",onEditorDidMount:i=>d(i),isLanguageLabelVisible:!0}),e(kt,{children:o(ve,{children:[e(N,{"data-testid":"save",variant:"primary",onClick:h,isDisabled:t,children:s("common:save")}),e(N,{variant:"link",onClick:g,isDisabled:t,children:s("common:revert")})]})})]})},Dn=()=>{const{realm:a}=le(),{t:n}=F("realm-settings"),t=d=>rt(Nt({realm:a,tab:d})),s=t("attributes"),l=t("attributes-group"),r=t("json-editor");return e(Qa,{children:o(it,{defaultLocation:Nt({realm:a,tab:"attributes"}),mountOnEnter:!0,children:[e(B,{title:e(G,{children:n("attributes")}),"data-testid":"attributesTab",...s,children:e(An,{})}),e(B,{title:e(G,{children:n("attributesGroup")}),"data-testid":"attributesGroupTab",...l,children:e(Pn,{})}),e(B,{title:e(G,{children:n("jsonEditor")}),"data-testid":"jsonEditorTab",...r,children:e(Rn,{})})]})})},Nn=()=>{const{t:a}=F("realm-settings"),[n,t]=Be(),[s,l]=Be(),[r,d]=m.exports.useState(),[g,h]=m.exports.useState([]),[i,S]=m.exports.useState(0),[f,C]=m.exports.useState(0),u=()=>C(f+1),{adminClient:L}=se(),{realm:y}=le(),{addAlert:E,addError:v}=me(),{enabled:p}=ya();Ce(()=>L.realms.getDefaultGroups({realm:y}),I=>{d(I),S(i+1)},[f]);const c=()=>Promise.resolve(r),k=async()=>{try{await Promise.all(g.map(I=>L.realms.removeDefaultGroup({realm:y,id:I.id}))),E(a("groupRemove",{count:g.length}),te.success),h([])}catch(I){v("realm-settings:groupRemoveError",I)}u()},M=async I=>{try{await Promise.all(I.map(V=>L.realms.addDefaultGroup({realm:y,id:V.id}))),E(a("defaultGroupAdded",{count:I.length}),te.success)}catch(V){v("realm-settings:defaultGroupAddedError",V)}u()},[U,A]=ue({titleKey:a("removeConfirmTitle",{count:g.length}),messageKey:a("removeConfirm",{count:g.length}),continueButtonLabel:"common:delete",continueButtonVariant:ae.danger,onConfirm:k});return r?o(Z,{children:[e(A,{}),s&&e(Za,{type:"selectMany",text:{title:"realm-settings:addDefaultGroups",ok:"common:add"},onConfirm:I=>{M(I||[]),l()},onClose:l}),p&&e(Ra,{bodyContent:o(ct,{i18nKey:"realm-settings-help:defaultGroups",children:[" ",e(fe,{to:Ot({realm:y})}),"."]}),children:e(dt,{className:"keycloak__section_intro__help",style:{paddingLeft:"var(--pf-c-page__main-section--PaddingLeft)"},children:o(Ke,{children:[e(en,{})," ",a("whatIsDefaultGroups")]})})}),e(Ve,{canSelectAll:!0,onSelect:I=>h([...I]),loader:c,ariaLabelKey:"realm-settings:defaultGroups",searchPlaceholderKey:"realm-settings:searchForGroups",toolbarItem:o(Z,{children:[e(ye,{children:e(N,{"data-testid":"openCreateGroupModal",variant:"primary",onClick:l,children:a("addGroups")})}),e(ye,{children:e(_t,{toggle:e(Sa,{onToggle:t,isDisabled:g.length===0}),isOpen:n,isPlain:!0,dropdownItems:[e(Ye,{component:"button",onClick:()=>{U(),t()},children:a("common:remove")},"action")]})})]}),actions:[{title:a("common:remove"),onRowClick:I=>(h([I]),U(),Promise.resolve(!1))}],columns:[{name:"name",displayKey:"groups:groupName"},{name:"path",displayKey:"groups:path"}],emptyState:e(we,{hasIcon:!0,message:a("noDefaultGroups"),instructions:o(ct,{i18nKey:"realm-settings:noDefaultGroupsInstructions",children:[" ",e(fe,{to:Ot({realm:y})}),"Add groups..."]}),primaryActionText:a("addGroups"),onPrimaryAction:l})},i)]}):e(Ae,{})},On=()=>{const{t:a}=F("realm-settings"),[n,t]=m.exports.useState(),[s,l]=m.exports.useState(10),[r,d]=m.exports.useState(0),{adminClient:g}=se(),{addAlert:h,addError:i}=me(),{realm:S}=le();if(Ce(()=>g.realms.findOne({realm:S}),t,[]),!n)return e(Ae,{});const f=async C=>{const u=C;try{await g.roles.createComposite({roleId:n.defaultRole.id,realm:S},u),d(r+1),h(a("roles:addAssociatedRolesSuccess"),te.success)}catch(L){i("roles:addAssociatedRolesError",L)}};return o(It,{activeKey:s,onSelect:(C,u)=>l(u),children:[e(B,{id:"roles",eventKey:10,title:e(G,{children:a("defaultRoles")}),children:e(Ya,{name:n.defaultRole.name,id:n.defaultRole.id,type:"roles",isManager:!0,save:C=>f(C.map(u=>u.role))})},r),e(B,{id:"groups",eventKey:20,title:e(G,{children:a("defaultGroups")}),children:e(Nn,{})})]})},Mn=({save:a,onChange:n,value:t,realmName:s,refresh:l})=>{const{t:r}=F("realm-settings"),{adminClient:d}=se(),{refresh:g}=jt(),{addAlert:h,addError:i}=me(),S=$e(),[f,C]=m.exports.useState(!1),[u,L]=m.exports.useState(!1),[y,E]=ue({titleKey:"realm-settings:disableConfirmTitle",messageKey:"realm-settings:disableConfirm",continueButtonLabel:"common:disable",onConfirm:()=>{n(!t),a()}}),[v,p]=ue({titleKey:"realm-settings:deleteConfirmTitle",messageKey:"realm-settings:deleteConfirm",continueButtonLabel:"common:delete",continueButtonVariant:ae.danger,onConfirm:async()=>{try{await d.realms.del({realm:s}),h(r("deletedSuccess"),te.success),await g(),S(Ta({realm:Ca.masterRealm})),l()}catch(c){i("realm-settings:deleteError",c)}}});return o(Z,{children:[e(E,{}),e(p,{}),e(yn,{open:f,toggleDialog:()=>C(!f)}),e(vn,{isOpen:u,onClose:()=>L(!1)}),e(Ea,{titleKey:s,subKey:"realm-settings:realmSettingsExplain",helpUrl:ka.realmSettingsUrl,divider:!1,dropdownItems:[e(Ye,{"data-testid":"openPartialImportModal",onClick:()=>{C(!0)},children:r("partialImport")},"import"),e(Ye,{"data-testid":"openPartialExportModal",onClick:()=>L(!0),children:r("partialExport")},"export"),e(Ia,{},"separator"),e(Ye,{onClick:v,children:r("common:delete")},"delete")],isEnabled:t,onToggle:c=>{c?(n(c),a()):y()}})]})},Kn=({realm:a,refresh:n})=>{const{t}=F("realm-settings"),{adminClient:s}=se(),{addAlert:l,addError:r}=me(),{realm:d}=le(),{refresh:g}=jt(),h=$e(),i=qt(),{control:S,setValue:f,getValues:C}=be({mode:"onChange"}),[u,L]=m.exports.useState(0),y=()=>{L(u+1)},E=(q=a)=>{xe(q,f)};m.exports.useEffect(E,[]);const v=async q=>{q=xa(q),q.attributes?.["acr.loa.map"]&&typeof q.attributes["acr.loa.map"]!="string"&&(q.attributes["acr.loa.map"]=JSON.stringify(Object.fromEntries(q.attributes["acr.loa.map"].filter(({key:oe})=>oe!=="").map(({key:oe,value:Le})=>[oe,Le]))));try{await s.realms.update({realm:d},{...a,...q,id:q.realm}),l(t("saveSuccess"),te.success)}catch(oe){r("realm-settings:saveError",oe)}d!==(q.realm||a.realm)&&(await g(),h(pt({realm:q.realm,tab:"general"}))),n()},p=q=>rt(pt({realm:d,tab:q})),c=p("general"),k=p("login"),M=p("email"),U=p("themes"),A=p("keys"),I=p("events"),V=p("localization"),z=p("security-defenses"),D=p("sessions"),x=p("tokens"),H=p("client-policies"),O=p("user-profile"),_=p("user-registration"),j=q=>rt(ft({realm:d,tab:q})),pe=j("profiles"),Se=j("policies");return o(Z,{children:[e(R,{name:"enabled",defaultValue:!0,control:S,render:({field:q})=>e(Mn,{value:q.value,onChange:q.onChange,realmName:d,refresh:y,save:()=>v(C())})}),e(ee,{variant:"light",className:"pf-u-p-0",children:o(it,{isBox:!0,mountOnEnter:!0,defaultLocation:pt({realm:d,tab:"general"}),children:[e(B,{title:e(G,{children:t("general")}),"data-testid":"rs-general-tab",...c,children:e(on,{realm:a,save:v})}),e(B,{title:e(G,{children:t("login")}),"data-testid":"rs-login-tab",...k,children:e(bn,{refresh:n,realm:a})}),e(B,{title:e(G,{children:t("email")}),"data-testid":"rs-email-tab",...M,children:e(nn,{realm:a})}),e(B,{title:e(G,{children:t("themes")}),"data-testid":"rs-themes-tab",...U,children:e(Ln,{realm:a,save:v})}),e(B,{title:e(G,{children:t("realm-settings:keys")}),"data-testid":"rs-keys-tab",...A,children:e(hn,{})}),e(B,{title:e(G,{children:t("events")}),"data-testid":"rs-realm-events-tab",...I,children:e(rn,{realm:a})}),e(B,{title:e(G,{children:t("localization")}),"data-testid":"rs-localization-tab",...V,children:e(fn,{refresh:n,save:v,realm:a},u)}),e(B,{title:e(G,{children:t("securityDefences")}),"data-testid":"rs-security-defenses-tab",...z,children:e(In,{realm:a,save:v})}),e(B,{title:e(G,{children:t("realm-settings:sessions")}),"data-testid":"rs-sessions-tab",...D,children:e(xn,{realm:a,save:v},u)}),e(B,{title:e(G,{children:t("realm-settings:tokens")}),"data-testid":"rs-tokens-tab",...x,children:e(En,{save:v,realm:a})}),e(B,{title:e(G,{children:t("realm-settings:clientPolicies")}),"data-testid":"rs-clientPolicies-tab",...H,children:o(it,{mountOnEnter:!0,defaultLocation:ft({realm:d,tab:"profiles"}),children:[e(B,{id:"profiles","data-testid":"rs-policies-clientProfiles-tab","aria-label":t("clientProfilesSubTab"),title:e(G,{children:t("profiles")}),tooltip:e(Mt,{content:t("realm-settings:clientPoliciesProfilesHelpText")}),...pe,children:e(Tn,{})}),e(B,{id:"policies","data-testid":"rs-policies-clientPolicies-tab","aria-label":t("clientPoliciesSubTab"),...Se,title:e(G,{children:t("policies")}),tooltip:e(Mt,{content:t("realm-settings:clientPoliciesPoliciesHelpText")}),children:e(Sn,{})})]})}),i(Wt.DeclarativeUserProfile)&&a.attributes?.userProfileEnabled==="true"&&e(B,{title:e(G,{children:t("realm-settings:userProfile")}),"data-testid":"rs-user-profile-tab",...O,children:e(Dn,{})}),e(B,{title:e(G,{children:t("userRegistration")}),"data-testid":"rs-userRegistration-tab",..._,children:e(On,{})})]})})]})};function Qs(){const{adminClient:a}=se(),{realm:n}=La(),[t,s]=m.exports.useState(),[l,r]=m.exports.useState(0),d=()=>{r(l+1),s(void 0)};return Ce(()=>a.realms.findOne({realm:n}),s,[l]),t?e(Kn,{realm:t,refresh:d}):e(Ae,{})}export{Qs as default};
//# sourceMappingURL=RealmSettingsSection.58d0d90c.js.map
