import{b as z,C as f,a as $}from"./index.esm.68aaf060.js";import{S as K}from"./ScrollForm.6573b3d3.js";import{u as I,az as H,l as q,aA as N,r as x,h as c,F as A,j as e,aB as S,q as w,aw as P,aX as M,bg as _,aZ as B,ax as G,g as W,cU as Y}from"./index.2ecf13ca.js";import{F as L}from"./FormAccess.7ed5d8eb.js";import{H as n}from"./HelpItem.49be9c4e.js";import{W as C,S as X}from"./SettingsCache.66c6a7d0.js";import{K as p}from"./KeycloakTextInput.97e36976.js";import{P as Z}from"./PasswordInput.4caf2dff.js";import{i as J}from"./isEqual.7e8157bd.js";import{a as i,F as Q,A as ee}from"./FormGroup.24d2e56a.js";import{S as O,a as g,b as R}from"./Select.5d6f6214.js";const te=["connectionUrl","bindDn","bindCredential","useTruststoreSpi","connectionTimeout","startTls","authType"],E=t=>{const l={};return te.forEach(s=>{const a=_(t.getValues(),`config.${s}`);l[s]=Array.isArray(a)?a[0]:""}),l},ae=({form:t,id:l,showSectionHeading:s=!1,showSectionDescription:a=!1})=>{const{t:r}=I("user-federation"),{t:m}=I("user-federation-help"),{adminClient:u}=H(),{realm:o}=q(),{addAlert:b,addError:h}=N(),y=!!l,d=async v=>{try{const T=E(t);await u.realms.testLDAPConnection({realm:o},{...T,action:v,componentId:l}),b(r("testSuccess"),M.success)}catch(T){h("user-federation:testError",T)}},[k,D]=x.exports.useState(!1),[V,F]=x.exports.useState(!1),j=z({control:t.control,name:"config.authType",defaultValue:["simple"]});return c(A,{children:[s&&e(C,{title:r("connectionAndAuthenticationSettings"),description:m("ldapConnectionAndAuthorizationSettingsDescription"),showDescription:a}),c(L,{role:"manage-realm",isHorizontal:!0,children:[e(i,{label:r("connectionURL"),labelIcon:e(n,{helpText:"user-federation-help:consoleDisplayConnectionUrlHelp",fieldLabelId:"user-federation:connectionURL"}),fieldId:"kc-ui-connection-url",isRequired:!0,validated:t.formState.errors.config?.connectionUrl?.[0]?"error":"default",helperTextInvalid:t.formState.errors.config?.connectionUrl?.[0].message,children:e(p,{isRequired:!0,type:"url",id:"kc-ui-connection-url","data-testid":"ldap-connection-url",validated:t.formState.errors.config?.connectionUrl?.[0]?"error":"default",...t.register("config.connectionUrl.0",{required:{value:!0,message:r("validateConnectionUrl").toString()}})})}),e(i,{label:r("enableStartTls"),labelIcon:e(n,{helpText:"user-federation-help:enableStartTlsHelp",fieldLabelId:"user-federation:enableStartTls"}),fieldId:"kc-enable-start-tls",hasNoPaddingTop:!0,children:e(f,{name:"config.startTls",defaultValue:["false"],control:t.control,render:({field:v})=>e(S,{id:"kc-enable-start-tls","data-testid":"enable-start-tls",isDisabled:!1,onChange:T=>v.onChange([`${T}`]),isChecked:v.value[0]==="true",label:r("common:on"),labelOff:r("common:off"),"aria-label":r("enableStartTls")})})}),e(i,{label:r("useTruststoreSpi"),labelIcon:e(n,{helpText:"user-federation-help:useTruststoreSpiHelp",fieldLabelId:"user-federation:useTruststoreSpi"}),fieldId:"kc-use-truststore-spi",children:e(f,{name:"config.useTruststoreSpi[0]",control:t.control,defaultValue:"ldapsOnly",render:({field:v})=>c(O,{toggleId:"kc-use-truststore-spi",onToggle:()=>D(!k),isOpen:k,onSelect:(T,U)=>{v.onChange(U.toString()),D(!1)},selections:v.value,children:[e(g,{value:"always",children:r("always")}),e(g,{value:"ldapsOnly",children:r("onlyLdaps")}),e(g,{value:"never",children:r("never")})]})})}),e(i,{label:r("connectionPooling"),labelIcon:e(n,{helpText:"user-federation-help:connectionPoolingHelp",fieldLabelId:"user-federation:connectionPooling"}),fieldId:"kc-connection-pooling",hasNoPaddingTop:!0,children:e(f,{name:"config.connectionPooling",defaultValue:["false"],control:t.control,render:({field:v})=>e(S,{id:"kc-connection-pooling","data-testid":"connection-pooling",isDisabled:!1,onChange:T=>v.onChange([`${T}`]),isChecked:v.value[0]==="true",label:r("common:on"),labelOff:r("common:off"),"aria-label":r("connectionPooling")})})}),e(i,{label:r("connectionTimeout"),labelIcon:e(n,{helpText:"user-federation-help:connectionTimeoutHelp",fieldLabelId:"user-federation:consoleTimeout"}),fieldId:"kc-ui-connection-timeout",children:e(p,{type:"number",min:0,id:"kc-ui-connection-timeout","data-testid":"connection-timeout",...t.register("config.connectionTimeout.0")})}),e(i,{fieldId:"kc-test-connection-button",children:e(w,{variant:"secondary",id:"kc-test-connection-button","data-testid":"test-connection-button",onClick:()=>d("testConnection"),children:r("common:testConnection")})}),e(i,{label:r("bindType"),labelIcon:e(n,{helpText:"user-federation-help:bindTypeHelp",fieldLabelId:"user-federation:bindType"}),fieldId:"kc-bind-type",isRequired:!0,children:e(f,{name:"config.authType[0]",defaultValue:"simple",control:t.control,render:({field:v})=>c(O,{toggleId:"kc-bind-type",required:!0,onToggle:()=>F(!V),isOpen:V,onSelect:(T,U)=>{v.onChange(U),F(!1)},selections:v.value,variant:R.single,"data-testid":"ldap-bind-type",children:[e(g,{value:"simple"}),e(g,{value:"none"})]})})}),J(j,["simple"])&&c(A,{children:[e(i,{label:r("bindDn"),labelIcon:e(n,{helpText:"user-federation-help:bindDnHelp",fieldLabelId:"user-federation:bindDn"}),fieldId:"kc-ui-bind-dn",helperTextInvalid:r("validateBindDn"),validated:t.formState.errors.config?.bindDn?P.error:P.default,isRequired:!0,children:e(p,{type:"text",id:"kc-ui-bind-dn","data-testid":"ldap-bind-dn",validated:t.formState.errors.config?.bindDn?P.error:P.default,...t.register("config.bindDn.0",{required:!0})})}),e(i,{label:r("bindCredentials"),labelIcon:e(n,{helpText:"user-federation-help:bindCredentialsHelp",fieldLabelId:"user-federation:bindCredentials"}),fieldId:"kc-ui-bind-credentials",helperTextInvalid:r("validateBindCredentials"),validated:t.formState.errors.config?.bindCredential?P.error:P.default,isRequired:!0,children:e(Z,{hasReveal:!y,isRequired:!0,id:"kc-ui-bind-credentials","data-testid":"ldap-bind-credentials",validated:t.formState.errors.config?.bindCredential?P.error:P.default,...t.register("config.bindCredential.0",{required:!0})})})]}),e(i,{fieldId:"kc-test-auth-button",children:e(w,{variant:"secondary",id:"kc-test-auth-button","data-testid":"test-auth-button",onClick:()=>d("testAuthentication"),children:r("testAuthentication")})})]})]})},re="1.3.6.1.4.1.4203.1.11.1",ie=({id:t,form:l,showSectionHeading:s=!1,showSectionDescription:a=!1})=>{const{t:r}=I("user-federation"),{t:m}=I("user-federation-help"),{adminClient:u}=H(),{realm:o}=q(),{addAlert:b,addError:h}=N(),y=async()=>{if(!!await l.trigger())try{const d=E(l),k=await u.realms.ldapServerCapabilities({realm:o},{...d,componentId:t});b(r("testSuccess"));const D=k.filter(V=>V.oid===re);l.setValue("config.usePasswordModifyExtendedOp",[(D.length>0).toString()])}catch(d){h("user-federation:testError",d)}};return c(A,{children:[s&&e(C,{title:r("advancedSettings"),description:m("ldapAdvancedSettingsDescription"),showDescription:a}),c(L,{role:"manage-realm",isHorizontal:!0,children:[e(i,{label:r("enableLdapv3Password"),labelIcon:e(n,{helpText:"user-federation-help:enableLdapv3PasswordHelp",fieldLabelId:"user-federation:enableLdapv3Password"}),fieldId:"kc-enable-ldapv3-password",hasNoPaddingTop:!0,children:e(f,{name:"config.usePasswordModifyExtendedOp",defaultValue:["false"],control:l.control,render:({field:d})=>e(S,{id:"kc-enable-ldapv3-password","data-testid":"ldapv3-password",isDisabled:!1,onChange:k=>d.onChange([`${k}`]),isChecked:d.value[0]==="true",label:r("common:on"),labelOff:r("common:off"),"aria-label":r("enableLdapv3Password")})})}),e(i,{label:r("validatePasswordPolicy"),labelIcon:e(n,{helpText:"user-federation-help:validatePasswordPolicyHelp",fieldLabelId:"user-federation:validatePasswordPolicy"}),fieldId:"kc-validate-password-policy",hasNoPaddingTop:!0,children:e(f,{name:"config.validatePasswordPolicy",defaultValue:["false"],control:l.control,render:({field:d})=>e(S,{id:"kc-validate-password-policy","data-testid":"password-policy",isDisabled:!1,onChange:k=>d.onChange([`${k}`]),isChecked:d.value[0]==="true",label:r("common:on"),labelOff:r("common:off"),"aria-label":r("validatePasswordPolicy")})})}),e(i,{label:r("trustEmail"),labelIcon:e(n,{helpText:"user-federation-help:trustEmailHelp",fieldLabelId:"user-federation:trustEmail"}),fieldId:"kc-trust-email",hasNoPaddingTop:!0,children:e(f,{name:"config.trustEmail",defaultValue:["false"],control:l.control,render:({field:d})=>e(S,{id:"kc-trust-email","data-testid":"trust-email",isDisabled:!1,onChange:k=>d.onChange([`${k}`]),isChecked:d.value[0]==="true",label:r("common:on"),labelOff:r("common:off"),"aria-label":r("trustEmail")})})}),e(i,{fieldId:"query-extensions",children:e(w,{variant:"secondary",id:"query-extensions","data-testid":"query-extensions",onClick:y,children:r("queryExtensions")})})]})]})},ne=({form:t,showSectionHeading:l=!1,showSectionDescription:s=!1,vendorEdit:a=!1})=>{const{t:r}=I("user-federation"),{t:m}=I("user-federation-help"),{adminClient:u}=H(),{realm:o}=q();B(()=>u.realms.findOne({realm:o}),d=>t.setValue("parentId",d.id),[]);const[b,h]=x.exports.useState(!1),y=()=>{switch(t.getValues("config.vendor[0]")){case"ad":t.setValue("config.usernameLDAPAttribute[0]","cn"),t.setValue("config.rdnLDAPAttribute[0]","cn"),t.setValue("config.uuidLDAPAttribute[0]","objectGUID"),t.setValue("config.userObjectClasses[0]","person, organizationalPerson, user");break;case"rhds":t.setValue("config.usernameLDAPAttribute[0]","uid"),t.setValue("config.rdnLDAPAttribute[0]","uid"),t.setValue("config.uuidLDAPAttribute[0]","nsuniqueid"),t.setValue("config.userObjectClasses[0]","inetOrgPerson, organizationalPerson");break;case"tivoli":t.setValue("config.usernameLDAPAttribute[0]","uid"),t.setValue("config.rdnLDAPAttribute[0]","uid"),t.setValue("config.uuidLDAPAttribute[0]","uniqueidentifier"),t.setValue("config.userObjectClasses[0]","inetOrgPerson, organizationalPerson");break;case"edirectory":t.setValue("config.usernameLDAPAttribute[0]","uid"),t.setValue("config.rdnLDAPAttribute[0]","uid"),t.setValue("config.uuidLDAPAttribute[0]","guid"),t.setValue("config.userObjectClasses[0]","inetOrgPerson, organizationalPerson");break;case"other":t.setValue("config.usernameLDAPAttribute[0]","uid"),t.setValue("config.rdnLDAPAttribute[0]","uid"),t.setValue("config.uuidLDAPAttribute[0]","entryUUID"),t.setValue("config.userObjectClasses[0]","inetOrgPerson, organizationalPerson");break;default:return""}};return c(A,{children:[l&&e(C,{title:r("generalOptions"),description:m("ldapGeneralOptionsSettingsDescription"),showDescription:s}),c(L,{role:"manage-realm",isHorizontal:!0,children:[c(i,{label:r("uiDisplayName"),labelIcon:e(n,{helpText:"user-federation-help:uiDisplayNameHelp",fieldLabelId:"user-federation:uiDisplayName"}),fieldId:"kc-ui-display-name",isRequired:!0,validated:t.formState.errors.name?"error":"default",helperTextInvalid:t.formState.errors.name?.message,children:[e(p,{hidden:!0,id:"kc-ui-provider-id",defaultValue:"ldap",...t.register("providerId")}),e(p,{hidden:!0,id:"kc-ui-provider-type",defaultValue:"org.keycloak.storage.UserStorageProvider",...t.register("providerType")}),e(p,{hidden:!0,id:"kc-ui-parentId",defaultValue:o,...t.register("parentId")}),e(p,{isRequired:!0,id:"kc-ui-display-name",defaultValue:"ldap","data-testid":"ldap-name",validated:t.formState.errors.name?"error":"default",...t.register("name",{required:{value:!0,message:`${r("validateName")}`}})})]}),e(i,{label:r("vendor"),labelIcon:e(n,{helpText:"user-federation-help:vendorHelp",fieldLabelId:"user-federation:vendor"}),fieldId:"kc-vendor",isRequired:!0,children:e(f,{name:"config.vendor[0]",defaultValue:"ad",control:t.control,render:({field:d})=>c(O,{isDisabled:!!a,toggleId:"kc-vendor",required:!0,onToggle:()=>h(!b),isOpen:b,onSelect:(k,D)=>{d.onChange(D),h(!1),y()},selections:d.value,variant:R.single,children:[e(g,{value:"ad",isPlaceholder:!0,children:"Active Directory"},0),e(g,{value:"rhds",children:"Red Hat Directory Server"},1),e(g,{value:"tivoli",children:"Tivoli"},2),e(g,{value:"edirectory",children:"Novell eDirectory"},3),e(g,{value:"other",children:"Other"},4)]})})})]})]})},le=({form:t,showSectionHeading:l=!1,showSectionDescription:s=!1})=>{const{t:a}=I("user-federation"),{t:r}=I("user-federation-help"),m=z({control:t.control,name:"config.allowKerberosAuthentication",defaultValue:["false"]});return c(A,{children:[l&&e(C,{title:a("kerberosIntegration"),description:r("ldapKerberosSettingsDescription"),showDescription:s}),c(L,{role:"manage-realm",isHorizontal:!0,children:[e(i,{label:a("allowKerberosAuthentication"),labelIcon:e(n,{helpText:"user-federation-help:allowKerberosAuthenticationHelp",fieldLabelId:"user-federation:allowKerberosAuthentication"}),fieldId:"kc-allow-kerberos-authentication",hasNoPaddingTop:!0,children:e(f,{name:"config.allowKerberosAuthentication",defaultValue:["false"],control:t.control,render:({field:u})=>e(S,{id:"kc-allow-kerberos-authentication","data-testid":"allow-kerberos-auth",isDisabled:!1,onChange:o=>u.onChange([`${o}`]),isChecked:u.value[0]==="true",label:a("common:on"),labelOff:a("common:off"),"aria-label":a("allowKerberosAuthentication")})})}),m[0]==="true"&&c(A,{children:[e(i,{label:a("kerberosRealm"),labelIcon:e(n,{helpText:"user-federation-help:kerberosRealmHelp",fieldLabelId:"user-federation:kerberosRealm"}),fieldId:"kc-kerberos-realm",isRequired:!0,validated:t.formState.errors.config?.kerberosRealm?.[0]?"error":"default",helperTextInvalid:t.formState.errors.config?.kerberosRealm?.[0].message,children:e(p,{isRequired:!0,id:"kc-kerberos-realm","data-testid":"kerberos-realm",validated:t.formState.errors.config?.kerberosRealm?.[0]?"error":"default",...t.register("config.kerberosRealm.0",{required:{value:!0,message:a("validateRealm").toString()}})})}),e(i,{label:a("serverPrincipal"),labelIcon:e(n,{helpText:"user-federation-help:serverPrincipalHelp",fieldLabelId:"user-federation:serverPrincipal"}),fieldId:"kc-server-principal",isRequired:!0,validated:t.formState.errors.config?.serverPrincipal?.[0]?"error":"default",helperTextInvalid:t.formState.errors.config?.serverPrincipal?.[0].message,children:e(p,{isRequired:!0,id:"kc-server-principal","data-testid":"kerberos-principal",validated:t.formState.errors.config?.serverPrincipal?.[0]?"error":"default",...t.register("config.serverPrincipal.0",{required:{value:!0,message:`${a("validateServerPrincipal")}`}})})}),e(i,{label:a("keyTab"),labelIcon:e(n,{helpText:"user-federation-help:keyTabHelp",fieldLabelId:"user-federation:keyTab"}),fieldId:"kc-key-tab",isRequired:!0,validated:t.formState.errors.config?.keyTab?.[0]?"error":"default",helperTextInvalid:t.formState.errors.config?.keyTab?.[0].message,children:e(p,{isRequired:!0,id:"kc-key-tab","data-testid":"kerberos-keytab",validated:t.formState.errors.config?.keyTab?.[0]?"error":"default",...t.register("config.keyTab.0",{required:{value:!0,message:`${a("validateKeyTab")}`}})})}),c(i,{label:a("debug"),labelIcon:e(n,{helpText:"user-federation-help:debugHelp",fieldLabelId:"user-federation:debug"}),fieldId:"kc-debug",hasNoPaddingTop:!0,children:[" ",e(f,{name:"config.debug",defaultValue:["false"],control:t.control,render:({field:u})=>e(S,{id:"kc-debug","data-testid":"debug",isDisabled:!1,onChange:o=>u.onChange([`${o}`]),isChecked:u.value[0]==="true",label:a("common:on"),labelOff:a("common:off"),"aria-label":a("debug")})})]})]}),e(i,{label:a("useKerberosForPasswordAuthentication"),labelIcon:e(n,{helpText:"user-federation-help:useKerberosForPasswordAuthenticationHelp",fieldLabelId:"user-federation:useKerberosForPasswordAuthentication"}),fieldId:"kc-use-kerberos-password-authentication",hasNoPaddingTop:!0,children:e(f,{name:"config.useKerberosForPasswordAuthentication",defaultValue:["false"],control:t.control,render:({field:u})=>e(S,{id:"kc-use-kerberos-password-authentication","data-testid":"use-kerberos-pw-auth",isDisabled:!1,onChange:o=>u.onChange([`${o}`]),isChecked:u.value[0]==="true",label:a("common:on"),labelOff:a("common:off"),"aria-label":a("useKerberosForPasswordAuthentication")})})})]})]})},oe=({form:t,showSectionHeading:l=!1,showSectionDescription:s=!1})=>{const{t:a}=I("user-federation"),{t:r}=I("user-federation-help"),[m,u]=x.exports.useState(!1),[o,b]=x.exports.useState(!1);return c(A,{children:[l&&e(C,{title:a("ldapSearchingAndUpdatingSettings"),description:r("ldapSearchingAndUpdatingSettingsDescription"),showDescription:s}),c(L,{role:"manage-realm",isHorizontal:!0,children:[e(i,{label:a("editMode"),labelIcon:e(n,{helpText:"user-federation-help:editModeLdapHelp",fieldLabelId:"user-federation:editMode"}),fieldId:"kc-edit-mode",isRequired:!0,validated:t.formState.errors.config?.editMode?.[0]?"error":"default",helperTextInvalid:t.formState.errors.config?.editMode?.[0].message,children:e(f,{name:"config.editMode[0]",defaultValue:"",control:t.control,rules:{required:{value:!0,message:a("validateEditMode")}},render:({field:h})=>c(O,{toggleId:"kc-edit-mode",required:!0,onToggle:()=>b(!o),isOpen:o,onSelect:(y,d)=>{h.onChange(d.toString()),b(!1)},selections:h.value,variant:R.single,validated:t.formState.errors.config?.editMode?.[0]?"error":"default",children:[e(g,{value:"",isPlaceholder:!0}),e(g,{value:"READ_ONLY"}),e(g,{value:"WRITABLE"}),e(g,{value:"UNSYNCED"})]})})}),e(i,{label:a("usersDN"),labelIcon:e(n,{helpText:"user-federation-help:usersDNHelp",fieldLabelId:"user-federation:usersDn"}),fieldId:"kc-ui-users-dn",isRequired:!0,validated:t.formState.errors.config?.usersDn?.[0]?"error":"default",helperTextInvalid:t.formState.errors.config?.usersDn?.[0].message,children:e(p,{isRequired:!0,defaultValue:"",id:"kc-ui-users-dn","data-testid":"ldap-users-dn",validated:t.formState.errors.config?.usersDn?.[0]?"error":"default",...t.register("config.usersDn.0",{required:{value:!0,message:a("validateUsersDn").toString()}})})}),e(i,{label:a("usernameLdapAttribute"),labelIcon:e(n,{helpText:"user-federation-help:usernameLdapAttributeHelp",fieldLabelId:"user-federation:usernameLdapAttribute"}),fieldId:"kc-username-ldap-attribute",isRequired:!0,validated:t.formState.errors.config?.usernameLDAPAttribute?.[0]?"error":"default",helperTextInvalid:t.formState.errors.config?.usernameLDAPAttribute?.[0].message,children:e(p,{isRequired:!0,defaultValue:"cn",id:"kc-username-ldap-attribute","data-testid":"ldap-username-attribute",validated:t.formState.errors.config?.usernameLDAPAttribute?.[0]?"error":"default",...t.register("config.usernameLDAPAttribute.0",{required:{value:!0,message:`${a("validateUsernameLDAPAttribute")}`}})})}),e(i,{label:a("rdnLdapAttribute"),labelIcon:e(n,{helpText:"user-federation-help:rdnLdapAttributeHelp",fieldLabelId:"user-federation:rdnLdapAttribute"}),fieldId:"kc-rdn-ldap-attribute",isRequired:!0,validated:t.formState.errors.config?.rdnLDAPAttribute?.[0]?"error":"default",helperTextInvalid:t.formState.errors.config?.rdnLDAPAttribute?.[0].message,children:e(p,{isRequired:!0,defaultValue:"cn",id:"kc-rdn-ldap-attribute","data-testid":"ldap-rdn-attribute",validated:t.formState.errors.config?.rdnLDAPAttribute?.[0]?"error":"default",...t.register("config.rdnLDAPAttribute.0",{required:{value:!0,message:`${a("validateRdnLdapAttribute")}`}})})}),e(i,{label:a("uuidLdapAttribute"),labelIcon:e(n,{helpText:"user-federation-help:uuidLdapAttributeHelp",fieldLabelId:"user-federation:uuidLdapAttribute"}),fieldId:"kc-uuid-ldap-attribute",isRequired:!0,validated:t.formState.errors.config?.uuidLDAPAttribute?.[0]?"error":"default",helperTextInvalid:t.formState.errors.config?.uuidLDAPAttribute?.[0].message,children:e(p,{isRequired:!0,defaultValue:"objectGUID",id:"kc-uuid-ldap-attribute","data-testid":"ldap-uuid-attribute",validated:t.formState.errors.config?.uuidLDAPAttribute?.[0]?"error":"default",...t.register("config.uuidLDAPAttribute.0",{required:{value:!0,message:`${a("validateUuidLDAPAttribute")}`}})})}),e(i,{label:a("userObjectClasses"),labelIcon:e(n,{helpText:"user-federation-help:userObjectClassesHelp",fieldLabelId:"user-federation:userObjectClasses"}),fieldId:"kc-user-object-classes",isRequired:!0,validated:t.formState.errors.config?.userObjectClasses?.[0]?"error":"default",helperTextInvalid:t.formState.errors.config?.userObjectClasses?.[0].message,children:e(p,{isRequired:!0,defaultValue:"person, organizationalPerson, user",id:"kc-user-object-classes","data-testid":"ldap-user-object-classes",validated:t.formState.errors.config?.userObjectClasses?.[0]?"error":"default",...t.register("config.userObjectClasses.0",{required:{value:!0,message:a("validateUserObjectClasses").toString()}})})}),e(i,{label:a("userLdapFilter"),labelIcon:e(n,{helpText:"user-federation-help:userLdapFilterHelp",fieldLabelId:"user-federation:userLdapFilter"}),fieldId:"kc-user-ldap-filter",validated:t.formState.errors.config?.customUserSearchFilter?.[0]?"error":"default",helperTextInvalid:t.formState.errors.config?.customUserSearchFilter?.[0].message,children:e(p,{id:"kc-user-ldap-filter","data-testid":"user-ldap-filter",validated:t.formState.errors.config?.customUserSearchFilter?.[0]?"error":"default",...t.register("config.customUserSearchFilter.0",{pattern:{value:/(\(.*\))$/,message:a("validateCustomUserSearchFilter").toString()}})})}),e(i,{label:a("searchScope"),labelIcon:e(n,{helpText:"user-federation-help:searchScopeHelp",fieldLabelId:"user-federation:searchScope"}),fieldId:"kc-search-scope",children:e(f,{name:"config.searchScope[0]",defaultValue:"",control:t.control,render:({field:h})=>c(O,{toggleId:"kc-search-scope",required:!0,onToggle:()=>u(!m),isOpen:m,onSelect:(y,d)=>{h.onChange(d),u(!1)},selections:h.value,variant:R.single,children:[e(g,{value:"1",isPlaceholder:!0,children:a("oneLevel")},0),e(g,{value:"2",children:a("subtree")},1)]})})}),e(i,{label:a("readTimeout"),labelIcon:e(n,{helpText:"user-federation-help:readTimeoutHelp",fieldLabelId:"user-federation:readTimeout"}),fieldId:"kc-read-timeout",children:e(p,{type:"number",min:0,id:"kc-read-timeout","data-testid":"ldap-read-timeout",...t.register("config.readTimeout.0")})}),e(i,{label:a("pagination"),labelIcon:e(n,{helpText:"user-federation-help:paginationHelp",fieldLabelId:"user-federation:pagination"}),fieldId:"kc-ui-pagination",hasNoPaddingTop:!0,children:e(f,{name:"config.pagination",defaultValue:["false"],control:t.control,render:({field:h})=>e(S,{id:"kc-ui-pagination","data-testid":"ui-pagination",isDisabled:!1,onChange:y=>h.onChange([`${y}`]),isChecked:h.value[0]==="true",label:a("common:on"),labelOff:a("common:off"),"aria-label":a("pagination")})})})]})]})},se=({form:t,showSectionHeading:l=!1,showSectionDescription:s=!1})=>{const{t:a}=I("user-federation"),{t:r}=I("user-federation-help"),m=t.watch("config.periodicFullSync",!1),u=t.watch("config.periodicChangedUsersSync",!1);return c(A,{children:[l&&e(C,{title:a("synchronizationSettings"),description:r("ldapSynchronizationSettingsDescription"),showDescription:s}),c(L,{role:"manage-realm",isHorizontal:!0,children:[e(i,{hasNoPaddingTop:!0,label:a("importUsers"),labelIcon:e(n,{helpText:"user-federation-help:importUsersHelp",fieldLabelId:"user-federation:importUsers"}),fieldId:"kc-import-users",children:e(f,{name:"config.importEnabled",defaultValue:["true"],control:t.control,render:({field:o})=>e(S,{id:"kc-import-users","data-testid":"import-users",name:"importEnabled",label:a("common:on"),labelOff:a("common:off"),onChange:b=>o.onChange([`${b}`]),isChecked:o.value[0]==="true",isDisabled:!1,"aria-label":a("importUsers")})})}),e(i,{hasNoPaddingTop:!0,label:a("syncRegistrations"),labelIcon:e(n,{helpText:"user-federation-help:syncRegistrations",fieldLabelId:"user-federation:syncRegistrations"}),fieldId:"syncRegistrations",children:e(f,{name:"config.syncRegistrations",defaultValue:["true"],control:t.control,render:({field:o})=>e(S,{id:"syncRegistrations","data-testid":"syncRegistrations",label:a("common:on"),labelOff:a("common:off"),onChange:b=>o.onChange([`${b}`]),isChecked:o.value[0]==="true","aria-label":a("syncRegistrations")})})}),e(i,{label:a("batchSize"),labelIcon:e(n,{helpText:"user-federation-help:batchSizeHelp",fieldLabelId:"user-federation:batchSize"}),fieldId:"kc-batch-size",children:e(p,{type:"number",min:0,id:"kc-batch-size","data-testid":"batch-size",...t.register("config.batchSizeForSync.0")})}),e(i,{label:a("periodicFullSync"),labelIcon:e(n,{helpText:"user-federation-help:periodicFullSyncHelp",fieldLabelId:"user-federation:periodicFullSync"}),fieldId:"kc-periodic-full-sync",hasNoPaddingTop:!0,children:e(f,{name:"config.periodicFullSync",defaultValue:!1,control:t.control,render:({field:o})=>e(S,{id:"kc-periodic-full-sync","data-testid":"periodic-full-sync",isDisabled:!1,onChange:b=>o.onChange(b),isChecked:o.value===!0,label:a("common:on"),labelOff:a("common:off"),"aria-label":a("periodicFullSync")})})}),m&&e(i,{hasNoPaddingTop:!0,label:a("fullSyncPeriod"),labelIcon:e(n,{helpText:"user-federation-help:fullSyncPeriodHelp",fieldLabelId:"user-federation:fullSyncPeriod"}),fieldId:"kc-full-sync-period",children:e(p,{type:"number",min:-1,defaultValue:604800,id:"kc-full-sync-period","data-testid":"full-sync-period",...t.register("config.fullSyncPeriod.0")})}),e(i,{label:a("periodicChangedUsersSync"),labelIcon:e(n,{helpText:"user-federation-help:periodicChangedUsersSyncHelp",fieldLabelId:"user-federation:periodicChangedUsersSync"}),fieldId:"kc-periodic-changed-users-sync",hasNoPaddingTop:!0,children:e(f,{name:"config.periodicChangedUsersSync",defaultValue:!1,control:t.control,render:({field:o})=>e(S,{id:"kc-periodic-changed-users-sync","data-testid":"periodic-changed-users-sync",isDisabled:!1,onChange:b=>o.onChange(b),isChecked:o.value===!0,label:a("common:on"),labelOff:a("common:off"),"aria-label":a("periodicChangedUsersSync")})})}),u&&e(i,{label:a("changedUsersSyncPeriod"),labelIcon:e(n,{helpText:"user-federation-help:changedUsersSyncHelp",fieldLabelId:"user-federation:changedUsersSyncPeriod"}),fieldId:"kc-changed-users-sync-period",hasNoPaddingTop:!0,children:e(p,{type:"number",min:-1,defaultValue:86400,id:"kc-changed-users-sync-period","data-testid":"changed-users-sync-period",...t.register("config.changedSyncPeriod.0")})})]})]})},Ie=({id:t,onSubmit:l})=>{const{t:s}=I("user-federation"),a=$(),r=G(),{realm:m}=q(),u=W().profileInfo?.disabledFeatures?.includes("KERBEROS");return c(A,{children:[e(K,{sections:[{title:s("generalOptions"),panel:e(ne,{form:a,vendorEdit:!!t})},{title:s("connectionAndAuthenticationSettings"),panel:e(ae,{form:a,id:t})},{title:s("ldapSearchingAndUpdatingSettings"),panel:e(oe,{form:a})},{title:s("synchronizationSettings"),panel:e(se,{form:a})},{title:s("kerberosIntegration"),panel:e(le,{form:a}),isHidden:u},{title:s("cacheSettings"),panel:e(X,{form:a})},{title:s("advancedSettings"),panel:e(ie,{form:a,id:t})}]}),e(Q,{onSubmit:a.handleSubmit(l),children:c(ee,{className:"keycloak__form_actions",children:[e(w,{isDisabled:!a.formState.isDirty,variant:"primary",type:"submit","data-testid":"ldap-save",children:s("common:save")}),e(w,{variant:"link",onClick:()=>r(Y({realm:m})),"data-testid":"ldap-cancel",children:s("common:cancel")})]})})]})};function ke(t){const{config:l}=t;return l?.periodicChangedUsersSync!==void 0&&(l.periodicChangedUsersSync===!1&&(l.changedSyncPeriod=["-1"]),delete l.periodicChangedUsersSync),l?.periodicFullSync!==void 0&&(l.periodicFullSync===!1&&(l.fullSyncPeriod=["-1"]),delete l.periodicFullSync),t}export{Ie as U,ke as s};
//# sourceMappingURL=UserFederationLdapForm.591c58a6.js.map
