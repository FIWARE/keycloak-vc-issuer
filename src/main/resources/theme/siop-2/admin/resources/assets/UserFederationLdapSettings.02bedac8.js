import{ax as I,u as K,az as k,aA as E,r as m,by as R,aZ as w,ad as U,aX as B,h as T,F as V,j as t,q as j,b3 as v,l as z,K as N,P as x,d4 as C,d5 as D}from"./index.2ecf13ca.js";import{u as q,F as H}from"./index.esm.68aaf060.js";import{R as O,u as X}from"./RoutableTabs.ce00f00c.js";import{u as Z}from"./ConfirmDialog.b43fd344.js";import{L as G}from"./ListEmptyState.94d606ed.js";import{K as J}from"./KeycloakDataTable.5c9a6c7c.js";import{u as Q,m as W}from"./useLocaleSort.377bcdf5.js";import{c as Y}from"./HelpItem.49be9c4e.js";import{E as _}from"./ExtendedHeader.b33bedff.js";import{U as $,s as ee}from"./UserFederationLdapForm.591c58a6.js";import{T as A,a as P}from"./Tabs.3b19dcd9.js";import"./Modal.2c72168d.js";import"./TableToolbar.f167c244.js";import"./FormGroup.24d2e56a.js";import"./EmptyStateSecondaryActions.3ed74a6a.js";import"./EmptyStateBody.25bf6e38.js";import"./plus-circle-icon.f1969120.js";import"./Td.ff2a9f66.js";import"./star-icon.648ddb2a.js";import"./check.51c67984.js";import"./grip-vertical-icon.6efe1939.js";import"./Checkbox.56efba4a.js";import"./SettingsCache.66c6a7d0.js";import"./ViewHeader.67577dd4.js";import"./Text.441b2f8e.js";import"./FormAccess.7ed5d8eb.js";import"./copy-icon.06155c15.js";import"./GridItem.a22d8cac.js";import"./useToggle.97c716af.js";import"./isEqual.7e8157bd.js";import"./Select.5d6f6214.js";import"./NumberInput.71354005.js";import"./plus-icon.a1ecd1af.js";import"./ScrollForm.6573b3d3.js";import"./FormPanel.3fe898ae.js";import"./CardHeader.2467be54.js";import"./Card.3271e4cd.js";import"./CardTitle.ab8f9378.js";import"./CardBody.8e0a3a4b.js";import"./KeycloakTextInput.97e36976.js";import"./PasswordInput.4caf2dff.js";import"./MenuList.32e086d6.js";const te=({toCreate:s,toDetail:n})=>{const p=I(),{t:o}=K("user-federation"),{adminClient:r}=k(),{addAlert:f,addError:g}=E(),[i,y]=m.exports.useState(0),h=()=>y(i+1),[S,b]=m.exports.useState([]),c=Q(),{id:L}=R(),[d,l]=m.exports.useState();w(()=>r.components.find({parent:L,type:"org.keycloak.storage.ldap.mappers.LDAPStorageMapper"}),a=>{b(c(a.map(M=>({...M,name:M.name,type:M.providerId})),W("name")))},[i]);const[u,e]=Z({titleKey:o("common:deleteMappingTitle",{mapperId:d?.id}),messageKey:"common:deleteMappingConfirm",continueButtonLabel:"common:delete",continueButtonVariant:U.danger,onConfirm:async()=>{try{await r.components.del({id:d.id}),h(),f(o("common:mappingDeletedSuccess"),B.success),l(void 0)}catch(a){g("common:mappingDeletedError",a)}}}),F=a=>t(v,{to:n(a.id),children:a.name});return T(V,{children:[t(e,{}),t(J,{loader:S,ariaLabelKey:"ldapMappersList",searchPlaceholderKey:"common:searchForMapper",toolbarItem:t(Y,{children:t(j,{"data-testid":"add-mapper-btn",variant:"primary",component:a=>t(v,{...a,to:s}),children:o("common:addMapper")})}),actions:[{title:o("common:delete"),onRowClick:a=>{l(a),u()}}],columns:[{name:"name",cellRenderer:F},{name:"type"}],emptyState:t(G,{message:o("common:emptyMappers"),instructions:o("common:emptyMappersInstructions"),primaryActionText:o("common:emptyPrimaryAction"),onPrimaryAction:()=>p(s)})},i)]})};function Oe(){const{t:s}=K("user-federation"),n=q({mode:"onChange"}),{adminClient:p}=k(),{realm:o}=z(),{id:r}=R(),{addAlert:f,addError:g}=E(),[i,y]=m.exports.useState(),[h,S]=m.exports.useState(0),b=()=>S(e=>e+1);w(()=>p.components.findOne({id:r}),e=>{if(!e)throw new Error(s("common:notFound"));y(e),l(e)},[r,h]);const c=e=>X(C({realm:o,id:r,tab:e})),L=c("settings"),d=c("mappers"),l=e=>{n.reset(e),n.setValue("config.periodicChangedUsersSync",e.config?.changedSyncPeriod?.[0]!=="-1"),n.setValue("config.periodicFullSync",e.config?.fullSyncPeriod?.[0]!=="-1")},u=async e=>{try{await p.components.update({id:r},ee(e)),f(s("saveSuccess"),B.success),b()}catch(F){g("user-federation:saveError",F)}};return i?T(H,{...n,children:[t(_,{provider:"LDAP",noDivider:!0,editMode:i.config?.editMode,save:()=>n.handleSubmit(u)()}),t(x,{variant:"light",className:"pf-u-p-0",children:T(O,{defaultLocation:C({realm:o,id:r,tab:"settings"}),isBox:!0,children:[t(A,{id:"settings",title:t(P,{children:s("common:settings")}),...L,children:t(x,{variant:"light",children:t($,{id:r,onSubmit:u})})}),t(A,{id:"mappers",title:t(P,{children:s("common:mappers")}),"data-testid":"ldap-mappers-tab",...d,children:t(te,{toCreate:D({realm:o,id:r,mapperId:"new"}),toDetail:e=>D({realm:o,id:r,mapperId:e})})})]})})]}):t(N,{})}export{Oe as default};
//# sourceMappingURL=UserFederationLdapSettings.02bedac8.js.map
