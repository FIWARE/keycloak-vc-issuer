import{a as P,u as T,F as A}from"./index.esm.68aaf060.js";import{u as b,az as S,l as E,h as m,F,j as e,m as C,b5 as k,b6 as w,ax as D,aA as V,P as j,q as y,b3 as H,cw as U,aX as g,cx as $}from"./index.2ecf13ca.js";import{F as q}from"./FormAccess.7ed5d8eb.js";import{V as z}from"./ViewHeader.67577dd4.js";import{T as L,H as h}from"./HelpItem.49be9c4e.js";import{F as G}from"./FileUploadForm.e2de83e5.js";import{K}from"./KeycloakTextInput.97e36976.js";import{D as O}from"./DiscoveryEndpointField.efc7fb86.js";import{D as B,S as N}from"./SamlGeneralSettings.a85cd435.js";import{a as I,A as R}from"./FormGroup.24d2e56a.js";import"./copy-icon.06155c15.js";import"./GridItem.a22d8cac.js";import"./Text.441b2f8e.js";import"./FileUpload.005327fa.js";import"./CodeEditor.0b7c4c70.js";import"./EmptyStateBody.25bf6e38.js";import"./EmptyStateSecondaryActions.3ed74a6a.js";import"./Modal.2c72168d.js";import"./discovery-settings.c3dba4a4.js";import"./ExpandableSection.5fb39a3c.js";import"./Select.5d6f6214.js";import"./check.51c67984.js";import"./star-icon.648ddb2a.js";import"./NumberInput.71354005.js";import"./plus-icon.a1ecd1af.js";import"./DisplayOrder.787c02d9.js";const _=()=>{const{t}=b("identity-providers"),p="saml",{adminClient:a}=S(),{realm:n}=E(),{setValue:u,register:v,setError:l,clearErrors:c,formState:{errors:i}}=P(),f=r=>{Object.entries(r).map(([d,s])=>u(`config.${d}`,s))},o=async r=>{if(c("discoveryError"),!r)return;const d=new FormData;d.append("providerId",p),d.append("file",new Blob([r]));try{const s=await fetch(`${k(a.baseUrl)}admin/realms/${n}/identity-provider/import-config`,{method:"POST",body:d,headers:w(await a.getAccessToken())});if(s.ok){const x=await s.json();f(x)}else l("discoveryError",{type:"manual",message:s.statusText})}catch(s){l("discoveryError",{type:"manual",message:s.message})}};return m(F,{children:[e(L,{headingLevel:"h4",size:"xl",className:"kc-form-panel__title",children:t("samlSettings")}),e(I,{label:t("serviceProviderEntityId"),fieldId:"kc-service-provider-entity-id",labelIcon:e(h,{helpText:"identity-providers-help:serviceProviderEntityId",fieldLabelId:"identity-providers:serviceProviderEntityId"}),isRequired:!0,helperTextInvalid:t("common:required"),validated:i.config?.entityId?"error":"default",children:e(K,{"data-testid":"serviceProviderEntityId",id:"kc-service-provider-entity-id",validated:i.config?.entityId?"error":"default",defaultValue:`${C.authServerUrl}/realms/${n}`,...v("config.entityId",{required:!0})})}),e(O,{id:"saml",fileUpload:e(I,{label:t("importConfig"),fieldId:"kc-import-config",labelIcon:e(h,{helpText:"identity-providers-help:importConfig",fieldLabelId:"identity-providers:importConfig"}),validated:i.discoveryError?"error":"default",helperTextInvalid:i.discoveryError?.message,children:e(G,{id:"kc-import-config",extension:".xml",hideDefaultPreview:!0,unWrap:!0,validated:i.discoveryError?"error":"default",onChange:r=>o(r)})}),children:r=>e(B,{readOnly:r})})]})};function Ie(){const{t}=b("identity-providers"),p=D(),a="saml",n=T({defaultValues:{alias:a,config:{allowCreate:"true"}}}),{handleSubmit:u,formState:{isDirty:v}}=n,{adminClient:l}=S(),{addAlert:c}=V(),{realm:i}=E(),f=async o=>{delete o.discoveryEndpoint;try{await l.identityProviders.create({...o,providerId:a}),c(t("createSuccess"),g.success),p($({realm:i,providerId:a,alias:o.alias,tab:"settings"}))}catch(r){c(t("createError",{error:r.response?.data?.errorMessage||r}),g.danger)}};return m(F,{children:[e(z,{titleKey:t("addSamlProvider")}),e(j,{variant:"light",children:e(A,{...n,children:m(q,{role:"manage-identity-providers",isHorizontal:!0,onSubmit:u(f),children:[e(N,{id:a}),e(_,{}),m(R,{children:[e(y,{isDisabled:!v,variant:"primary",type:"submit","data-testid":"createProvider",children:t("common:add")}),e(y,{variant:"link","data-testid":"cancel",component:o=>e(H,{...o,to:U({realm:i})}),children:t("common:cancel")})]})]})})})]})}export{Ie as default};
//# sourceMappingURL=AddSamlConnect.949e3e15.js.map
