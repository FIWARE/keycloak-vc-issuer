import{u as R,az as _,r as u,aZ as j,j as d}from"./index.7cbfb18a.js";import{a as V,C as M}from"./index.esm.1e7ace95.js";import{S as T,b as w,a as z}from"./Select.fbe867d5.js";const D={resources:{searchFunction:"listResources",fetchFunction:"getAssociatedResources"},policies:{searchFunction:"listPolicies",fetchFunction:"getAssociatedPolicies"}},k=({name:t,clientId:h,permissionId:m,variant:v=w.typeaheadMulti,preSelected:a,isRequired:F=!1})=>{const{t:f}=R("clients"),{adminClient:p}=_(),{control:x,formState:{errors:C}}=V(),[y,b]=u.exports.useState([]),[i,r]=u.exports.useState(""),[A,O]=u.exports.useState(!1),g=D[t],P=e=>({id:"_id"in e?e._id:"id"in e?e.id:void 0,name:e.name});j(async()=>{const e=Object.assign({id:h,first:0,max:10,permission:"false"},i===""?null:{name:i});return(await Promise.all([p.clients[g.searchFunction](e),m?p.clients[g.fetchFunction]({id:h,permissionId:m}):Promise.resolve([])])).flat().filter(s=>typeof s!="string").map(P).filter(({id:s},n,o)=>n===o.findIndex(({id:c})=>s===c))},b,[i]);const S=()=>y.map(e=>d(z,{value:e.id,children:e.name},e.id));return d(M,{name:t,defaultValue:a?[a]:[],control:x,rules:{validate:e=>!F||e.length>0},render:({field:e})=>d(T,{toggleId:t,variant:v,onToggle:O,onFilter:(s,n)=>(r(n),S()),onClear:()=>{e.onChange([]),r("")},selections:e.value,onSelect:(s,n)=>{const o=n.toString(),c=e.value?.find(l=>l===o)?e.value.filter(l=>l!==o):[...e.value,o];e.onChange(c),r("")},isOpen:A,"aria-labelledby":f(t),isDisabled:!!a,validated:C[t]?"error":"default",typeAheadAriaLabel:f(t),children:S()})})};export{k as R};
//# sourceMappingURL=ResourcesPolicySelect.b32d6a9a.js.map
