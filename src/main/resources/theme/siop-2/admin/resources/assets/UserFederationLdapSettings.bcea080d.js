import{ax as I,u as K,az as k,aA as E,r as m,by as R,aZ as w,ad as U,aX as B,h as T,F as V,j as t,q as j,b3 as v,l as z,K as N,P as x,d4 as C,d5 as D}from"./index.7cbfb18a.js";import{u as q,F as H}from"./index.esm.1e7ace95.js";import{R as O,u as X}from"./RoutableTabs.58e36a71.js";import{u as Z}from"./ConfirmDialog.4dc691c5.js";import{L as G}from"./ListEmptyState.fef0510e.js";import{K as J}from"./KeycloakDataTable.ae870e97.js";import{u as Q,m as W}from"./useLocaleSort.b8a659bb.js";import{c as Y}from"./HelpItem.719382e8.js";import{E as _}from"./ExtendedHeader.419e5275.js";import{U as $,s as ee}from"./UserFederationLdapForm.5db28b69.js";import{T as A,a as P}from"./Tabs.fae3d04f.js";import"./Modal.11970fe7.js";import"./TableToolbar.51ae2a5f.js";import"./FormGroup.60c77f60.js";import"./EmptyStateSecondaryActions.511adeb0.js";import"./EmptyStateBody.1533f3a6.js";import"./plus-circle-icon.aa8a939a.js";import"./Td.1e0c90e7.js";import"./star-icon.a6efdd26.js";import"./check.51c67984.js";import"./grip-vertical-icon.7e109111.js";import"./Checkbox.7d63c785.js";import"./SettingsCache.cbce1b12.js";import"./ViewHeader.083cd951.js";import"./Text.28ece842.js";import"./FormAccess.3a7ea209.js";import"./copy-icon.dbf95270.js";import"./GridItem.63e5e367.js";import"./useToggle.461e82f2.js";import"./isEqual.c47179ef.js";import"./Select.fbe867d5.js";import"./NumberInput.619d2bbb.js";import"./plus-icon.f70ae4c8.js";import"./ScrollForm.9cb55091.js";import"./FormPanel.95e4e303.js";import"./CardHeader.b7b31472.js";import"./Card.37028a42.js";import"./CardTitle.d8222cf8.js";import"./CardBody.4fff68f7.js";import"./KeycloakTextInput.9afb01cd.js";import"./PasswordInput.aa539188.js";import"./MenuList.22670a64.js";const te=({toCreate:s,toDetail:n})=>{const p=I(),{t:o}=K("user-federation"),{adminClient:r}=k(),{addAlert:f,addError:g}=E(),[i,y]=m.exports.useState(0),h=()=>y(i+1),[S,b]=m.exports.useState([]),c=Q(),{id:L}=R(),[d,l]=m.exports.useState();w(()=>r.components.find({parent:L,type:"org.keycloak.storage.ldap.mappers.LDAPStorageMapper"}),a=>{b(c(a.map(M=>({...M,name:M.name,type:M.providerId})),W("name")))},[i]);const[u,e]=Z({titleKey:o("common:deleteMappingTitle",{mapperId:d?.id}),messageKey:"common:deleteMappingConfirm",continueButtonLabel:"common:delete",continueButtonVariant:U.danger,onConfirm:async()=>{try{await r.components.del({id:d.id}),h(),f(o("common:mappingDeletedSuccess"),B.success),l(void 0)}catch(a){g("common:mappingDeletedError",a)}}}),F=a=>t(v,{to:n(a.id),children:a.name});return T(V,{children:[t(e,{}),t(J,{loader:S,ariaLabelKey:"ldapMappersList",searchPlaceholderKey:"common:searchForMapper",toolbarItem:t(Y,{children:t(j,{"data-testid":"add-mapper-btn",variant:"primary",component:a=>t(v,{...a,to:s}),children:o("common:addMapper")})}),actions:[{title:o("common:delete"),onRowClick:a=>{l(a),u()}}],columns:[{name:"name",cellRenderer:F},{name:"type"}],emptyState:t(G,{message:o("common:emptyMappers"),instructions:o("common:emptyMappersInstructions"),primaryActionText:o("common:emptyPrimaryAction"),onPrimaryAction:()=>p(s)})},i)]})};function Oe(){const{t:s}=K("user-federation"),n=q({mode:"onChange"}),{adminClient:p}=k(),{realm:o}=z(),{id:r}=R(),{addAlert:f,addError:g}=E(),[i,y]=m.exports.useState(),[h,S]=m.exports.useState(0),b=()=>S(e=>e+1);w(()=>p.components.findOne({id:r}),e=>{if(!e)throw new Error(s("common:notFound"));y(e),l(e)},[r,h]);const c=e=>X(C({realm:o,id:r,tab:e})),L=c("settings"),d=c("mappers"),l=e=>{n.reset(e),n.setValue("config.periodicChangedUsersSync",e.config?.changedSyncPeriod?.[0]!=="-1"),n.setValue("config.periodicFullSync",e.config?.fullSyncPeriod?.[0]!=="-1")},u=async e=>{try{await p.components.update({id:r},ee(e)),f(s("saveSuccess"),B.success),b()}catch(F){g("user-federation:saveError",F)}};return i?T(H,{...n,children:[t(_,{provider:"LDAP",noDivider:!0,editMode:i.config?.editMode,save:()=>n.handleSubmit(u)()}),t(x,{variant:"light",className:"pf-u-p-0",children:T(O,{defaultLocation:C({realm:o,id:r,tab:"settings"}),isBox:!0,children:[t(A,{id:"settings",title:t(P,{children:s("common:settings")}),...L,children:t(x,{variant:"light",children:t($,{id:r,onSubmit:u})})}),t(A,{id:"mappers",title:t(P,{children:s("common:mappers")}),"data-testid":"ldap-mappers-tab",...d,children:t(te,{toCreate:D({realm:o,id:r,mapperId:"new"}),toDetail:e=>D({realm:o,id:r,mapperId:e})})})]})})]}):t(N,{})}export{Oe as default};
//# sourceMappingURL=UserFederationLdapSettings.bcea080d.js.map
