import{a as S,u as k,F as A}from"./index.esm.1e7ace95.js";import{u as h,az as g,l as I,h as m,F as b,j as e,b5 as C,b6 as E,ax as x,V as D,aA as O,P,q as v,b3 as T,cw as w,aX as V,cx as j}from"./index.7cbfb18a.js";import{F as H}from"./FormAccess.3a7ea209.js";import{V as U}from"./ViewHeader.083cd951.js";import{D as z,O as L,a as $}from"./OIDCGeneralSettings.2c10f679.js";import{T as G,H as J}from"./HelpItem.719382e8.js";import{J as K}from"./JsonFileUpload.ca15e844.js";import{D as N}from"./DiscoveryEndpointField.540a892d.js";import{a as B,A as _}from"./FormGroup.60c77f60.js";import"./copy-icon.dbf95270.js";import"./GridItem.63e5e367.js";import"./Text.28ece842.js";import"./KeycloakTextInput.9afb01cd.js";import"./discovery-settings.6bf57500.js";import"./ExpandableSection.0b0d95f4.js";import"./Select.fbe867d5.js";import"./check.51c67984.js";import"./star-icon.a6efdd26.js";import"./ClientIdSecret.07ccc601.js";import"./PasswordInput.aa539188.js";import"./DisplayOrder.b6d3afed.js";import"./FileUploadForm.ebfa6eb7.js";import"./FileUpload.c211f5c1.js";import"./CodeEditor.5b99e2f5.js";import"./EmptyStateBody.1533f3a6.js";import"./EmptyStateSecondaryActions.511adeb0.js";import"./Modal.11970fe7.js";const q=()=>{const{t:i}=h("identity-providers"),p="oidc",{adminClient:c}=g(),{realm:l}=I(),{setValue:s,setError:n,clearErrors:u,formState:{errors:d}}=S(),y=r=>{Object.keys(r).map(t=>s(`config.${t}`,r[t]))},f=async r=>{if(u("discoveryError"),!r)return;const t=new FormData;t.append("providerId",p),t.append("file",new Blob([JSON.stringify(r)]));try{const o=await fetch(`${C(c.baseUrl)}admin/realms/${l}/identity-provider/import-config`,{method:"POST",body:t,headers:E(await c.getAccessToken())});if(o.ok){const a=await o.json();y(a)}else n("discoveryError",{type:"manual",message:o.statusText})}catch(o){n("discoveryError",{type:"manual",message:o.message})}};return m(b,{children:[e(G,{headingLevel:"h4",size:"xl",className:"kc-form-panel__title",children:i("oidcSettings")}),e(N,{id:"oidc",fileUpload:e(B,{label:i("importConfig"),fieldId:"kc-import-config",labelIcon:e(J,{helpText:"identity-providers-help:importConfig",fieldLabelId:"identity-providers:importConfig"}),validated:d.discoveryError?"error":"default",helperTextInvalid:d.discoveryError?.message,children:e(K,{id:"kc-import-config",helpText:"identity=providers-help:jsonFileUpload",hideDefaultPreview:!0,unWrap:!0,validated:d.discoveryError?"error":"default",onChange:r=>f(r)})}),children:r=>e(z,{readOnly:r})})]})};function be(){const{t:i}=h("identity-providers"),p=x(),{pathname:c}=D(),l=c.includes("keycloak-oidc"),s=`${l?"keycloak-":""}oidc`,n=k({defaultValues:{alias:s}}),{handleSubmit:u,formState:{isDirty:d}}=n,{adminClient:y}=g(),{addAlert:f,addError:r}=O(),{realm:t}=I(),o=async a=>{delete a.discoveryEndpoint;try{await y.identityProviders.create({...a,providerId:s}),f(i("createSuccess"),V.success),p(j({realm:t,providerId:s,alias:a.alias,tab:"settings"}))}catch(F){r("identity-providers:createError",F)}};return m(b,{children:[e(U,{titleKey:i(l?"addKeycloakOpenIdProvider":"addOpenIdProvider")}),e(P,{variant:"light",children:e(A,{...n,children:m(H,{role:"manage-identity-providers",isHorizontal:!0,onSubmit:u(o),children:[e(L,{id:s}),e(q,{}),e($,{}),m(_,{children:[e(v,{isDisabled:!d,variant:"primary",type:"submit","data-testid":"createProvider",children:i("common:add")}),e(v,{variant:"link","data-testid":"cancel",component:a=>e(T,{...a,to:w({realm:t})}),children:i("common:cancel")})]})]})})})]})}export{be as default};
//# sourceMappingURL=AddOpenIdConnect.8118cd2c.js.map
