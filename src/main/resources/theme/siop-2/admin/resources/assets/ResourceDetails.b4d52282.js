import{u as V,r as u,az as k,aZ as K,j as e,aA as j,ax as q,h as x,F as N,bP as E,aX as L,c6 as D,K as H,ao as G,P as Z,aw as S,aB as W,q as M,ad as X,b3 as J,aD as Q,bZ as Y,aC as $}from"./index.7cbfb18a.js";import{a as ee,C as O,u as te,F as ae}from"./index.esm.1e7ace95.js";import{u as re}from"./ConfirmDialog.4dc691c5.js";import{F as se}from"./FormAccess.3a7ea209.js";import{H as i}from"./HelpItem.719382e8.js";import{K as oe}from"./KeyValueInput.21e1d12c.js";import{K as g}from"./KeycloakTextInput.9afb01cd.js";import{M as ne}from"./MultiLineInput.091fd21a.js";import{V as le}from"./ViewHeader.083cd951.js";import{u as ie}from"./useParams.3f76335e.js";import{a as c,A as ce}from"./FormGroup.60c77f60.js";import{S as de,b as me,a as ue}from"./Select.fbe867d5.js";import"./Modal.11970fe7.js";import"./copy-icon.dbf95270.js";import"./GridItem.63e5e367.js";import"./FlexItem.ae9c1d3c.js";import"./minus-circle-icon.c093f419.js";import"./ActionListItem.65cb5d9a.js";import"./plus-circle-icon.aa8a939a.js";import"./Text.28ece842.js";import"./check.51c67984.js";import"./star-icon.a6efdd26.js";const pe=({clientId:t})=>{const{t:m}=V("clients"),{control:w}=ee(),[A,C]=u.exports.useState(!1),[p,T]=u.exports.useState(),[l,h]=u.exports.useState(""),{adminClient:v}=k();K(()=>{const r={id:t,first:0,max:20,deep:!1,name:l};return v.clients.listAllScopes(r)},T,[l]);const f=r=>r?.map(o=>e(ue,{value:o,children:o.name},o.id));return e(c,{label:m("authorizationScopes"),labelIcon:e(i,{helpText:"clients-help:scopes",fieldLabelId:"clients:scopes"}),fieldId:"scopes",children:e(O,{name:"scopes",defaultValue:[],control:w,render:({field:r})=>e(de,{toggleId:"scopes",variant:me.typeaheadMulti,chipGroupProps:{numChips:3,expandedText:m("common:hide"),collapsedText:m("common:showRemaining")},onToggle:C,isOpen:A,selections:r.value.map(o=>o.name),onFilter:(o,d)=>(h(d),f(p)),onSelect:(o,d)=>{const y=typeof d=="string"?d:d.name,P=r.value.find(s=>s.name===y)?r.value.filter(s=>s.name!==y):[...r.value,d];r.onChange(P)},onClear:o=>{o.stopPropagation(),h(""),r.onChange([])},"aria-label":m("authorizationScopes"),children:f(p)})})})};function Ke(){const{t}=V("clients"),[m,w]=u.exports.useState(),[A,C]=u.exports.useState(),[p,T]=u.exports.useState(),{adminClient:l}=k(),{addAlert:h,addError:v}=j(),f=te({mode:"onChange"}),{register:r,formState:{errors:o},control:d,setValue:y,handleSubmit:P}=f,{id:s,resourceId:n,realm:R}=ie(),F=q(),_=(a={})=>{$(a,y)};K(()=>Promise.all([l.clients.findOne({id:s}),n?l.clients.getResource({id:s,resourceId:n}):Promise.resolve(void 0),n?l.clients.listPermissionsByResource({id:s,resourceId:n}):Promise.resolve(void 0)]),([a,b,I])=>{if(!a)throw new Error(t("common:notFound"));w(a),T(I),C(b),_(b)},[]);const B=async a=>{const b=Q(a);try{if(n)await l.clients.updateResource({id:s,resourceId:n},b);else{const I=await l.clients.createResource({id:s},b);F(Y({realm:R,id:s,resourceId:I._id}))}h(t((n?"update":"create")+"ResourceSuccess"),L.success)}catch(I){v("clients:resourceSaveError",I)}},[U,z]=re({titleKey:"clients:deleteResource",children:x(N,{children:[t("deleteResourceConfirm"),p?.length!==0&&e(E,{variant:"warning",isInline:!0,isPlain:!0,title:t("deleteResourceWarning"),className:"pf-u-pt-lg",children:e("p",{className:"pf-u-pt-xs",children:p?.map(a=>e("strong",{className:"pf-u-pr-md",children:a.name},a.id))})})]}),continueButtonLabel:"clients:confirm",onConfirm:async()=>{try{await l.clients.delResource({id:s,resourceId:n}),h(t("resourceDeletedSuccess"),L.success),F(D({realm:R,clientId:s,tab:"resources"}))}catch(a){v("clients:resourceDeletedError",a)}}});return m?x(N,{children:[e(z,{}),e(le,{titleKey:n?A?.name:"clients:createResource",dropdownItems:n?[e(G,{"data-testid":"delete-resource",onClick:()=>U(),children:t("common:delete")},"delete")]:void 0}),e(Z,{variant:"light",children:e(ae,{...f,children:x(se,{isHorizontal:!0,role:"view-clients",className:"keycloak__resource-details__form",onSubmit:P(B),children:[e(c,{label:t("owner"),fieldId:"owner",labelIcon:e(i,{helpText:"clients-help:owner",fieldLabelId:"clients:owner"}),children:e(g,{id:"owner",value:m.clientId,isReadOnly:!0})}),e(c,{label:t("common:name"),fieldId:"name",labelIcon:e(i,{helpText:"clients-help:resourceName",fieldLabelId:"name"}),helperTextInvalid:t("common:required"),validated:o.name?S.error:S.default,isRequired:!0,children:e(g,{id:"name",validated:o.name?S.error:S.default,...r("name",{required:!0})})}),e(c,{label:t("displayName"),fieldId:"displayName",labelIcon:e(i,{helpText:"clients-help:displayName",fieldLabelId:"name"}),children:e(g,{id:"displayName",...r("displayName")})}),e(c,{label:t("type"),fieldId:"type",labelIcon:e(i,{helpText:"clients-help:type",fieldLabelId:"type"}),children:e(g,{id:"type",...r("type")})}),e(c,{label:t("uris"),fieldId:"uris",labelIcon:e(i,{helpText:"clients-help:uris",fieldLabelId:"clients:uris"}),children:e(ne,{name:"uris",type:"url","aria-label":t("uris"),addButtonLabel:"clients:addUri"})}),e(pe,{clientId:s}),e(c,{label:t("iconUri"),fieldId:"iconUri",labelIcon:e(i,{helpText:"clients-help:iconUri",fieldLabelId:"clients:iconUri"}),children:e(g,{id:"iconUri",type:"url",...r("icon_uri")})}),e(c,{hasNoPaddingTop:!0,label:t("ownerManagedAccess"),labelIcon:e(i,{helpText:"clients-help:ownerManagedAccess",fieldLabelId:"clients:ownerManagedAccess"}),fieldId:"ownerManagedAccess",children:e(O,{name:"ownerManagedAccess",control:d,defaultValue:!1,render:({field:a})=>e(W,{id:"ownerManagedAccess",label:t("common:on"),labelOff:t("common:off"),isChecked:a.value,onChange:a.onChange,"aria-label":t("ownerManagedAccess")})})}),e(c,{hasNoPaddingTop:!0,label:t("resourceAttribute"),labelIcon:e(i,{helpText:"clients-help:resourceAttribute",fieldLabelId:"clients:resourceAttribute"}),fieldId:"resourceAttribute",children:e(oe,{name:"attributes"})}),e(ce,{children:x("div",{className:"pf-u-mt-md",children:[e(M,{variant:X.primary,type:"submit","data-testid":"save",children:t("common:save")}),e(M,{variant:"link","data-testid":"cancel",component:a=>e(J,{...a,to:D({realm:R,clientId:s,tab:"resources"})}),children:t("common:cancel")})]})})]})})})]}):e(H,{})}export{Ke as default};
//# sourceMappingURL=ResourceDetails.b4d52282.js.map
