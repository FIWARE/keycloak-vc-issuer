import{_ as T,j as e,p as $,ab as ae,ax as G,r as c,h as p,am as te,al as re,L as oe,u as j,az as z,aA as E,q as O,ad as _,T as x,b7 as se,l as ne,g as ie,aZ as le,ao as L,d1 as M,n as I,aX as de,F as U,b1 as ce,P as me,a$ as pe,b0 as A,d2 as ue,d3 as ge,d4 as he}from"./index.7cbfb18a.js";import{u as fe}from"./ConfirmDialog.4dc691c5.js";import{C as H,G as B}from"./ClickableCard.67f30edc.js";import{s as N}from"./Card.37028a42.js";import{C as Ce}from"./CardHeader.b7b31472.js";import{C as R}from"./CardTitle.d8222cf8.js";import{C as De}from"./CardBody.4fff68f7.js";import{F as ye,a as V}from"./FlexItem.ae9c1d3c.js";import{V as ve}from"./ViewHeader.083cd951.js";import{M as be,a as ke}from"./Modal.11970fe7.js";import{T as P,a as K}from"./Text.28ece842.js";import{e as Se,D as we,a as Fe,b as Ie,c as xe,d as Ne}from"./DataListItemRow.df3ed5f3.js";import{D as Pe}from"./DataListControl.e70b25ea.js";import"./HelpItem.719382e8.js";import"./data-list.f7ff2ea7.js";import"./grip-vertical-icon.7e109111.js";const q=t=>{var{children:n=null,className:r="",hasNoOffset:i=!1}=t,o=T(t,["children","className","hasNoOffset"]);return e("div",{...Object.assign({className:$(N.cardActions,i&&N.modifiers.noOffset,r)},o),children:n})};q.displayName="CardActions";const X=t=>{var{children:n=null,className:r="",component:i="div"}=t,o=T(t,["children","className","component"]);return e(i,{...Object.assign({className:$(N.cardFooter,r)},o),children:n})};X.displayName="CardFooter";const Z=t=>{var{children:n=null,component:r="div"}=t,i=T(t,["children","component"]);return e(r,{...Object.assign({},i),children:n})};Z.displayName="GalleryItem";const Te={name:"DatabaseIcon",height:512,width:448,svgPath:"M448 73.143v45.714C448 159.143 347.667 192 224 192S0 159.143 0 118.857V73.143C0 32.857 100.333 0 224 0s224 32.857 224 73.143zM448 176v102.857C448 319.143 347.667 352 224 352S0 319.143 0 278.857V176c48.125 33.143 136.208 48.572 224 48.572S399.874 209.143 448 176zm0 160v102.857C448 479.143 347.667 512 224 512S0 479.143 0 438.857V336c48.125 33.143 136.208 48.572 224 48.572S399.874 369.143 448 336z",yOffset:0,xOffset:0},Oe=ae(Te);const Le=({title:t,dropdownItems:n,labelText:r,labelColor:i,footerText:o,to:l})=>{const u=G(),[f,C]=c.exports.useState(!1),m=()=>{C(!f)},g=h=>{h.stopPropagation()};return p(H,{isSelectable:!0,onClick:()=>u(l),children:[p(Ce,{children:[e(q,{children:n&&e(te,{"data-testid":`${t}-dropdown`,isPlain:!0,position:"right",toggle:e(re,{onToggle:m}),onClick:h=>g(h),isOpen:f,dropdownItems:n})}),e(R,{"data-testid":"keycloak-card-title",children:t})]}),e(De,{}),e(X,{children:p(ye,{children:[e(V,{className:"keycloak--keycloak-card__footer",children:o&&o}),e(V,{children:r&&e(oe,{color:i||"gray",children:r})})]})})]})},Me=({components:t,onClose:n})=>{const{t:r}=j("user-federation"),{adminClient:i}=z(),{addAlert:o,addError:l}=E(),[u,f]=c.exports.useState(""),[C,m]=c.exports.useState(""),[g,h]=c.exports.useState(t.map(s=>s.name)),v=s=>{f(s),m(r("common:onDragStart",{item:s}))},b=()=>{m(r("common:onDragMove",{item:u}))},k=()=>{m(r("common:onDragCancel"))},S=s=>{m(r("common:onDragFinish",{list:s})),h(s)};return p(be,{variant:ke.small,title:r("managePriorityOrder"),isOpen:!0,onClose:n,actions:[e(O,{id:"modal-confirm",onClick:async()=>{const s=g.map((D,w)=>{const y=t.find(F=>F.name===D);return y.config.priority=[w.toString()],i.components.update({id:y.id},y)});try{await Promise.all(s),o(r("orderChangeSuccess"))}catch(D){l("orderChangeError",D)}n()},children:r("common:save")},"confirm"),e(O,{id:"modal-cancel",variant:_.link,onClick:n,children:r("common:cancel")},"cancel")],children:[e(x,{className:"pf-u-pb-lg",children:e(P,{children:r("managePriorityInfo")})}),e(Se,{"aria-label":r("manageOrderTableAria"),"data-testid":"manageOrderDataList",isCompact:!0,onDragFinish:S,onDragStart:v,onDragMove:b,onDragCancel:k,itemOrder:g,children:se(t,"config.priority","name").map(s=>e(we,{"aria-label":s.name,id:s.name,children:p(Fe,{children:[e(Pe,{children:e(Ie,{"aria-label":r("common-help:dragHelp")})}),e(xe,{dataListCells:[e(Ne,{"data-testid":s.name,children:s.name},s.name)]})]})},s.name))}),e("div",{className:"pf-screen-reader","aria-live":"assertive",children:C})]})};function Je(){const[t,n]=c.exports.useState(),{addAlert:r,addError:i}=E(),{t:o}=j("user-federation"),{realm:l}=ne(),{adminClient:u}=z(),[f,C]=c.exports.useState(0),m=()=>C(new Date().getTime()),g=G(),[h,v]=c.exports.useState(!1),b=ie().componentTypes?.["org.keycloak.storage.UserStorageProvider"]||[];le(async()=>{const d={parentId:(await u.realms.findOne({realm:l})).id,type:"org.keycloak.storage.UserStorageProvider"};return u.components.find(d)},a=>{n(a)},[f]);const k=c.exports.useMemo(()=>b.map(a=>e(L,{onClick:()=>g(M({realm:l,providerId:a.id})),children:a.id.toUpperCase()=="LDAP"?a.id.toUpperCase():I(a.id)},a.id)),[]),S={variant:"link",onClick:()=>v(!0),lowerButtonTitle:o("managePriorities")};let s;const[D,w]=c.exports.useState(""),[y,F]=fe({titleKey:o("userFedDeleteConfirmTitle"),messageKey:o("userFedDeleteConfirm"),continueButtonLabel:"common:delete",continueButtonVariant:_.danger,onConfirm:async()=>{try{await u.components.del({id:D}),m(),r(o("userFedDeletedSuccess"),de.success)}catch(a){i("user-federation:userFedDeleteError",a)}}}),J=a=>{w(a),y()},Q=(a,d)=>{const Y=`${a.name}`,ee=`${d.name}`;return Y<ee?-1:1},W=(a,d)=>{switch(a){case"ldap":return he({realm:l,id:d});case"kerberos":return ge({realm:l,id:d});default:return ue({realm:l,providerId:a,id:d})}};return t&&(s=t.sort(Q).map((a,d)=>e(Z,{className:"keycloak-admin--user-federation__gallery-item",children:e(Le,{to:W(a.providerId,a.id),dropdownItems:[e(L,{onClick:()=>{J(a.id)},"data-testid":"card-delete",children:o("common:delete")},`${d}-cardDelete`)],title:a.name,footerText:I(a.providerId),labelText:a.config?.enabled?.[0]!=="false"?`${o("common:enabled")}`:`${o("common:disabled")}`,labelColor:a.config?.enabled?.[0]!=="false"?"blue":"gray"})},d))),p(U,{children:[e(F,{}),h&&t&&e(Me,{onClose:()=>v(!1),components:t.filter(a=>a.config?.enabled)}),e(ve,{titleKey:"userFederation",subKey:"user-federation:userFederationExplain",helpUrl:ce.userFederationUrl,...t&&t.length>0?{lowerDropdownItems:k,lowerDropdownMenuTitle:"user-federation:addNewProvider",lowerButton:S}:{}}),e(me,{children:t&&t.length>0?e(B,{hasGutter:!0,children:s}):p(U,{children:[e(x,{children:e(P,{component:K.p,children:o("getStarted")})}),e(x,{children:e(P,{className:"pf-u-mt-lg",component:K.h2,children:o("providers")})}),e("hr",{className:"pf-u-mb-lg"}),e(B,{hasGutter:!0,children:b.map(a=>e(H,{onClick:()=>g(M({realm:l,providerId:a.id})),"data-testid":`${a.id}-card`,children:e(R,{children:p(pe,{hasGutter:!0,children:[e(A,{children:e(Oe,{size:"lg"})}),e(A,{isFilled:!0,children:o("addProvider",{provider:I(a.id),count:4})})]})})},a.id))})]})})]})}export{Je as default};
//# sourceMappingURL=UserFederationSection.399e4065.js.map
