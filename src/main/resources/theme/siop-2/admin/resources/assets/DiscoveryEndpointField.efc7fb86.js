import{u as k,az as w,r as n,h as C,F as S,j as s,aB as T,m as U}from"./index.2ecf13ca.js";import{a as j}from"./index.esm.68aaf060.js";import{H as u}from"./HelpItem.49be9c4e.js";import{K as q}from"./KeycloakTextInput.97e36976.js";import{a as m}from"./FormGroup.24d2e56a.js";const L=({id:r,fileUpload:E,children:c})=>{const{t:o}=k("identity-providers"),{adminClient:f}=w(),{setValue:h,register:D,setError:x,watch:g,clearErrors:a,formState:{errors:t}}=j(),l=g("discoveryEndpoint"),[i,I]=n.exports.useState(!0),[p,d]=n.exports.useState(!1),[y,b]=n.exports.useState(),F=e=>{Object.keys(e).map(v=>h(`config.${v}`,e[v]))};return n.exports.useEffect(()=>{if(!l){d(!1);return}(async()=>{a("discoveryError");try{const e=await f.identityProviders.importFromUrl({providerId:r,fromUrl:l});F(e),b(e)}catch(e){x("discoveryError",{type:"manual",message:e.message})}d(!1)})()},[p]),C(S,{children:[s(m,{label:o(r==="oidc"?"useDiscoveryEndpoint":"useEntityDescriptor"),fieldId:"kc-discovery-endpoint",labelIcon:s(u,{helpText:`identity-providers-help:${r==="oidc"?"useDiscoveryEndpoint":"useEntityDescriptor"}`,fieldLabelId:"identity-providers:discoveryEndpoint"}),children:s(T,{id:"kc-discovery-endpoint-switch",label:o("common:on"),labelOff:o("common:off"),isChecked:i,onChange:e=>{a("discoveryError"),I(e)},"aria-label":o(r==="oidc"?"useDiscoveryEndpoint":"useEntityDescriptor")})}),i&&s(m,{label:o(r==="oidc"?"discoveryEndpoint":"samlEntityDescriptor"),fieldId:"kc-discovery-endpoint",labelIcon:s(u,{helpText:`identity-providers-help:${r==="oidc"?"discoveryEndpoint":"samlEntityDescriptor"}`,fieldLabelId:"identity-providers:discoveryEndpoint"}),validated:t.discoveryError||t.discoveryEndpoint?"error":y?"success":"default",helperTextInvalid:t.discoveryEndpoint?o("common:required"):o("noValidMetaDataFound",{error:t.discoveryError?.message}),isRequired:!0,children:s(q,{type:"url","data-testid":"discoveryEndpoint",id:"kc-discovery-endpoint",placeholder:r==="oidc"?"https://hostname/auth/realms/master/.well-known/openid-configuration":"",validated:t.discoveryError||t.discoveryEndpoint?"error":y?"success":"default",customIconUrl:p?U.resourceUrl+"/discovery-load-indicator.svg":"",...D("discoveryEndpoint",{required:!0,onBlur:()=>d(!0)})})}),!i&&E,i&&!t.discoveryError&&c(!0),!i&&c(!1)]})};export{L as D};
//# sourceMappingURL=DiscoveryEndpointField.efc7fb86.js.map
