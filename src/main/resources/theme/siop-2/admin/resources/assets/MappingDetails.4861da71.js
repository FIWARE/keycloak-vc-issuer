import{u as j,az as q,aA as G,r as b,ax as H,l as L,g as _,bK as N,aZ as $,ad as z,aX as F,h as u,F as U,j as o,ao as X,P as Z,aw as l,q as S,b3 as J,bL as Q,bG as W,bM as Y,aD as ee,aC as oe}from"./index.2ecf13ca.js";import{u as te,F as re}from"./index.esm.68aaf060.js";import{u as ae}from"./ConfirmDialog.b43fd344.js";import{D as pe}from"./DynamicComponents.16b222ec.js";import{F as ie}from"./FormAccess.7ed5d8eb.js";import{H as ne}from"./HelpItem.49be9c4e.js";import{K as T}from"./KeycloakTextInput.97e36976.js";import{V as se}from"./ViewHeader.67577dd4.js";import{u as me}from"./useParams.921239aa.js";import{a as C,A as ce}from"./FormGroup.24d2e56a.js";import"./Modal.2c72168d.js";import"./ClientSelect.95a4ec0e.js";import"./Select.5d6f6214.js";import"./check.51c67984.js";import"./star-icon.648ddb2a.js";import"./FileUpload.005327fa.js";import"./CodeEditor.0b7c4c70.js";import"./copy-icon.06155c15.js";import"./EmptyStateBody.25bf6e38.js";import"./EmptyStateSecondaryActions.3ed74a6a.js";import"./GroupPickerDialog.38947607.js";import"./ListEmptyState.94d606ed.js";import"./TableToolbar.f167c244.js";import"./plus-circle-icon.f1969120.js";import"./DataListItemRow.7402b99a.js";import"./data-list.f7ff2ea7.js";import"./grip-vertical-icon.6efe1939.js";import"./ActionListItem.c90af00f.js";import"./FlexItem.2ee8dfc9.js";import"./minus-circle-icon.e9e185f2.js";import"./MultiLineInput.7867bd1a.js";import"./PasswordInput.4caf2dff.js";import"./useToggle.97c716af.js";import"./AddRoleMappingModal.c7175fba.js";import"./KeycloakDataTable.5c9a6c7c.js";import"./Td.ff2a9f66.js";import"./Checkbox.56efba4a.js";import"./useLocaleSort.377bcdf5.js";import"./resource.09062762.js";import"./joinPath.69b856b1.js";import"./filter-icon.f568e30b.js";import"./KeycloakTextArea.2947a089.js";import"./GridItem.a22d8cac.js";import"./Text.441b2f8e.js";function oo(){const{t}=j("client-scopes"),{adminClient:i}=q(),{addAlert:f,addError:g}=G(),{id:r,mapperId:a}=me(),y=te(),{register:I,setValue:D,formState:{errors:h},handleSubmit:P}=y,[d,x]=b.exports.useState(),[A,V]=b.exports.useState(),k=H(),{realm:M}=L(),w=_(),E=/^[{]?[0-9a-fA-F]{8}-([0-9a-fA-F]{4}-){3}[0-9a-fA-F]{12}[}]?$/,s=!!a.match(E),m=!!N(Q.path),v=()=>m?W({realm:M,id:r,tab:"mappers"}):Y({realm:M,clientId:r,tab:"mappers"});$(async()=>{let e;if(s){if(m?e=await i.clientScopes.findProtocolMapper({id:r,mapperId:a}):e=await i.clients.findProtocolMapperById({id:r,mapperId:a}),!e)throw new Error(t("common:notFound"));const p=w.protocolMapperTypes[e.protocol].find(c=>c.id===e.protocolMapper);return{config:{protocol:e.protocol,protocolMapper:e.protocolMapper},mapping:p,data:e}}else{const n=m?await i.clientScopes.findOne({id:r}):await i.clients.findOne({id:r});if(!n)throw new Error(t("common:notFound"));const c=w.protocolMapperTypes[n.protocol].find(R=>R.id===a);if(!c)throw new Error(t("common:notFound"));return{mapping:c,config:{protocol:n.protocol,protocolMapper:a}}}},({config:e,mapping:n,data:p})=>{V(e),x(n),p&&oe(p,D)},[]);const[K,O]=ae({titleKey:"common:deleteMappingTitle",messageKey:"common:deleteMappingConfirm",continueButtonLabel:"common:delete",continueButtonVariant:z.danger,onConfirm:async()=>{try{m?await i.clientScopes.delProtocolMapper({id:r,mapperId:a}):await i.clients.delProtocolMapper({id:r,mapperId:a}),f(t("common:mappingDeletedSuccess"),F.success),k(v())}catch(e){g("common:mappingDeletedError",e)}}}),B=async e=>{const n=s?"Updated":"Created";try{const p={...A,...ee(e)};s?m?await i.clientScopes.updateProtocolMapper({id:r,mapperId:a},{id:a,...p}):await i.clients.updateProtocolMapper({id:r,mapperId:a},{id:a,...p}):m?await i.clientScopes.addProtocolMapper({id:r},p):await i.clients.addProtocolMapper({id:r},p),f(t(`common:mapping${n}Success`),F.success)}catch(p){g(`common:mapping${n}Error`,p)}};return u(U,{children:[o(O,{}),o(se,{titleKey:s?d?.name:t("common:addMapper"),subKey:s?a:"client-scopes:addMapperExplain",dropdownItems:s?[o(X,{value:"delete",onClick:K,children:t("common:delete")},"delete")]:void 0}),o(Z,{variant:"light",children:u(ie,{isHorizontal:!0,onSubmit:P(B),role:"manage-clients",className:"keycloak__client-scope-mapping-details__form",children:[o(C,{label:t("common:mapperType"),fieldId:"mapperType",children:o(T,{type:"text",id:"mapperType",name:"mapperType",isReadOnly:!0,value:d?.name})}),o(C,{label:t("common:name"),labelIcon:o(ne,{helpText:"client-scopes-help:mapperName",fieldLabelId:"name"}),fieldId:"name",isRequired:!0,validated:h.name?l.error:l.default,helperTextInvalid:t("common:required"),children:o(T,{id:"name",isReadOnly:s,validated:h.name?l.error:l.default,...I("name",{required:!0})})}),o(re,{...y,children:o(pe,{properties:d?.properties||[]})}),u(ce,{children:[o(S,{variant:"primary",type:"submit",children:t("common:save")}),o(S,{variant:"link",component:e=>o(J,{...e,to:v()}),children:t("common:cancel")})]})]})})]})}export{oo as default};
//# sourceMappingURL=MappingDetails.4861da71.js.map
