import{_ as T,j as t,p as I,I as J,h as p,F as U,r as d,a3 as X,u as Z,az as K,aZ as Q,q as w,bA as W,bB as B,bC as Y}from"./index.7cbfb18a.js";import{P as ee,L as R}from"./ListEmptyState.fef0510e.js";import{e as se,D as te,a as ae,c as ie,d as ne}from"./DataListItemRow.df3ed5f3.js";import{s as v}from"./data-list.f7ff2ea7.js";import{M as le,a as oe}from"./Modal.11970fe7.js";const F=i=>{var{children:o,className:m,visibility:c,id:f,"aria-label":k,"aria-labelledby":h,isPlainButtonAction:a}=i,u=T(i,["children","className","visibility","id","aria-label","aria-labelledby","isPlainButtonAction"]);return t("div",{...Object.assign({className:I(v.dataListItemAction,J(c,v),m)},u),children:a?t("div",{className:I(v.dataListAction),children:o}):o})};F.displayName="DataListAction";const O=i=>{var{className:o="",onChange:m=(n,g)=>{},isValid:c=!0,isDisabled:f=!1,isChecked:k=!1,checked:h=!1,defaultChecked:a,otherControls:u=!1}=i,b=T(i,["className","onChange","isValid","isDisabled","isChecked","checked","defaultChecked","otherControls"]);const G=t("div",{className:I(v.dataListCheck),children:t("input",{...Object.assign({},b,{type:"checkbox",onChange:n=>m(n.currentTarget.checked,n),"aria-invalid":!c,disabled:f},[!0,!1].includes(a)&&{defaultChecked:a},![!0,!1].includes(a)&&{checked:k||h})})});return p(U,{children:[!u&&t("div",{className:I(v.dataListItemControl,o),children:G}),u&&G]})};O.displayName="DataListCheck";const re=20,$=10,ce=i=>i&&i.length>=re?i.substr(0,$)+"..."+i.substr(i.length-$,i.length):i,de=({group:{path:i},onMouseEnter:o,...m})=>{const[c,f]=d.exports.useState(""),h=t("span",{onMouseEnter:a=>{f(i),o?.(a)},...m,children:ce(i)});return c!==""?t(X,{content:c,isVisible:!0,children:h}):h},pe=({id:i,type:o,filterGroups:m,text:c,canBrowse:f=!0,onClose:k,onConfirm:h})=>{const{t:a}=Z(),{adminClient:u}=K(),[b,G]=d.exports.useState([]),[n,g]=d.exports.useState([]),[L,V]=d.exports.useState([]),[r,_]=d.exports.useState(""),[q,z]=d.exports.useState([]),[P,x]=d.exports.useState(),[y,M]=d.exports.useState(10),[A,N]=d.exports.useState(0),E=()=>n[n.length-1];Q(async()=>{let e,s,l;if(!P)s=await u.groups.find({first:A,max:y+1,search:r});else{if(e=await u.groups.findOne({id:P}),!e)throw new Error(a("common:notFound"));s=e.subGroups}return i&&(l=await u.users.listGroups({id:i})),{group:e,groups:s,existingUserGroups:l}},async({group:e,groups:s,existingUserGroups:l})=>{z(l||[]),e&&g([...n,e]),s.forEach(C=>{C.checked=!!b.find(H=>H.id===C.id)}),V(s)},[P,r,A,y]);const D=e=>[...q.map(s=>s.id),...(m||[]).map(s=>s.id)].some(s=>s===e?.id),j=e=>e.subGroups?.length!==0,S=(e,s)=>{if(e.name?.includes(s))return e;if(e.subGroups)for(const l of e.subGroups)return S(l,s);return e};return t(le,{variant:oe.small,title:a(c.title,{group1:m?.[0]?.name,group2:n.length?E().name:a("root")}),isOpen:!0,onClose:k,actions:[t(w,{"data-testid":`${c.ok}-button`,variant:"primary",form:"group-form",onClick:()=>{h(o==="selectMany"?b:n.length?[E()]:void 0)},isDisabled:o==="selectMany"&&b.length===0,children:a(c.ok)},"confirm")],children:p(ee,{count:L.length,first:A,max:y,onNextClick:N,onPreviousClick:N,onPerPageSelect:(e,s)=>{N(e),M(s)},inputGroupName:"common:search",inputGroupOnEnter:e=>{_(e),N(0),M(10),g([])},inputGroupPlaceholder:a("users:searchForGroups"),children:[p(W,{children:[n.length>0&&t(B,{children:t(w,{variant:"link",onClick:()=>{x(void 0),g([])},children:a("groups")})},"home"),n.map((e,s)=>p(B,{children:[n.length-1!==s&&t(w,{variant:"link",onClick:()=>{x(e.id),g([...n].slice(0,s))},children:e.name}),n.length-1===s&&e.name]},s))]}),p(se,{"aria-label":a("groups"),isCompact:!0,children:[L.slice(0,y).map(e=>t(te,{className:`join-group-dialog-row-${D(e)?"disabled":""}`,"aria-labelledby":e.name,id:e.id,onClick:s=>{const l=r!==""?S(e,r):e;D(l)||(o==="selectOne"?x(l.id):j(e)&&r===""&&s.target.type!=="checkbox"&&x(e.id))},children:p(ae,{className:`join-group-dialog-row-${D(e)?"m-disabled":""}`,"data-testid":e.name,children:[o==="selectMany"&&t(O,{className:"kc-join-group-modal-check","data-testid":`${e.name}-check`,"aria-label":e.name,checked:e.checked,isDisabled:D(e),onChange:s=>{e.checked=s;let l=[];e.checked?l=[...b,r===""?e:S(e,r)]:l=b.filter(C=>C.id!==e.id),G(l)},"aria-labelledby":`select-${e.name}`}),t(ie,{dataListCells:[t(ne,{children:r===""?t("span",{id:`select-${e.name}`,children:e.name}):t(de,{id:`select-${e.name}`,group:S(e,r)})},`name-${e.id}`)]}),t(F,{id:"actions","aria-labelledby":`select-${e.name}`,"aria-label":a("groupName"),isPlainButtonAction:!0,children:(j(e)&&r===""&&f||o==="selectOne")&&t(w,{isDisabled:!0,variant:"link","aria-label":a("common:select"),children:t(Y,{})})})]})},e.id)),L.length===0&&r===""&&t(R,{hasIcon:!1,message:a("groups:moveGroupEmpty"),instructions:a("groups:moveGroupEmptyInstructions")}),L.length===0&&r!==""&&t(R,{message:a("common:noSearchResults"),instructions:a("common:noSearchResultsInstructions")})]})]})})};export{pe as G,de as a};
//# sourceMappingURL=GroupPickerDialog.174f65c8.js.map
