import{_ as vt,h as r,p as je,j as e,aa as oi,az as se,l as ge,u as E,R as An,g as Be,r as u,aZ as ce,bO as et,bP as $e,aX as te,b5 as li,b6 as ri,bQ as Qe,a$ as tt,b0 as ke,bz as D,F as V,aB as ue,q as _,b7 as wn,aA as pe,ad as Ce,bR as _e,b3 as ye,bM as On,af as Ut,a3 as Vt,P as fe,n as Ct,bS as gt,T as De,bT as qt,aP as ci,ac as di,ae as ui,G as Ge,aE as We,bU as pi,K as Ne,am as jt,aG as En,L as Kt,ax as nt,bV as mt,ao as Ye,an as mi,bW as Zt,bX as Pn,bY as en,bZ as Ln,b_ as tn,b$ as Me,aw as Ie,c0 as hi,Q as gi,c1 as fi,al as bi,aU as _n,c2 as yi,bN as Si,c3 as vi,c4 as Ci,c5 as nn,c6 as sn,c7 as Ti,aC as Ii,aD as an,bh as ki}from"./index.7cbfb18a.js";import{a as Y,C as K,u as Pe,c as xi,F as Ke,b as Tt}from"./index.esm.1e7ace95.js";import{C as Gt,u as xe}from"./ConfirmDialog.4dc691c5.js";import{H as I,c as Se,a as Ri,f as Ai,T as Ht}from"./HelpItem.719382e8.js";import{K as it}from"./KeycloakTextArea.d98120cb.js";import{a as st,M as ze}from"./Modal.11970fe7.js";import{F as Re,a as v,A as ve}from"./FormGroup.60c77f60.js";import{S as wi,a as wt,F as de,C as Oi,b as Dn}from"./FormAccess.3a7ea209.js";import{S as W,b as H,a as z}from"./Select.fbe867d5.js";import{P as Ei}from"./PermissionTab.418d47cd.js";import{R as Pi}from"./RolesList.4777b309.js";import{R as Ot,u as Et}from"./RoutableTabs.58e36a71.js";import{V as Li}from"./ViewHeader.083cd951.js";import{u as $t}from"./useParams.3f76335e.js";import{u as Te}from"./useToggle.461e82f2.js";import{S as Nn}from"./ScrollForm.9cb55091.js";import{K as _i}from"./KeyValueInput.21e1d12c.js";import{M as Kn}from"./MultiLineInput.091fd21a.js";import{T as Wt}from"./TimeSelector.3864b0c1.js";import{L as Ee,P as It}from"./ListEmptyState.fef0510e.js";import{K as kt}from"./KeycloakDataTable.ae870e97.js";import{u as Jt,F as Mn}from"./useFormatDate.88f4c3f1.js";import{K as ee}from"./KeycloakTextInput.9afb01cd.js";import{E as Fn}from"./ExpandableSection.0b0d95f4.js";import{T as Bn}from"./Trans.a8d0351e.js";import{T as he,a as zn}from"./Text.28ece842.js";import{C as Di}from"./ClientSelect.2d31aa2e.js";import{F as Mt}from"./FormPanel.95e4e303.js";import{U as Un,i as Ni,D as Ki,A as Mi}from"./PolicyDetails.2345d5f2.js";import{d as Vn,i as yt,g as Fi}from"./utils.988d95db.js";import{D as on}from"./policyRepresentation.f72f5f84.js";import{d as Ue,b as re,e as M,ah as at,T as Ve,a as qe,c as j}from"./Td.1e0c90e7.js";import{D as ot,a as Bi,b as zi,c as Ui}from"./DescriptionListTerm.d74f6911.js";import{c as Vi}from"./camelCase.0b55fcf3.js";import{M as qi}from"./minus-circle-icon.c093f419.js";import{P as qn}from"./plus-circle-icon.aa8a939a.js";import{E as jn,a as Gn}from"./EmptyStateBody.1533f3a6.js";import{E as ji}from"./EmptyStateSecondaryActions.511adeb0.js";import{u as Hn,m as $n}from"./useLocaleSort.b8a659bb.js";import{D as Gi}from"./DeleteScopeDialog.c7d426ad.js";import{J as Hi}from"./JsonFileUpload.ca15e844.js";import{R as ht}from"./Radio.7ee3497e.js";import{S as $i}from"./SessionsTable.33900b43.js";import{C as Wi,a as Ji}from"./ClientDescription.51f3666b.js";import{L as Qi}from"./LoginSettings.498d8554.js";import{P as Ft}from"./PasswordInput.aa539188.js";import{C as St}from"./Card.37028a42.js";import{C as Xe}from"./CardBody.4fff68f7.js";import{F as Wn}from"./FileUpload.c211f5c1.js";import{C as Yi}from"./CardHeader.b7b31472.js";import{C as Xi}from"./CardTitle.d8222cf8.js";import{F as Zi,a as ln}from"./FlexItem.ae9c1d3c.js";import{A as rn,f as cn,g as es,C as dn,d as ts,e as ns}from"./ClientScopeTypes.f384adfd.js";import{S as is,a as ss,C as as,n as os,t as ls}from"./SearchFilter.3c7ebce8.js";import{d as ut,b as rs,T as oe,a as le}from"./Tabs.fae3d04f.js";import{Q as cs}from"./question-circle-icon.7590ca7d.js";import{G as ds,a as un}from"./GridItem.63e5e367.js";import{R as us}from"./AddRoleMappingModal.c8e6830c.js";import"./copy-icon.dbf95270.js";import"./check.51c67984.js";import"./star-icon.a6efdd26.js";import"./ActionListItem.65cb5d9a.js";import"./TableToolbar.51ae2a5f.js";import"./ResourcesPolicySelect.b32d6a9a.js";import"./filter-icon.a9b0a5f3.js";import"./Checkbox.7d63c785.js";import"./GroupPickerDialog.174f65c8.js";import"./DataListItemRow.df3ed5f3.js";import"./data-list.f7ff2ea7.js";import"./grip-vertical-icon.7e109111.js";import"./CodeEditor.5b99e2f5.js";import"./DatePicker.9e41d09c.js";import"./MenuList.22670a64.js";import"./NumberInput.619d2bbb.js";import"./plus-icon.f70ae4c8.js";import"./capitalize.02f8b152.js";import"./FileUploadForm.ebfa6eb7.js";import"./ListItem.7bf862e4.js";import"./resource.2cd5a37e.js";import"./joinPath.69b856b1.js";const bt={codeBlock:"pf-c-code-block",codeBlockActions:"pf-c-code-block__actions",codeBlockCode:"pf-c-code-block__code",codeBlockContent:"pf-c-code-block__content",codeBlockHeader:"pf-c-code-block__header",codeBlockPre:"pf-c-code-block__pre"},Jn=t=>{var{children:i=null,className:a,actions:n=null}=t,s=vt(t,["children","className","actions"]);return r("div",{...Object.assign({className:je(bt.codeBlock,a)},s),children:[e("div",{className:je(bt.codeBlockHeader),children:e("div",{className:je(bt.codeBlockActions),children:n&&n})}),e("div",{className:je(bt.codeBlockContent),children:i})]})};Jn.displayName="CodeBlock";const Qn=t=>{var{children:i=null,className:a}=t,n=vt(t,["children","className"]);return e("div",{...Object.assign({className:je("pf-c-code-block__actions-item",a)},n),children:i})};Qn.displayName="CodeBlockAction";var Bt;(function(t){t.ul="ul",t.ol="ol",t.dl="dl"})(Bt||(Bt={}));const Yn=t=>{var{children:i=null,className:a="",component:n=Bt.ul,isPlain:s=!1}=t,o=vt(t,["children","className","component","isPlain"]);return e(n,{...Object.assign({},o,{className:je(s&&oi.modifiers.plain,a)}),children:i})};Yn.displayName="TextList";var zt;(function(t){t.li="li",t.dt="dt",t.dd="dd"})(zt||(zt={}));const Xn=t=>{var{children:i=null,className:a="",component:n=zt.li}=t,s=vt(t,["children","className","component"]);return e(n,{...Object.assign({},s,{className:je(a)}),children:i})};Xn.displayName="TextListItem";const ps=({id:t,open:i,toggleDialog:a,protocol:n="openid-connect"})=>{const{adminClient:s}=se(),{realm:o}=ge(),{t:l}=E("common"),{enabled:c}=An(),g=Be().clientInstallations[n],[h,f]=u.exports.useState(g[g.length-1].id),[p,d]=u.exports.useState(),[T,S]=u.exports.useState(!1),y=u.exports.useMemo(()=>g.find(R=>R.id===h)??null,[h]),k=R=>R.replace(/<PrivateKeyPem>.*<\/PrivateKeyPem>/gs,`<PrivateKeyPem>${l("clients:privateKeyMask")}</PrivateKeyPem>`);return ce(async()=>{if(y?.mediaType==="application/zip")return(await fetch(`${li(s.baseUrl)}admin/realms/${o}/clients/${t}/installation/providers/${h}`,{method:"GET",headers:ri(await s.getAccessToken())})).arrayBuffer();{const R=await s.clients.getInstallationProviders({id:t,providerId:h});return typeof R=="string"?k(R):Qe(R)}},R=>d(R),[t,h]),u.exports.useEffect(()=>d(""),[t,h]),e(Gt,{titleKey:l("clients:downloadAdaptorTitle"),continueButtonLabel:l("download"),onConfirm:()=>{et.exports.saveAs(new Blob([p],{type:y?.mediaType}),y?.filename)},open:i,toggleDialog:a,variant:st.medium,children:e(Re,{children:r(wi,{hasGutter:!0,children:[c&&e(wt,{children:e($e,{id:t,title:l("clients:description"),variant:te.info,isInline:!0,children:g.find(R=>R.id===h)?.helpText})}),e(wt,{children:e(v,{fieldId:"type",label:l("clients:formatOption"),labelIcon:e(I,{helpText:l("clients-help:downloadType"),fieldLabelId:"clients:formatOption"}),children:e(W,{toggleId:"type",isOpen:T,onToggle:R=>S(R),variant:H.single,value:h,selections:h,onSelect:(R,G)=>{f(G.toString()),S(!1)},"aria-label":"Select Input",menuAppendTo:()=>document.body,children:g.map(R=>e(z,{value:R.id,isSelected:h===R.id,children:R.displayType},R.id))})})}),!y?.downloadOnly&&e(wt,{isFilled:!0,children:e(v,{fieldId:"details",label:l("details"),labelIcon:e(I,{helpText:l("clients-help:details"),fieldLabelId:"clients:details"}),children:e(it,{id:"details",readOnly:!0,rows:12,resizeOrientation:"vertical",value:p&&typeof p=="string"?p:"","aria-label":"text area example"})})})]})})})},pn="tokenLifespan.inherited",mn="tokenLifespan.never",hn="tokenLifespan.expires",pt=({id:t,name:i,defaultValue:a,units:n})=>{const{t:s}=E("clients"),[o,l]=u.exports.useState(!1),[c,m]=u.exports.useState(!1),g=()=>m(!0),h=()=>m(!1),{control:f}=Y(),p=d=>typeof d=="number"&&d!==-1||typeof d=="string"&&d!==""&&d!=="-1"||c;return e(v,{label:s(t),fieldId:t,labelIcon:e(I,{helpText:`clients-help:${t}`,fieldLabelId:`clients:${t}`}),children:e(K,{name:i,defaultValue:"",control:f,render:({field:d})=>r(tt,{hasGutter:!0,children:[e(ke,{children:r(W,{variant:H.single,onToggle:l,isOpen:o,onSelect:(T,S)=>{d.onChange(S),l(!1)},selections:[p(d.value)?s(hn):d.value===""?s(pn):s(mn)],children:[e(z,{value:"",children:s(pn)}),e(z,{value:-1,children:s(mn)}),e(z,{value:60,children:s(hn)})]})}),e(ke,{children:d.value!=="-1"&&d.value!==-1&&e(Wt,{units:n,value:d.value===""?a:d.value,onChange:d.onChange,onFocus:g,onBlur:h,min:1,isDisabled:d.value===""})})]})})})},ms=({save:t,reset:i,protocol:a,hasConfigureAccess:n})=>{const{t:s}=E("clients"),[o,l]=u.exports.useState(!1),[c,m]=u.exports.useState(),{realm:g}=ge(),{adminClient:h}=se();ce(()=>h.realms.findOne({realm:g}),m,[]);const{control:f,register:p}=Y();return r(de,{role:"manage-realm",fineGrainedAccess:n,isHorizontal:!0,children:[a!=="openid-connect"&&e(v,{label:s("assertionLifespan"),fieldId:"assertionLifespan",labelIcon:e(I,{helpText:"clients-help:assertionLifespan",fieldLabelId:"clients:assertionLifespan"}),children:e(K,{name:D("attributes.saml.assertion.lifespan"),defaultValue:"",control:f,render:({field:d})=>e(Wt,{units:["minute","day","hour"],value:d.value,onChange:d.onChange})})}),a==="openid-connect"&&r(V,{children:[e(pt,{id:"accessTokenLifespan",name:D("attributes.access.token.lifespan"),defaultValue:c?.accessTokenLifespan,units:["minute","day","hour"]}),e(pt,{id:"clientSessionIdle",name:D("attributes.client.session.idle.timeout"),defaultValue:c?.clientSessionIdleTimeout,units:["minute","day","hour"]}),e(pt,{id:"clientSessionMax",name:D("attributes.client.session.max.lifespan"),defaultValue:c?.clientSessionMaxLifespan,units:["minute","day","hour"]}),e(pt,{id:"clientOfflineSessionIdle",name:D("attributes.client.offline.session.idle.timeout"),defaultValue:c?.offlineSessionIdleTimeout,units:["minute","day","hour"]}),e(pt,{id:"clientOfflineSessionMax",name:D("attributes.client.offline.session.max.lifespan"),defaultValue:c?.offlineSessionMaxLifespan,units:["minute","day","hour"]}),e(v,{label:s("oAuthMutual"),fieldId:"oAuthMutual",hasNoPaddingTop:!0,labelIcon:e(I,{helpText:"clients-help:oAuthMutual",fieldLabelId:"clients:oAuthMutual"}),children:e(K,{name:"attributes.tls-client-certificate-bound-access-tokens",defaultValue:!1,control:f,render:({field:d})=>e(ue,{id:"oAuthMutual-switch",label:s("common:on"),labelOff:s("common:off"),isChecked:d.value==="true",onChange:T=>d.onChange(""+T),"aria-label":s("oAuthMutual")})})}),e(v,{label:s("keyForCodeExchange"),fieldId:"keyForCodeExchange",hasNoPaddingTop:!0,labelIcon:e(I,{helpText:"clients-help:keyForCodeExchange",fieldLabelId:"clients:keyForCodeExchange"}),children:e(K,{name:D("attributes.pkce.code.challenge.method"),defaultValue:"",control:f,render:({field:d})=>e(W,{toggleId:"keyForCodeExchange",variant:H.single,onToggle:l,isOpen:o,onSelect:(T,S)=>{d.onChange(S),l(!1)},selections:[d.value||s("common:choose")],children:["","S256","plain"].map(T=>e(z,{value:T,children:T||s("common:choose")},T))})})}),e(v,{label:s("pushedAuthorizationRequestRequired"),fieldId:"pushedAuthorizationRequestRequired",labelIcon:e(I,{helpText:"clients-help:pushedAuthorizationRequestRequired",fieldLabelId:"clients:pushedAuthorizationRequestRequired"}),children:e(K,{name:D("attributes.require.pushed.authorization.requests"),defaultValue:"false",control:f,render:({field:d})=>e(ue,{id:"pushedAuthorizationRequestRequired",label:s("common:on"),labelOff:s("common:off"),isChecked:d.value==="true",onChange:T=>d.onChange(T.toString()),"aria-label":s("pushedAuthorizationRequestRequired")})})}),e(v,{label:s("acrToLoAMapping"),fieldId:"acrToLoAMapping",labelIcon:e(I,{helpText:"clients-help:acrToLoAMapping",fieldLabelId:"clients:acrToLoAMapping"}),children:e(_i,{...p(D("attributes.acr.loa.map"))})}),e(v,{label:s("defaultACRValues"),fieldId:"defaultACRValues",labelIcon:e(I,{helpText:"clients-help:defaultACRValues",fieldLabelId:"clients:defaultACRValues"}),children:e(Kn,{id:"defaultACRValues",name:D("attributes.default.acr.values"),stringify:!0})})]}),r(ve,{children:[e(_,{variant:"secondary",onClick:t,"data-testid":"OIDCAdvancedSave",children:s("common:save")}),e(_,{variant:"link",onClick:i,"data-testid":"OIDCAdvancedRevert",children:s("common:revert")})]})]})},hs=({protocol:t,save:i,reset:a,hasConfigureAccess:n})=>{const{adminClient:s}=se(),{t:o}=E("clients"),[l,c]=u.exports.useState([]),[m,g]=u.exports.useState(!1),[h,f]=u.exports.useState(!1),{control:p}=Y();return ce(()=>s.authenticationManagement.getFlows(),d=>{let T=[...d.filter(S=>S.providerId!=="client-flow")];T=wn(T,[S=>S.alias]),c([e(z,{value:"",children:o("common:choose")},"empty"),...T.map(S=>e(z,{value:S.id,children:S.alias},S.id))])},[]),r(de,{role:"manage-clients",fineGrainedAccess:n,isHorizontal:!0,children:[e(v,{label:o("browserFlow"),fieldId:"browserFlow",labelIcon:e(I,{helpText:"clients-help:browserFlow",fieldLabelId:"clients:browserFlow"}),children:e(K,{name:"authenticationFlowBindingOverrides.browser",defaultValue:"",control:p,render:({field:d})=>e(W,{toggleId:"browserFlow",variant:H.single,onToggle:g,isOpen:m,onSelect:(T,S)=>{d.onChange(S),g(!1)},selections:[d.value],children:l})})}),t==="openid-connect"&&e(v,{label:o("directGrant"),fieldId:"directGrant",labelIcon:e(I,{helpText:"clients-help:directGrant",fieldLabelId:"clients:directGrant"}),children:e(K,{name:"authenticationFlowBindingOverrides.direct_grant",defaultValue:"",control:p,render:({field:d})=>e(W,{toggleId:"directGrant",variant:H.single,onToggle:f,isOpen:h,onSelect:(T,S)=>{d.onChange(S),f(!1)},selections:[d.value],children:l})})}),r(ve,{children:[e(_,{variant:"secondary",onClick:i,"data-testid":"OIDCAuthFlowOverrideSave",children:o("common:save")}),e(_,{variant:"link",onClick:a,"data-testid":"OIDCAuthFlowOverrideRevert",children:o("common:revert")})]})]})},gs=({clientId:t,isOpen:i,onAdded:a,onClose:n})=>{const{t:s}=E("clients"),{register:o,handleSubmit:l,formState:{isDirty:c,isValid:m}}=Pe(),{adminClient:g}=se(),{addAlert:h,addError:f}=pe();async function p({node:d}){try{await g.clients.addClusterNode({id:t,node:d}),a(d),h(s("addedNodeSuccess"),te.success)}catch(T){f("clients:addedNodeFail",T)}n()}return e(ze,{title:s("addNode"),isOpen:i,onClose:n,variant:"small",actions:[e(_,{id:"add-node-confirm",type:"submit",form:"add-host-form",isDisabled:!c||!m,children:s("common:save")},"confirm"),e(_,{id:"add-node-cancel",variant:Ce.link,onClick:n,children:s("common:cancel")},"cancel")],children:e(Re,{id:"add-host-form",onSubmit:l(p),isHorizontal:!0,children:e(v,{label:s("nodeHost"),fieldId:"nodeHost",isRequired:!0,children:e(ee,{id:"nodeHost",...o("node",{required:!0}),isRequired:!0})})})})},fs=({save:t,client:{id:i,registeredNodes:a,access:n}})=>{const{t:s}=E("clients"),{control:o}=Y(),{adminClient:l}=se(),{addAlert:c,addError:m}=pe(),g=Jt(),[h,f]=u.exports.useState(a||{}),[p,d]=u.exports.useState(!1),[T,S]=u.exports.useState(""),[y,k]=u.exports.useState(!1),[R,G]=u.exports.useState(0),x=()=>G(new Date().getTime()),X=async()=>{const F=await l.clients.testNodesAvailable({id:i});ei(F,"testCluster",c,s)},[J,N]=xe({titleKey:"clients:deleteNode",messageKey:s("deleteNodeBody",{node:T}),continueButtonLabel:"common:delete",continueButtonVariant:Ce.danger,onConfirm:async()=>{try{await l.clients.deleteClusterNode({id:i,node:T}),f({...Object.keys(h).reduce((F,U)=>(U!==T&&(F[U]=h[U]),F),{})}),x(),c(s("deleteNodeSuccess"),te.success)}catch(F){m("clients:deleteNodeFail",F)}}});return r(V,{children:[e(de,{role:"manage-clients",fineGrainedAccess:n?.configure,isHorizontal:!0,children:e(v,{label:s("nodeReRegistrationTimeout"),fieldId:"kc-node-reregistration-timeout",labelIcon:e(I,{helpText:"clients-help:nodeReRegistrationTimeout",fieldLabelId:"clients:nodeReRegistrationTimeout"}),children:r(tt,{hasGutter:!0,children:[e(ke,{children:e(K,{name:"nodeReRegistrationTimeout",defaultValue:"",control:o,render:({field:F})=>e(Wt,{value:F.value,onChange:F.onChange})})}),e(ke,{children:e(_,{variant:Ce.secondary,onClick:()=>t(),children:s("common:save")})})]})})}),r(V,{children:[e(N,{}),e(gs,{clientId:i,isOpen:y,onAdded:F=>{h[F]=Date.now()/1e3,x()},onClose:()=>k(!1)}),e(Fn,{toggleText:s("registeredClusterNodes"),onToggle:d,isExpanded:p,children:e(kt,{ariaLabelKey:"registeredClusterNodes",loader:()=>Promise.resolve(Object.entries(h||{}).map(F=>({host:F[0],registration:F[1]}))),toolbarItem:r(V,{children:[e(Se,{children:e(_,{id:"testClusterAvailability",onClick:X,variant:Ce.secondary,isDisabled:Object.keys(h).length===0,children:s("testClusterAvailability")})}),e(Se,{children:e(_,{id:"registerNodeManually",onClick:()=>k(!0),variant:Ce.tertiary,children:s("registerNodeManually")})})]}),actions:[{title:s("common:delete"),onRowClick:F=>{S(F.host),J()}}],columns:[{name:"host",displayKey:"clients:nodeHost"},{name:"registration",displayKey:"clients:lastRegistration",cellFormatters:[F=>F?g(new Date(parseInt(F.toString())*1e3),Mn):""]}],emptyState:e(Ee,{message:s("noNodes"),instructions:s("noNodesInstructions"),primaryActionText:s("registerNodeManually"),onPrimaryAction:()=>k(!0)})},R)})]})]})},Zn=()=>{const{t}=E("clients"),{register:i}=Y();return r(V,{children:[e(v,{label:t("logoUrl"),fieldId:"logoUrl",labelIcon:e(I,{helpText:"clients-help:logoUrl",fieldLabelId:"clients:logoUrl"}),children:e(ee,{id:"logoUrl",type:"url","data-testid":"logoUrl",...i(D("attributes.logoUri"))})}),e(v,{label:t("policyUrl"),fieldId:"policyUrl",labelIcon:e(I,{helpText:"clients-help:policyUrl",fieldLabelId:"clients:policyUrl"}),children:e(ee,{id:"policyUrl","data-testid":"policyUrl",type:"url",...i(D("attributes.policyUri"))})}),e(v,{label:t("termsOfServiceUrl"),fieldId:"termsOfServiceUrl",labelIcon:e(I,{helpText:"clients-help:termsOfServiceUrl",fieldLabelId:"clients:termsOfServiceUrl"}),children:e(ee,{id:"termsOfServiceUrl",type:"url","data-testid":"termsOfServiceUrl",...i(D("attributes.tosUri"))})})]})},bs=({save:t,reset:i,hasConfigureAccess:a})=>{const{t:n}=E("clients"),s=Be().providers,o=s?.clientSignature.providers,l=s?.contentencryption.providers,c=s?.cekmanagement.providers,m=s?.signature.providers,[g,h]=u.exports.useState(!1),[f,p]=u.exports.useState(!1),[d,T]=u.exports.useState(!1),[S,y]=u.exports.useState(!1),[k,R]=u.exports.useState(!1),[G,x]=u.exports.useState(!1),[X,J]=u.exports.useState(!1),[N,F]=u.exports.useState(!1),[U,q]=u.exports.useState(!1),[A,C]=u.exports.useState(!1),[b,B]=u.exports.useState(!1),[L,O]=u.exports.useState(!1),{control:P}=Y(),$=[e(z,{value:"",children:n("common:choose")},"empty"),..._e(o).map(w=>e(z,{value:w},w))],Q=[e(z,{value:"",children:n("common:choose")},"empty"),..._e(c).map(w=>e(z,{value:w},w))],ne=[e(z,{value:"",children:n("unsigned")},"unsigned"),..._e(m).map(w=>e(z,{value:w},w))],ie=[e(z,{value:"",children:n("common:choose")},"empty"),..._e(l).map(w=>e(z,{value:w},w))],we=[e(z,{value:"any",children:n("common:any")},"any"),e(z,{value:"none",children:n("common:none")},"none"),..._e(o).map(w=>e(z,{value:w},w))],lt=[e(z,{value:"any",children:n("common:any")},"any"),..._e(c).map(w=>e(z,{value:w},w))],rt=[e(z,{value:"any",children:n("common:any")},"any"),..._e(l).map(w=>e(z,{value:w},w))],Je=[e(z,{value:"",children:n("common:choose")},"empty"),..._e(m).map(w=>e(z,{value:w},w))],ct=["not required","request or request_uri","request only","request_uri only"].map(w=>e(z,{value:w,children:n(`requestObject.${w}`)},w));return r(de,{role:"manage-clients",fineGrainedAccess:a,isHorizontal:!0,children:[e(Zn,{}),e(v,{label:n("accessTokenSignatureAlgorithm"),fieldId:"accessTokenSignatureAlgorithm",labelIcon:e(I,{helpText:"clients-help:accessTokenSignatureAlgorithm",fieldLabelId:"clients:accessTokenSignatureAlgorithm"}),children:e(K,{name:D("attributes.access.token.signed.response.alg"),defaultValue:"",control:P,render:({field:w})=>e(W,{toggleId:"accessTokenSignatureAlgorithm",variant:H.single,onToggle:h,isOpen:g,onSelect:(me,Z)=>{w.onChange(Z),h(!1)},selections:w.value,children:$})})}),e(v,{label:n("idTokenSignatureAlgorithm"),fieldId:"kc-id-token-signature",labelIcon:e(I,{helpText:"clients-help:idTokenSignatureAlgorithm",fieldLabelId:"clients:idTokenSignatureAlgorithm"}),children:e(K,{name:D("attributes.id.token.signed.response.alg"),defaultValue:"",control:P,render:({field:w})=>e(W,{toggleId:"idTokenSignatureAlgorithm",variant:H.single,onToggle:p,isOpen:f,onSelect:(me,Z)=>{w.onChange(Z),p(!1)},selections:w.value,children:$})})}),e(v,{label:n("idTokenEncryptionKeyManagementAlgorithm"),fieldId:"idTokenEncryptionKeyManagementAlgorithm",labelIcon:e(I,{helpText:"clients-help:idTokenEncryptionKeyManagementAlgorithm",fieldLabelId:"clients:idTokenEncryptionKeyManagementAlgorithm"}),children:e(K,{name:D("attributes.id.token.encrypted.response.alg"),defaultValue:"",control:P,render:({field:w})=>e(W,{toggleId:"idTokenEncryptionKeyManagementAlgorithm",variant:H.single,onToggle:T,isOpen:d,onSelect:(me,Z)=>{w.onChange(Z),T(!1)},selections:w.value,children:Q})})}),e(v,{label:n("idTokenEncryptionContentEncryptionAlgorithm"),fieldId:"idTokenEncryptionContentEncryptionAlgorithm",labelIcon:e(I,{helpText:"clients-help:idTokenEncryptionContentEncryptionAlgorithm",fieldLabelId:"clients:idTokenEncryptionContentEncryptionAlgorithm"}),children:e(K,{name:D("attributes.id.token.encrypted.response.enc"),defaultValue:"",control:P,render:({field:w})=>e(W,{toggleId:"idTokenEncryptionContentEncryptionAlgorithm",variant:H.single,onToggle:y,isOpen:S,onSelect:(me,Z)=>{w.onChange(Z),y(!1)},selections:w.value,children:ie})})}),e(v,{label:n("userInfoSignedResponseAlgorithm"),fieldId:"userInfoSignedResponseAlgorithm",labelIcon:e(I,{helpText:"clients-help:userInfoSignedResponseAlgorithm",fieldLabelId:"clients:userInfoSignedResponseAlgorithm"}),children:e(K,{name:D("attributes.user.info.response.signature.alg"),defaultValue:"",control:P,render:({field:w})=>e(W,{toggleId:"userInfoSignedResponseAlgorithm",variant:H.single,onToggle:R,isOpen:k,onSelect:(me,Z)=>{w.onChange(Z),R(!1)},selections:w.value,children:ne})})}),e(v,{label:n("requestObjectSignatureAlgorithm"),fieldId:"requestObjectSignatureAlgorithm",labelIcon:e(I,{helpText:"clients-help:requestObjectSignatureAlgorithm",fieldLabelId:"clients:requestObjectSignatureAlgorithm"}),children:e(K,{name:D("attributes.request.object.signature.alg"),defaultValue:"",control:P,render:({field:w})=>e(W,{toggleId:"requestObjectSignatureAlgorithm",variant:H.single,onToggle:x,isOpen:G,onSelect:(me,Z)=>{w.onChange(Z),x(!1)},selections:w.value,children:we})})}),e(v,{label:n("requestObjectEncryption"),fieldId:"requestObjectEncryption",labelIcon:e(I,{helpText:"clients-help:requestObjectEncryption",fieldLabelId:"clients:requestObjectEncryption"}),children:e(K,{name:D("attributes.request.object.encryption.alg"),defaultValue:"",control:P,render:({field:w})=>e(W,{toggleId:"requestObjectEncryption",variant:H.single,onToggle:F,isOpen:N,onSelect:(me,Z)=>{w.onChange(Z),F(!1)},selections:w.value,children:lt})})}),e(v,{label:n("requestObjectEncoding"),fieldId:"requestObjectEncoding",labelIcon:e(I,{helpText:"clients-help:requestObjectEncoding",fieldLabelId:"clients:requestObjectEncoding"}),children:e(K,{name:D("attributes.request.object.encryption.enc"),defaultValue:"",control:P,render:({field:w})=>e(W,{toggleId:"requestObjectEncoding",variant:H.single,onToggle:q,isOpen:U,onSelect:(me,Z)=>{w.onChange(Z),q(!1)},selections:w.value,children:rt})})}),e(v,{label:n("requestObjectRequired"),fieldId:"requestObjectRequired",labelIcon:e(I,{helpText:"clients-help:requestObjectRequired",fieldLabelId:"clients:requestObjectRequired"}),children:e(K,{name:D("attributes.request.object.required"),defaultValue:"",control:P,render:({field:w})=>e(W,{toggleId:"requestObjectRequired",variant:H.single,onToggle:J,isOpen:X,onSelect:(me,Z)=>{w.onChange(Z),J(!1)},selections:w.value,children:ct})})}),e(v,{label:n("validRequestURIs"),fieldId:"validRequestURIs",labelIcon:e(I,{helpText:"clients-help:validRequestURIs",fieldLabelId:"clients:validRequestURIs"}),children:e(Kn,{name:D("attributes.request.uris"),"aria-label":n("validRequestURIs"),addButtonLabel:"clients:addRequestUri",stringify:!0})}),e(v,{label:n("authorizationSignedResponseAlg"),fieldId:"authorizationSignedResponseAlg",labelIcon:e(I,{helpText:"clients-help:authorizationSignedResponseAlg",fieldLabelId:"clients:authorizationSignedResponseAlg"}),children:e(K,{name:D("attributes.authorization.signed.response.alg"),defaultValue:"",control:P,render:({field:w})=>e(W,{toggleId:"authorizationSignedResponseAlg",variant:H.single,onToggle:C,isOpen:A,onSelect:(me,Z)=>{w.onChange(Z),C(!1)},selections:w.value,children:Je})})}),e(v,{label:n("authorizationEncryptedResponseAlg"),fieldId:"authorizationEncryptedResponseAlg",labelIcon:e(I,{helpText:"clients-help:authorizationEncryptedResponseAlg",fieldLabelId:"clients:authorizationEncryptedResponseAlg"}),children:e(K,{name:D("attributes.authorization.encrypted.response.alg"),defaultValue:"",control:P,render:({field:w})=>e(W,{toggleId:"authorizationEncryptedResponseAlg",variant:H.single,onToggle:B,isOpen:b,onSelect:(me,Z)=>{w.onChange(Z),B(!1)},selections:w.value,children:Q})})}),e(v,{label:n("authorizationEncryptedResponseEnc"),fieldId:"authorizationEncryptedResponseEnc",labelIcon:e(I,{helpText:"clients-help:authorizationEncryptedResponseEnc",fieldLabelId:"clients:authorizationEncryptedResponseEnc"}),children:e(K,{name:D("attributes.authorization.encrypted.response.enc"),defaultValue:"",control:P,render:({field:w})=>e(W,{toggleId:"authorizationEncryptedResponseEnc",variant:H.single,onToggle:O,isOpen:L,onSelect:(me,Z)=>{w.onChange(Z),O(!1)},selections:w.value,children:ie})})}),r(ve,{children:[e(_,{variant:"secondary",id:"fineGrainSave",onClick:t,children:n("common:save")}),e(_,{id:"fineGrainRevert",variant:"link",onClick:i,children:n("common:revert")})]})]})},ys=({save:t,reset:i})=>{const{t:a}=E("clients"),{register:n}=Y();return r(de,{role:"manage-realm",isHorizontal:!0,children:[e(Zn,{}),e(v,{label:a("assertionConsumerServicePostBindingURL"),fieldId:"assertionConsumerServicePostBindingURL",labelIcon:e(I,{helpText:"clients-help:assertionConsumerServicePostBindingURL",fieldLabelId:"clients:assertionConsumerServicePostBindingURL"}),children:e(ee,{id:"assertionConsumerServicePostBindingURL",type:"url",...n("attributes.saml_assertion_consumer_url_post")})}),e(v,{label:a("assertionConsumerServiceRedirectBindingURL"),fieldId:"assertionConsumerServiceRedirectBindingURL",labelIcon:e(I,{helpText:"clients-help:assertionConsumerServiceRedirectBindingURL",fieldLabelId:"clients:assertionConsumerServiceRedirectBindingURL"}),children:e(ee,{id:"assertionConsumerServiceRedirectBindingURL",type:"url",...n("attributes.saml_assertion_consumer_url_redirect")})}),e(v,{label:a("logoutServicePostBindingURL"),fieldId:"logoutServicePostBindingURL",labelIcon:e(I,{helpText:"clients-help:logoutServicePostBindingURL",fieldLabelId:"clients:logoutServicePostBindingURL"}),children:e(ee,{id:"logoutServicePostBindingURL",type:"url",...n("attributes.saml_single_logout_service_url_post")})}),e(v,{label:a("logoutServiceRedirectBindingURL"),fieldId:"logoutServiceRedirectBindingURL",labelIcon:e(I,{helpText:"clients-help:logoutServiceRedirectBindingURL",fieldLabelId:"clients:logoutServiceRedirectBindingURL"}),children:e(ee,{id:"logoutServiceRedirectBindingURL",type:"url",...n("attributes.saml_single_logout_service_url_redirect")})}),e(v,{label:a("logoutServiceArtifactBindingUrl"),fieldId:"logoutServiceArtifactBindingUrl",labelIcon:e(I,{helpText:"clients-help:logoutServiceArtifactBindingUrl",fieldLabelId:"clients:logoutServiceArtifactBindingUrl"}),children:e(ee,{id:"logoutServiceArtifactBindingUrl",type:"url",...n("attributes.saml_single_logout_service_url_artifact")})}),e(v,{label:a("artifactBindingUrl"),fieldId:"artifactBindingUrl",labelIcon:e(I,{helpText:"clients-help:artifactBindingUrl",fieldLabelId:"clients:artifactBindingUrl"}),children:e(ee,{id:"artifactBindingUrl",type:"url",...n("attributes.saml_artifact_binding_url")})}),e(v,{label:a("artifactResolutionService"),fieldId:"artifactResolutionService",labelIcon:e(I,{helpText:"clients-help:artifactResolutionService",fieldLabelId:"clients:artifactResolutionService"}),children:e(ee,{id:"artifactResolutionService",type:"url",...n("attributes.saml_artifact_resolution_service_url")})}),r(ve,{children:[e(_,{variant:"tertiary",onClick:t,children:a("common:save")}),e(_,{variant:"link",onClick:i,children:a("common:revert")})]})]})},Ss=({save:t,reset:i,hasConfigureAccess:a})=>{const{t:n}=E("clients"),{control:s}=Y();return r(de,{role:"manage-realm",fineGrainedAccess:a,isHorizontal:!0,children:[e(v,{label:n("excludeSessionStateFromAuthenticationResponse"),fieldId:"excludeSessionStateFromAuthenticationResponse",hasNoPaddingTop:!0,labelIcon:e(I,{helpText:"clients-help:excludeSessionStateFromAuthenticationResponse",fieldLabelId:"clients:excludeSessionStateFromAuthenticationResponse"}),children:e(K,{name:D("attributes.exclude.session.state.from.auth.response"),defaultValue:"",control:s,render:({field:o})=>e(ue,{id:"excludeSessionStateFromAuthenticationResponse-switch",label:n("common:on"),labelOff:n("common:off"),isChecked:o.value==="true",onChange:l=>o.onChange(l.toString()),"aria-label":n("excludeSessionStateFromAuthenticationResponse")})})}),e(v,{label:n("useRefreshTokens"),fieldId:"useRefreshTokens",hasNoPaddingTop:!0,labelIcon:e(I,{helpText:"clients-help:useRefreshTokens",fieldLabelId:"clients:useRefreshTokens"}),children:e(K,{name:D("attributes.use.refresh.tokens"),defaultValue:"true",control:s,render:({field:o})=>e(ue,{id:"useRefreshTokens",label:n("common:on"),labelOff:n("common:off"),isChecked:o.value==="true",onChange:l=>o.onChange(l.toString()),"aria-label":n("useRefreshTokens")})})}),e(v,{label:n("useRefreshTokenForClientCredentialsGrant"),fieldId:"useRefreshTokenForClientCredentialsGrant",hasNoPaddingTop:!0,labelIcon:e(I,{helpText:"clients-help:useRefreshTokenForClientCredentialsGrant",fieldLabelId:"clients:useRefreshTokenForClientCredentialsGrant"}),children:e(K,{name:D("attributes.client_credentials.use_refresh_token"),defaultValue:"false",control:s,render:({field:o})=>e(ue,{id:"useRefreshTokenForClientCredentialsGrant",label:n("common:on"),labelOff:n("common:off"),isChecked:o.value==="true",onChange:l=>o.onChange(l.toString()),"aria-label":n("useRefreshTokenForClientCredentialsGrant")})})}),e(v,{label:n("useLowerCaseBearerType"),fieldId:"useLowerCaseBearerType",hasNoPaddingTop:!0,labelIcon:e(I,{helpText:"clients-help:useLowerCaseBearerType",fieldLabelId:"clients:useLowerCaseBearerType"}),children:e(K,{name:D("attributes.token.response.type.bearer.lower-case"),defaultValue:"false",control:s,render:({field:o})=>e(ue,{id:"useLowerCaseBearerType",label:n("common:on"),labelOff:n("common:off"),isChecked:o.value==="true",onChange:l=>o.onChange(l.toString()),"aria-label":n("useLowerCaseBearerType")})})}),r(ve,{children:[e(_,{variant:"secondary",onClick:t,"data-testid":"OIDCCompatabilitySave",children:n("common:save")}),e(_,{variant:"link",onClick:i,"data-testid":"OIDCCompatabilityRevert",children:n("common:revert")})]})]})},vs=({save:t,client:{id:i,adminUrl:a,access:n}})=>{const s="notBefore",o=u.exports.useRef(),{t:l}=E("clients"),{adminClient:c}=se(),{realm:m}=ge(),{addAlert:g}=pe(),h=Jt(),{getValues:f,setValue:p,register:d}=Y(),T=(k,R)=>{p(s,k),t({messageKey:R})};u.exports.useEffect(()=>{d(s)},[d]);const S=()=>{const k=f(s);return k>0?h(new Date(k*1e3),Mn):l("common:none")},y=async()=>{const k=await c.clients.pushRevocation({id:i});ei(k,"notBeforePush",g,l)};return r(V,{children:[e(he,{className:"pf-u-pb-lg",children:r(Bn,{i18nKey:"clients-help:notBeforeIntro",children:["In order to successfully push setup url on",e(ye,{to:On({realm:m,clientId:i,tab:"settings"}),children:l("settings")}),"tab"]})}),r(de,{role:"manage-clients",fineGrainedAccess:n?.configure,isHorizontal:!0,children:[e(v,{label:l("notBefore"),fieldId:"kc-not-before",labelIcon:e(I,{helpText:"clients-help:notBefore",fieldLabelId:"clients:notBefore"}),children:r(Ut,{children:[e(ee,{type:"text",id:"kc-not-before",name:"notBefore",isReadOnly:!0,value:S()}),e(_,{id:"setToNow",variant:"control",onClick:()=>{T(Date.now()/1e3,"notBeforeSetToNow")},children:l("setToNow")}),e(_,{id:"clear",variant:"control",onClick:()=>{T(0,"notBeforeNowClear")},children:l("clear")})]})}),r(ve,{children:[!a&&e(Vt,{reference:o,content:l("clients-help:notBeforeTooltip")}),e(_,{id:"push",variant:"secondary",onClick:y,isAriaDisabled:!a,ref:o,children:l("push")})]})]})]})},ei=(t,i,a,n)=>{const s=t.successRequests?.length||0,o=t.failedRequests?.length||0;s===0&&o===0?a(n("noAdminUrlSet"),te.warning):o>0?(a(n(i+"Success",{successNodes:t.successRequests}),te.success),a(n(i+"Fail",{failedNodes:t.failedRequests}),te.danger)):a(n(i+"Success",{successNodes:t.successRequests}),te.success)},Cs=({save:t,client:i})=>{const{t:a}=E("clients"),n="openid-connect",{setValue:s}=Y(),{publicClient:o,attributes:l,protocol:c,authenticationFlowBindingOverrides:m}=i,g=h=>{for(const f of h)s(D(`attributes.${f}`),l?.[f]||"")};return e(fe,{variant:"light",className:"pf-u-py-0",children:e(Nn,{sections:[{title:a("revocation"),isHidden:c!==n,panel:e(vs,{client:i,save:t})},{title:a("clustering"),isHidden:!o,panel:e(fs,{client:i,save:t})},{title:a("fineGrainOpenIdConnectConfiguration"),isHidden:c!==n,panel:r(V,{children:[e(he,{className:"pf-u-pb-lg",children:a("clients-help:fineGrainOpenIdConnectConfiguration")}),e(bs,{save:t,reset:()=>{g(["logoUri","policyUri","tosUri","access.token.signed.response.alg","id.token.signed.response.alg","id.token.encrypted.response.alg","id.token.encrypted.response.enc","user.info.response.signature.alg","request.object.signature.alg","request.object.encryption.alg","request.object.encryption.enc","request.object.required","request.uris","authorization.encrypted.response.alg","authorization.encrypted.response.enc"])}})]})},{title:a("openIdConnectCompatibilityModes"),isHidden:c!==n,panel:r(V,{children:[e(he,{className:"pf-u-pb-lg",children:a("clients-help:openIdConnectCompatibilityModes")}),e(Ss,{save:()=>t(),reset:()=>g(["exclude.session.state.from.auth.response"])})]})},{title:a("fineGrainSamlEndpointConfig"),isHidden:c===n,panel:r(V,{children:[e(he,{className:"pf-u-pb-lg",children:a("clients-help:fineGrainSamlEndpointConfig")}),e(ys,{save:()=>t(),reset:()=>g(["logoUri","policyUri","tosUri","saml_assertion_consumer_url_post","saml_assertion_consumer_url_redirect","saml_single_logout_service_url_post","saml_single_logout_service_url_redirect","saml_single_logout_service_url_artifact","saml_artifact_binding_url","saml_artifact_resolution_service_url"])})]})},{title:a("advancedSettings"),panel:r(V,{children:[e(he,{className:"pf-u-pb-lg",children:a("clients-help:advancedSettings"+Ct(c||""))}),e(ms,{protocol:c,save:()=>t(),reset:()=>{g(["saml.assertion.lifespan","access.token.lifespan","tls.client.certificate.bound.access.tokens","pkce.code.challenge.method"])}})]})},{title:a("authenticationOverrides"),panel:r(V,{children:[e(he,{className:"pf-u-pb-lg",children:a("clients-help:authenticationOverrides")}),e(hs,{protocol:c,save:()=>t(),reset:()=>{s("authenticationFlowBindingOverrides.browser",m?.browser),s("authenticationFlowBindingOverrides.direct_grant",m?.direct_grant)}})]})}],borders:!0})})},Ts=({idx:t,rowIndex:i,outerPolicy:a,resource:n})=>{const[s,o]=u.exports.useState(!1),{t:l}=E("clients"),{realm:c}=ge(),{clientId:m}=$t();return r(Ue,{isExpanded:s,children:[r(re,{children:[e(M,{expand:{rowIndex:i,isExpanded:s,onToggle:()=>o(g=>!g)}}),e(M,{"data-testid":`name-column-${n.resource}`,children:e(ye,{to:gt({realm:c,id:m,permissionType:a.policy?.type,permissionId:a.policy?.id}),children:a.policy?.name})}),e(M,{id:a.status?.toLowerCase(),children:l(a.status?.toLowerCase())}),e(M,{children:l(`${a.policy?.decisionStrategy?.toLowerCase()}`)}),e(M,{children:a.status===on.Permit?n.policies?.[i]?.scopes?.join(", "):"-"}),e(M,{children:a.status===on.Deny&&n.policies?.[i]?.scopes?.length?n.policies[i].scopes?.join(", "):"-"})]}),r(re,{isExpanded:s,children:[e(M,{}),e(M,{colSpan:5,children:s&&e(at,{children:e(ot,{isHorizontal:!0,className:"keycloak_resource_details",children:e(De,{children:e(Yn,{children:a.associatedPolicies?.map(g=>r(Xn,{children:[e(ye,{to:qt({realm:c,id:m,policyType:g.policy?.type,policyId:g.policy?.id}),children:g.policy?.name}),l("votedToStatus",{status:ci(g.status)})]},"policyDetails"))})})})})})]},`child-${n.resource}`)]},t)},Is=({rowIndex:t,resource:i,evaluateResults:a})=>{const[n,s]=u.exports.useState(!1),{t:o}=E("clients");return r(Ue,{isExpanded:n,children:[r(re,{children:[e(M,{expand:{rowIndex:t,isExpanded:n,onToggle:()=>s(l=>!l)}}),e(M,{"data-testid":`name-column-${i.resource}`,children:i.resource?.name}),e(M,{id:i.status?.toLowerCase(),children:o(`${i.status?.toLowerCase()}`)}),e(M,{children:i.allowedScopes?.length?i.allowedScopes.map(l=>l.name):"-"})]}),r(re,{isExpanded:n,children:[e(M,{}),e(M,{colSpan:5,children:e(at,{children:n&&e(ot,{isHorizontal:!0,className:"keycloak_resource_details",children:r(Ve,{"aria-label":o("evaluationResults"),children:[e(qe,{children:r(re,{children:[e(j,{}),e(j,{children:o("permission")}),e(j,{children:o("results")}),e(j,{children:o("decisionStrategy")}),e(j,{children:o("grantedScopes")}),e(j,{children:o("deniedScopes")}),e(j,{})]})}),Object.values(a[t].policies).map((l,c)=>e(Ts,{idx:c,rowIndex:t,outerPolicy:l,resource:i},c))]})})})})]},`child-${i.resource}`)]})},ks=({data:t})=>{const{t:i}=E("clients"),[a,n]=Te();return r(V,{children:[e(_,{"data-testid":"authorization-revert",onClick:n,variant:"secondary",children:i("showAuthData")}),e(ze,{variant:st.medium,isOpen:a,"aria-label":i("authData"),header:r(De,{children:[e(he,{component:zn.h1,children:i("authData")}),e(he,{children:i("authDataDescription")})]}),onClose:n,actions:[e(_,{"data-testid":"cancel",id:"modal-cancel",onClick:n,children:i("common:cancel")},"cancel")],children:e(it,{readOnly:!0,rows:20,value:Qe(t)})})]})};function xs(t,i){switch(i){case"STATUS_PERMITTED":return t.filter(({status:a})=>a==="PERMIT");case"STATUS_DENIED":return t.filter(({status:a})=>a==="DENY");default:return t}}const Rs=({evaluateResult:t,refresh:i,back:a})=>{const{t:n}=E("clients"),[s,o]=Te(),[l,c]=u.exports.useState("ALL"),[m,g]=u.exports.useState(""),[h,f]=u.exports.useState(""),p=()=>{g(h)},d=k=>{k.key==="Enter"&&p()},T=u.exports.useMemo(()=>xs(t.results,l).filter(({resource:k})=>k?.name?.includes(m)??!1),[t.results,l,m]),S=t.results.length===0,y=T.length===0;return r(fe,{children:[e(Ri,{children:r(Ai,{className:"providers-toolbar",children:[e(Se,{children:r(Ut,{children:[e(di,{name:"inputGroupName",id:"inputGroupName",type:"search","aria-label":n("common:search"),placeholder:n("common:search"),onChange:f,onKeyDown:d}),e(_,{variant:Ce.control,"aria-label":n("common:search"),onClick:()=>p(),children:e(ui,{})})]})}),e(Se,{children:r(W,{width:300,"data-testid":"filter-type-select",isOpen:s,className:"kc-filter-type-select",variant:H.single,onToggle:o,onSelect:(k,R)=>{c(R),o(),i()},selections:l,children:[e(z,{"data-testid":"all-results-option",value:"ALL",isPlaceholder:!0,children:n("allResults")}),e(z,{"data-testid":"result-permit-option",value:"STATUS_PERMITTED",children:n("resultPermit")}),e(z,{"data-testid":"result-deny-option",value:"STATUS_DENIED",children:n("resultDeny")})]})})]})}),!y&&r(Ve,{"aria-label":n("evaluationResults"),children:[e(qe,{children:r(re,{children:[e(j,{}),e(j,{children:n("resource")}),e(j,{children:n("overallResults")}),e(j,{children:n("scopes")}),e(j,{})]})}),T.map((k,R)=>e(Is,{rowIndex:R,resource:k,evaluateResults:t.results},R))]}),(y||S)&&r(V,{children:[e(Ge,{}),e(Ee,{isSearchVariant:!0,message:n("common:noSearchResults"),instructions:n("common:noSearchResultsInstructions")})]}),r(ve,{className:"kc-evaluated-options",children:[e(_,{"data-testid":"authorization-eval",id:"back-btn",onClick:a,children:n("common:back")}),e(_,{"data-testid":"authorization-reevaluate",id:"reevaluate-btn",variant:"secondary",onClick:i,children:n("clients:reevaluate")}),e(ks,{data:t.rpt})]})]})};const As=({name:t,rowIndex:i,attribute:a,selectableValues:n,resources:s})=>{const{t:o}=E("common"),{control:l,register:c,getValues:m}=Y(),[g,h]=u.exports.useState([!1]),f=(S,y)=>{const k=[...g];k[S]=y,h(k)},p=u.exports.useMemo(()=>{let S=[];return n&&(S=Vn.find(y=>y.key===m().context?.[i]?.key)?.values),S},[m]),d=()=>{const S=s?.find(y=>y.name===m().resources?.[i]?.key)?.scopes;if(p?.length&&!s)return p.map(y=>e(z,{value:y.key,children:y.name},y.key));if(S?.length)return S.map(y=>e(z,{value:y.name,children:y.name},y.name))},T=S=>Vi(S).replace(/\W/g,"");return e(M,{children:s||p?.length?e(K,{name:`${t}[${i}].value`,defaultValue:[],control:l,render:({field:S})=>e(W,{id:`${a.id}-value`,className:"kc-attribute-value-selectable",name:`${t}[${i}].value`,chipGroupProps:{numChips:1,expandedText:o("common:hide"),collapsedText:o("common:showRemaining")},toggleId:`group-${t}`,onToggle:y=>f(i,y),isOpen:g[i],variant:H.typeahead,typeAheadAriaLabel:o("clients:selectOrTypeAKey"),placeholderText:o("clients:selectOrTypeAKey"),selections:S.value,onSelect:(y,k)=>{S.onChange(k),f(i,!1)},children:d()})}):e(ee,{id:`${T(a.key)}-value`,className:"value-input",defaultValue:a.value,"data-testid":"attribute-value-input",...c(`${t}.${i}.value`)})})},gn=({name:t,selectableValues:i,resources:a})=>{const{t:n}=E("common"),{control:s,watch:o}=Y(),{fields:l,append:c,remove:m}=xi({control:s,name:t}),[g,h]=u.exports.useState([!1]),f=(d,T)=>{const S=[...g];S[d]=T,h(S)};u.exports.useEffect(()=>{l.length||c({key:"",value:""},{shouldFocus:!1})},[l]);const p=o(`${t}[${l.length-1}].value`,"");return r(Ve,{className:"kc-attributes__table","aria-label":"Role attribute keys and values",variant:"compact",borders:!1,children:[e(qe,{children:r(re,{children:[e(j,{id:"key",width:40,children:n("key")}),e(j,{id:"value",width:40,children:n("value")})]})}),r(Ue,{children:[l.map((d,T)=>r(re,{"data-testid":"attribute-row",children:[e(M,{children:e(K,{name:`${t}[${T}].key`,defaultValue:"",control:s,render:({field:S})=>e(W,{id:`${t}[${T}].key`,className:"kc-attribute-key-selectable",name:`${t}[${T}].key`,toggleId:`group-${t}`,onToggle:y=>f(T,y),isOpen:g[T],variant:H.typeahead,typeAheadAriaLabel:n("clients:selectOrTypeAKey"),placeholderText:n("clients:selectOrTypeAKey"),selections:S.value,onSelect:(y,k)=>{S.onChange(k.toString()),f(T,!1)},children:i?.map(y=>e(z,{selected:y.name===S.value,value:a?y.name:y.key,children:y.name},y.key))})})}),e(As,{name:t,attribute:d,rowIndex:T,selectableValues:i,resources:a}),e(M,{id:`kc-minus-button-${T}`,children:e(_,{id:`minus-button-${T}`,variant:"link",className:"kc-attributes__minus-icon",onClick:()=>m(T),children:e(qi,{})})},"minus-button")]},d.id)),e(re,{children:e(M,{children:e(_,{"aria-label":n("addAttribute"),id:"plus-icon",variant:"link",className:"kc-attributes__plus-icon",onClick:()=>{c({key:"",value:""}),h([...g,!1])},icon:e(qn,{}),isDisabled:!p,"data-testid":"attribute-add-row",children:n("addAttribute")})})})]})]})};const ws=({client:t})=>{const i=Pe({mode:"onChange"}),{control:a,register:n,reset:s,trigger:o,formState:{isValid:l,errors:c}}=i,{t:m}=E("clients"),{adminClient:g}=se(),h=ge(),[f,p]=u.exports.useState(!1),[d,T]=u.exports.useState(!1),[S,y]=u.exports.useState(!1),[k,R]=u.exports.useState(!1),[G,x]=u.exports.useState([]),[X,J]=u.exports.useState([]),[N,F]=u.exports.useState(),[U,q]=u.exports.useState([]),{hasAccess:A}=We();if(!A("view-users"))return e(pi,{permissionNeeded:"view-users"});ce(()=>g.roles.find(),b=>{q(b)},[]),ce(()=>Promise.all([g.clients.listResources({id:t.id}),g.clients.listAllScopes({id:t.id})]),([b,B])=>{x(b),J(B)},[]);const C=async()=>{if(!await o())return;const b=i.getValues(),B=b.resources?.map(({key:P})=>P),L={roleIds:b.roleIds??[],clientId:b.client.id,userId:b.user[0],resources:b.resources?.filter(P=>B?.includes(P.name)),entitlements:!1,context:{attributes:Object.fromEntries(b.context.attributes.filter(P=>P.key||P.value!=="").map(({key:P,value:$})=>[P,$]))}},O=await g.clients.evaluateResource({id:t.id,realm:h.realm},L);return F(O),O};return N?e(Rs,{evaluateResult:N,refresh:C,back:()=>F(void 0)}):e(fe,{children:r(Ke,{...i,children:[e(Mt,{className:"kc-identity-information",title:m("clients:identityInformation"),children:r(de,{isHorizontal:!0,role:"view-clients",children:[e(Di,{name:"client",label:"client",namespace:"clients",helpText:"clients-help:client",defaultValue:t.clientId}),e(Un,{name:"user",label:"users",helpText:"clients-help:selectUser",defaultValue:"",variant:H.typeahead,isRequired:!0}),e(v,{label:m("roles"),labelIcon:e(I,{helpText:"clients-help:roles",fieldLabelId:"clients:roles"}),fieldId:"realmRole",validated:c.roleIds?"error":"default",helperTextInvalid:m("common:required"),isRequired:!0,children:e(K,{name:"roleIds",control:a,defaultValue:[],rules:{validate:b=>(b||"").length>0},render:({field:b})=>e(W,{placeholderText:m("selectARole"),variant:H.typeaheadMulti,toggleId:"role",onToggle:T,selections:b.value,onSelect:(B,L)=>{const O=L.toString();b.value?.includes(O)?b.onChange(b.value.filter(P=>P!==O)):b.onChange([...b.value||[],O]),T(!1)},onClear:B=>{B.stopPropagation(),b.onChange([])},"aria-label":m("realmRole"),isOpen:d,children:U.map(B=>e(z,{selected:B.name===b.value,value:B.name},B.name))})})})]})}),r(Mt,{className:"kc-permissions",title:m("common:permissions"),children:[r(de,{isHorizontal:!0,role:"view-clients",children:[e(v,{label:m("applyToResourceType"),fieldId:"applyToResourceType",labelIcon:e(I,{helpText:"clients-help:applyToResourceType",fieldLabelId:"clients:applyToResourceType"}),children:e(ue,{id:"applyToResource-switch",label:m("common:on"),labelOff:m("common:off"),isChecked:k,onChange:R,"aria-label":m("applyToResourceType")})}),k?r(V,{children:[e(v,{label:m("resourceType"),isRequired:!0,labelIcon:e(I,{helpText:"clients-help:resourceType",fieldLabelId:"clients:resourceType"}),fieldId:"client",validated:c.alias?"error":"default",helperTextInvalid:m("common:required"),children:e(ee,{id:"alias","data-testid":"alias",...n("alias",{required:!0})})}),e(v,{label:m("authScopes"),labelIcon:e(I,{helpText:"clients-help:scopesSelect",fieldLabelId:"clients:client"}),fieldId:"authScopes",children:e(K,{name:"authScopes",defaultValue:[],control:a,render:({field:b})=>e(W,{toggleId:"authScopes",onToggle:p,onSelect:(B,L)=>{const O=L.toString();b.value.includes(O)?b.onChange(b.value.filter(P=>P!==O)):b.onChange([...b.value,O]),p(!1)},selections:b.value,variant:H.typeaheadMulti,"aria-label":m("authScopes"),isOpen:f,children:X.map(B=>e(z,{selected:b.value.includes(B.name),value:B.name},B.id))})})})]}):e(v,{label:m("resourcesAndAuthScopes"),id:"resourcesAndAuthScopes",isRequired:!0,labelIcon:e(I,{helpText:m("clients-help:contextualAttributes"),fieldLabelId:"resourcesAndAuthScopes"}),helperTextInvalid:m("common:required"),fieldId:"resourcesAndAuthScopes",children:e(gn,{selectableValues:G.map(b=>({name:b.name,key:b._id})),resources:G,name:"resources"})}),e(Fn,{toggleText:m("contextualInfo"),onToggle:()=>y(!S),isExpanded:S,children:e(v,{label:m("contextualAttributes"),id:"contextualAttributes",labelIcon:e(I,{helpText:m("clients-help:contextualAttributes"),fieldLabelId:"contextualAttributes"}),helperTextInvalid:m("common:required"),fieldId:"contextualAttributes",children:e(gn,{selectableValues:Vn,name:"context.attributes"})})})]}),r(ve,{children:[e(_,{"data-testid":"authorization-eval",id:"authorization-eval",className:"pf-u-mr-md",isDisabled:!l,onClick:()=>C(),children:m("evaluate")}),e(_,{"data-testid":"authorization-revert",id:"authorization-revert",className:"pf-u-mr-md",variant:"link",onClick:()=>s(),children:m("common:revert")})]})]})]})})};const Os=()=>{const{t}=E("clients"),{adminClient:i}=se(),{clientId:a}=$t(),{addAlert:n,addError:s}=pe(),[o,l]=u.exports.useState(),[c,m]=u.exports.useState();ce(()=>i.clients.exportResource({id:a}),h=>{l(JSON.stringify(h,null,2)),m(h)},[]);const g=()=>{try{et.exports.saveAs(new Blob([Qe(c)],{type:"application/json"}),"test-authz-config.json"),n(t("exportAuthDetailsSuccess"),te.success)}catch(h){s("exportAuthDetailsError",h)}};return o?e(fe,{children:r(de,{isHorizontal:!0,role:"view-realm",className:"pf-u-mt-lg",children:[e(v,{label:t("authDetails"),labelIcon:e(I,{helpText:"clients-help:authDetails",fieldLabelId:"clients:authDetails"}),fieldId:"client",children:e(it,{id:"authorizationDetails",readOnly:!0,resizeOrientation:"vertical",value:o,"aria-label":t("authDetails")})}),r(ve,{children:[e(_,{"data-testid":"authorization-export-download",onClick:()=>g(),children:t("common:download")}),e(_,{"data-testid":"authorization-export-copy",variant:"secondary",onClick:async()=>{try{await navigator.clipboard.writeText(o),n(t("copied"),te.success)}catch(h){s(t("copyError"),h)}},children:t("copy")})]})]})}):e(Ne,{})};const Qt=({types:t,search:i,onSearch:a,isResource:n=!1})=>{const{t:s}=E("clients"),{register:o,control:l,reset:c,formState:{isDirty:m},handleSubmit:g}=Pe({mode:"onChange"}),[h,f]=Te(),[p,d]=Te(),T=y=>{f(),a(y)};u.exports.useEffect(()=>c(i),[i]);const S=y=>[e(z,{value:"",children:s("allTypes")},"empty"),...(t||[]).map(k=>e(z,{selected:k.type===y,value:k.type,children:k.name},k.type))];return e(jt,{"data-testid":"searchdropdown_dorpdown",className:"pf-u-ml-md",toggle:e(En,{onToggle:f,className:"keycloak__client_authentication__searchdropdown",children:s("searchForPermission")}),isOpen:h,children:r(Re,{isHorizontal:!0,className:"keycloak__client_authentication__searchdropdown_form",onSubmit:g(T),children:[e(v,{label:s("common:name"),fieldId:"name",children:e(ee,{id:"name","data-testid":"searchdropdown_name",...o("name")})}),n&&r(V,{children:[e(v,{label:s("common:type"),fieldId:"type",children:e(ee,{id:"type","data-testid":"searchdropdown_type",...o("type")})}),e(v,{label:s("uris"),fieldId:"uri",children:e(ee,{id:"uri","data-testid":"searchdropdown_uri",...o("uri")})}),e(v,{label:s("owner"),fieldId:"owner",children:e(ee,{id:"owner","data-testid":"searchdropdown_owner",...o("owner")})})]}),!n&&e(v,{label:s("resource"),fieldId:"resource",children:e(ee,{id:"resource","data-testid":"searchdropdown_resource",...o("resource")})}),e(v,{label:s("scope"),fieldId:"scope",children:e(ee,{id:"scope","data-testid":"searchdropdown_scope",...o("scope")})}),!n&&e(v,{label:s("common:type"),fieldId:"type",children:e(K,{name:"type",defaultValue:"",control:l,render:({field:y})=>e(W,{toggleId:"type",onToggle:d,onSelect:(k,R)=>{k.stopPropagation(),y.onChange(R),d()},selections:y.value||s("allTypes"),variant:H.single,"aria-label":s("common:type"),isOpen:p,children:S(y.value)})})}),r(ve,{children:[e(_,{variant:"primary",type:"submit","data-testid":"search-btn",isDisabled:!m,children:s("common:search")}),e(_,{variant:"link","data-testid":"revert-btn",onClick:()=>a({}),children:s("common:clear")})]})]})})},xt=({array:t})=>{const{t:i}=E("clients");return!t||t.length<=1?null:e(Kt,{color:"blue",children:i("common:more",{count:t.length-1})})};function Es(t){return e(He,{...t})}function He({name:t,array:i,convert:a,link:n}){const{t:s}=E("clients");return r(Bi,{children:[e(zi,{children:s(t)}),r(Ui,{children:[i?.map(o=>{const l=typeof o=="string"?o:a(o);return n?e(ye,{to:n(o),className:"pf-u-pr-sm",children:l},l):e("span",{className:"pf-u-pr-sm",children:l},l)}),i?.length===0&&e("i",{children:s("common:none")})]})]})}const fn=({permissionType:t,disabled:i=!1,clientId:a})=>{const{t:n}=E("clients"),{realm:s}=ge(),o=nt();return e(_,{"data-testid":`create-${t}`,className:i?"keycloak__permissions__empty_state ":"pf-u-m-sm",variant:"secondary",onClick:()=>!i&&o(mt({realm:s,id:a,permissionType:t})),children:n(`create${Ct(t)}BasedPermission`)})},bn=({permissionType:t,disabled:i,...a})=>{const{t:n}=E("clients");return i?e(Vt,{content:n(`no${Ct(t)}CreateHint`),children:e(fn,{...a,disabled:i,permissionType:t})}):e(fn,{...a,disabled:i,permissionType:t})},Ps=({clientId:t,isResourceEnabled:i,isScopeEnabled:a})=>{const{t:n}=E("clients");return r(jn,{"data-testid":"empty-state",variant:"large",children:[e(ji,{icon:qn}),e(Ht,{headingLevel:"h1",size:"lg",children:n("emptyPermissions")}),e(Gn,{children:n("emptyPermissionInstructions")}),e(bn,{permissionType:"resource",disabled:i,clientId:t}),e("br",{}),e(bn,{permissionType:"scope",disabled:a,clientId:t})]})};const Ls=({clientId:t})=>{const{t:i}=E("clients"),a=nt(),{adminClient:n}=se(),{addAlert:s,addError:o}=pe(),{realm:l}=ge(),[c,m]=u.exports.useState(),[g,h]=u.exports.useState(),[f,p]=u.exports.useState(),[d,T]=u.exports.useState(),[S,y]=Te(),[k,R]=u.exports.useState({}),[G,x]=u.exports.useState(0),X=()=>x(G+1),[J,N]=u.exports.useState(10),[F,U]=u.exports.useState(0),q=({row:L})=>r(V,{children:[L.associatedPolicies?.[0]?.name," ",e(xt,{array:L.associatedPolicies})]});ce(async()=>{const L=await n.clients.findPermissions({first:F,max:J+1,id:t,...k});return await Promise.all(L.map(async O=>{const P=await n.clients.getAssociatedPolicies({id:t,permissionId:O.id});return{...O,associatedPolicies:P,isExpanded:!1}}))},m,[G,k,F,J]),ce(async()=>{const L={first:0,max:1},[O,P,$]=await Promise.all([n.clients.listPolicyProviders({id:t}),n.clients.listResources({...L,id:t}),n.clients.listAllScopes({...L,id:t})]);return{policies:O.filter(Q=>Q.type==="resource"||Q.type==="scope"),resources:P.length!==1,scopes:$.length!==1}},({policies:L,resources:O,scopes:P})=>{p(L),T({resources:O,scopes:P})},[]);const[A,C]=xe({titleKey:"clients:deletePermission",messageKey:i("deletePermissionConfirm",{permission:g?.name}),continueButtonVariant:Ce.danger,continueButtonLabel:"clients:confirm",onConfirm:async()=>{try{await n.clients.delPermission({id:t,type:g?.type,permissionId:g?.id}),s(i("permissionDeletedSuccess"),te.success),X()}catch(L){o("clients:permissionDeletedError",L)}}});if(!c)return e(Ne,{});const b=c.length===0,B=Object.keys(k).length!==0;return r(fe,{variant:"light",className:"pf-u-p-0",children:[e(C,{}),(!b||B)&&e(It,{count:c.length,first:F,max:J,onNextClick:U,onPreviousClick:U,onPerPageSelect:(L,O)=>{U(L),N(O)},toolbarItem:r(V,{children:[e(Se,{children:e(Qt,{types:f,search:k,onSearch:R})}),e(Se,{children:e(jt,{toggle:e(En,{onToggle:y,isPrimary:!0,"data-testid":"permissionCreateDropdown",children:i("createPermission")}),isOpen:S,dropdownItems:[e(Ye,{"data-testid":"create-resource",isDisabled:d?.resources,component:"button",onClick:()=>a(mt({realm:l,id:t,permissionType:"resource"})),children:i("createResourceBasedPermission")},"createResourceBasedPermission"),e(mi,{},"separator"),r(Ye,{"data-testid":"create-scope",isDisabled:d?.scopes,component:"button",onClick:()=>a(mt({realm:l,id:t,permissionType:"scope"})),children:[i("createScopeBasedPermission"),d?.scopes&&e($e,{className:"pf-u-mt-sm",variant:"warning",isInline:!0,isPlain:!0,title:i("noScopeCreateHint")})]},"createScopeBasedPermission")]})})]}),children:!b&&r(Ve,{"aria-label":i("resources"),variant:"compact",children:[e(qe,{children:r(re,{children:[e(j,{}),e(j,{children:i("common:name")}),e(j,{children:i("common:type")}),e(j,{children:i("associatedPolicy")}),e(j,{children:i("common:description")}),e(j,{})]})}),c.map((L,O)=>r(Ue,{isExpanded:L.isExpanded,children:[r(re,{children:[e(M,{expand:{rowIndex:O,isExpanded:L.isExpanded,onToggle:(P,$)=>{const Q=c.map((ne,ie)=>ie===$?{...ne,isExpanded:!ne.isExpanded}:ne);m(Q)}}}),e(M,{"data-testid":`name-column-${L.name}`,children:e(ye,{to:gt({realm:l,id:t,permissionType:L.type,permissionId:L.id}),children:L.name})}),e(M,{children:f?.find(P=>P.type===L.type)?.name}),e(M,{children:e(q,{row:L})}),e(M,{children:L.description}),e(M,{actions:{items:[{title:i("common:delete"),onClick:async()=>{h(L),A()}}]}})]}),r(re,{isExpanded:L.isExpanded,children:[e(M,{}),e(M,{colSpan:5,children:e(at,{children:L.isExpanded&&e(ot,{isHorizontal:!0,className:"keycloak_resource_details",children:e(He,{name:"associatedPolicy",array:L.associatedPolicies,convert:P=>P.name,link:P=>qt({id:t,realm:l,policyId:P.id,policyType:P.type})})})})})]},`child-${L.id}`)]},L.id))]})}),b&&!B&&e(Ps,{clientId:t,isResourceEnabled:d?.resources,isScopeEnabled:d?.scopes}),b&&B&&e(Ee,{isSearchVariant:!0,message:i("common:noSearchResults"),instructions:i("common:noSearchResultsInstructions")})]})},yn=({policyProviders:t,onSelect:i,toggleDialog:a})=>{const{t:n}=E("clients"),s=Hn(),o=u.exports.useMemo(()=>t?s(t,$n("name")):[],[t]);return e(ze,{"aria-labelledby":n("addPredefinedMappers"),variant:st.medium,header:r(De,{children:[e(he,{component:zn.h1,children:n("chooseAPolicyType")}),e(he,{children:n("chooseAPolicyTypeInstructions")})]}),isOpen:!0,onClose:a,children:r(Ve,{"aria-label":n("policies"),variant:"compact",children:[e(qe,{children:r(re,{children:[e(j,{children:n("common:name")}),e(j,{children:n("common:description")})]})}),e(Ue,{children:o.map(l=>r(re,{"data-testid":l.type,onRowClick:()=>i(l),isHoverable:!0,children:[e(M,{children:l.name}),e(M,{children:Ni(l.type)&&n(`policyProvider.${l.type}`)})]},l.type))})]})})},_s=({clientId:t})=>{const{t:i}=E("clients"),{adminClient:a}=se(),{addAlert:n,addError:s}=pe(),{realm:o}=ge(),l=nt(),[c,m]=u.exports.useState(),[g,h]=u.exports.useState(),[f,p]=u.exports.useState(),[d,T]=u.exports.useState(0),S=()=>T(d+1),[y,k]=u.exports.useState(10),[R,G]=u.exports.useState(0),[x,X]=u.exports.useState({}),[J,N]=Te();ce(async()=>{const b=await a.clients.listPolicies({first:R,max:y+1,id:t,permission:"false",...x});return await Promise.all([a.clients.listPolicyProviders({id:t}),...(b||[]).map(async B=>{const L=await a.clients.listDependentPolicies({id:t,policyId:B.id});return{...B,dependentPolicies:L,isExpanded:!1}})])},([b,...B])=>{p(b.filter(L=>L.type!=="resource"&&L.type!=="scope")),m(B)},[d,x,R,y]);const F=({row:b})=>r(V,{children:[b.dependentPolicies?.[0]?.name," ",e(xt,{array:b.dependentPolicies})]}),[U,q]=xe({titleKey:"clients:deletePolicy",children:r(V,{children:[i("deletePolicyConfirm"),g?.dependentPolicies&&g.dependentPolicies.length>0&&e($e,{variant:"warning",isInline:!0,isPlain:!0,title:i("deletePolicyWarning"),className:"pf-u-pt-lg",children:e("p",{className:"pf-u-pt-xs",children:g.dependentPolicies.map(b=>e("strong",{className:"pf-u-pr-md",children:b.name},b.id))})})]}),continueButtonLabel:"clients:confirm",onConfirm:async()=>{try{await a.clients.delPolicy({id:t,policyId:g?.id}),n(i("policyDeletedSuccess"),te.success),S()}catch(b){s("clients:policyDeletedError",b)}}});if(!c)return e(Ne,{});const A=c.length===0,C=Object.keys(x).length!==0;return r(fe,{variant:"light",className:"pf-u-p-0",children:[e(q,{}),(!A||C)&&r(V,{children:[J&&e(yn,{policyProviders:f,onSelect:b=>l(Zt({id:t,realm:o,policyType:b.type})),toggleDialog:N}),e(It,{count:c.length,first:R,max:y,onNextClick:G,onPreviousClick:G,onPerPageSelect:(b,B)=>{G(b),k(B)},toolbarItem:r(V,{children:[e(Se,{children:e(Qt,{types:f,search:x,onSearch:X})}),e(Se,{children:e(_,{"data-testid":"createPolicy",onClick:N,children:i("createPolicy")})})]}),children:!A&&r(Ve,{"aria-label":i("resources"),variant:"compact",children:[e(qe,{children:r(re,{children:[e(j,{}),e(j,{children:i("common:name")}),e(j,{children:i("common:type")}),e(j,{children:i("dependentPermission")}),e(j,{children:i("common:description")}),e(j,{})]})}),c.map((b,B)=>r(Ue,{isExpanded:b.isExpanded,children:[r(re,{children:[e(M,{expand:{rowIndex:B,isExpanded:b.isExpanded,onToggle:(L,O)=>{const P=c.map(($,Q)=>Q===O?{...$,isExpanded:!$.isExpanded}:$);m(P)}}}),e(M,{"data-testid":`name-column-${b.name}`,children:e(ye,{to:qt({realm:o,id:t,policyType:b.type,policyId:b.id}),children:b.name})}),e(M,{children:Ct(b.type)}),e(M,{children:e(F,{row:b})}),e(M,{children:b.description}),e(M,{actions:{items:[{title:i("common:delete"),onClick:async()=>{h(b),U()}}]}})]}),r(re,{isExpanded:b.isExpanded,children:[e(M,{}),e(M,{colSpan:4,children:e(at,{children:b.isExpanded&&e(ot,{isHorizontal:!0,className:"keycloak_resource_details",children:e(He,{name:"dependentPermission",array:b.dependentPolicies,convert:L=>L.name,link:L=>gt({realm:o,id:t,permissionId:L.id,permissionType:L.type})})})})})]},`child-${b.id}`)]},b.id))]})})]}),A&&C&&e(Ee,{isSearchVariant:!0,message:i("common:noSearchResults"),instructions:i("common:noSearchResultsInstructions")}),A&&!C&&r(V,{children:[J&&e(yn,{policyProviders:f?.filter(b=>b.type!=="aggregate"),onSelect:b=>l(Zt({id:t,realm:o,policyType:b.type})),toggleDialog:N}),e(Ee,{message:i("emptyPolicies"),instructions:i("emptyPoliciesInstructions"),primaryActionText:i("createPolicy"),onPrimaryAction:N})]})]})};const Ds=({id:t,clientId:i,uris:a})=>{const{adminClient:n}=se(),{realm:s}=ge(),[o,l]=u.exports.useState(),[c,m]=u.exports.useState();return ce(()=>Promise.all([n.clients.listScopesByResource({id:i,resourceName:t}),n.clients.listPermissionsByResource({id:i,resourceId:t})]),([g,h])=>{l(g),m(h)},[]),!c||!o?e(Ne,{}):r(ot,{isHorizontal:!0,className:"keycloak_resource_details",children:[e(Es,{name:"uris",array:a}),e(He,{name:"scopes",array:o,convert:g=>g.name,link:g=>Pn({id:i,realm:s,scopeId:g.id})}),e(He,{name:"associatedPermissions",array:c,convert:g=>g.name,link:g=>gt({id:i,realm:s,permissionId:g.id,permissionType:"resource"})})]})},Ns=({clientId:t})=>{const{t:i}=E("clients"),a=nt(),{adminClient:n}=se(),{addAlert:s,addError:o}=pe(),{realm:l}=ge(),[c,m]=u.exports.useState(),[g,h]=u.exports.useState(),[f,p]=u.exports.useState(),[d,T]=u.exports.useState(0),S=()=>T(d+1),[y,k]=u.exports.useState(10),[R,G]=u.exports.useState(0),[x,X]=u.exports.useState({});ce(()=>{const C={first:R,max:y+1,deep:!1,...x};return n.clients.listResources({...C,id:t})},C=>m(C.map(b=>({...b,isExpanded:!1}))),[d,x,R,y]);const J=({row:C})=>r(V,{children:[C.uris?.[0]," ",e(xt,{array:C.uris})]}),N=async C=>n.clients.listPermissionsByResource({id:t,resourceId:C}),[F,U]=xe({titleKey:"clients:deleteResource",children:r(V,{children:[i("deleteResourceConfirm"),f?.length&&e($e,{variant:"warning",isInline:!0,isPlain:!0,title:i("deleteResourceWarning"),className:"pf-u-pt-lg",children:e("p",{className:"pf-u-pt-xs",children:f.map(C=>e("strong",{className:"pf-u-pr-md",children:C.name},C.id))})})]}),continueButtonLabel:"clients:confirm",onConfirm:async()=>{try{await n.clients.delResource({id:t,resourceId:g?._id}),s(i("resourceDeletedSuccess"),te.success),S()}catch(C){o("clients:resourceDeletedError",C)}}});if(!c)return e(Ne,{});const q=c.length===0,A=Object.keys(x).length!==0;return r(fe,{variant:"light",className:"pf-u-p-0",children:[e(U,{}),(!q||A)&&e(It,{count:c.length,first:R,max:y,onNextClick:G,onPreviousClick:G,onPerPageSelect:(C,b)=>{G(C),k(b)},toolbarItem:r(V,{children:[e(Se,{children:e(Qt,{search:x,onSearch:X,isResource:!0})}),e(Se,{children:e(_,{"data-testid":"createResource",component:C=>e(ye,{...C,to:en({realm:l,id:t})}),children:i("createResource")})})]}),children:!q&&r(Ve,{"aria-label":i("resources"),variant:"compact",children:[e(qe,{children:r(re,{children:[e(j,{}),e(j,{children:i("common:name")}),e(j,{children:i("common:type")}),e(j,{children:i("owner")}),e(j,{children:i("uris")}),e(j,{}),e(j,{})]})}),c.map((C,b)=>r(Ue,{isExpanded:C.isExpanded,children:[r(re,{children:[e(M,{expand:{rowIndex:b,isExpanded:C.isExpanded,onToggle:(B,L)=>{const O=c.map((P,$)=>$===L?{...P,isExpanded:!P.isExpanded}:P);m(O)}}}),e(M,{"data-testid":`name-column-${C.name}`,children:e(ye,{to:Ln({realm:l,id:t,resourceId:C._id}),children:C.name})}),e(M,{children:C.type}),e(M,{children:C.owner?.name}),e(M,{children:e(J,{row:C})}),e(M,{width:10,children:e(_,{variant:"link",component:B=>e(ye,{...B,to:mt({realm:l,id:t,permissionType:"resource",selectedId:C._id})}),children:i("createPermission")})}),e(M,{actions:{items:[{title:i("common:delete"),onClick:async()=>{h(C),p(await N(C._id)),F()}}]}})]}),r(re,{isExpanded:C.isExpanded,children:[e(M,{}),e(M,{colSpan:4,children:e(at,{children:C.isExpanded&&e(Ds,{clientId:t,id:C._id,uris:C.uris})})})]},`child-${C._id}`)]},C._id))]})}),q&&A&&e(Ee,{isSearchVariant:!0,message:i("common:noSearchResults"),instructions:i("common:noSearchResultsInstructions")}),q&&!A&&e(Ee,{message:i("emptyResources"),instructions:i("emptyResourcesInstructions"),primaryActionText:i("createResource"),onPrimaryAction:()=>a(en({realm:l,id:t}))})]})},Ks=({clientId:t})=>{const{t:i}=E("clients"),a=nt(),{adminClient:n}=se(),{realm:s}=ge(),[o,l]=Te(),[c,m]=u.exports.useState(),[g,h]=u.exports.useState(),[f,p]=u.exports.useState([]),[d,T]=u.exports.useState(0),S=()=>T(d+1),[y,k]=u.exports.useState(10),[R,G]=u.exports.useState(0),[x,X]=u.exports.useState("");ce(async()=>{const A={first:R,max:y+1,deep:!1,name:x},C=await n.clients.listAllScopes({...A,id:t});return await Promise.all(C.map(async b=>{const B={id:t,scopeId:b.id},L=await n.clients.listAllPermissionsByScope(B);return{...b,permissions:L,isLoaded:!1}}))},A=>{m(A),p(A.map(C=>({id:C.id,isExpanded:!1})))},[d,x,R,y]);const J=A=>c?.find(C=>C.id===A),N=A=>f.find(C=>C.id===A)?.isExpanded||!1;ce(async()=>{const A=f.filter(C=>C.isExpanded).map(({id:C})=>J(C)).filter(C=>!C.isLoaded);return await Promise.all(A.map(async C=>({...C,resources:await n.clients.listAllResourcesByScope({id:t,scopeId:C.id}),isLoaded:!0})))},A=>{let C=[...c||[]];A.forEach(b=>{const B=c?.findIndex(L=>b.id===L.id);C=[...C.slice(0,B),b,...C.slice(B+1)]}),m(C)},[f]);const F=({row:A})=>r(V,{children:[A.permissions?.[0]?.name?A.permissions[0]?.name:"\u2014"," ",e(xt,{array:A.permissions})]});if(!c)return e(Ne,{});const U=c.length===0,q=x!=="";return r(fe,{variant:"light",className:"pf-u-p-0",children:[e(Gi,{clientId:t,open:o,toggleDialog:l,selectedScope:g,refresh:S}),(!U||q)&&e(It,{count:c.length,first:R,max:y,onNextClick:G,onPreviousClick:G,onPerPageSelect:(A,C)=>{G(A),k(C)},inputGroupName:"search",inputGroupPlaceholder:i("searchByName"),inputGroupOnEnter:X,toolbarItem:e(Se,{children:e(_,{"data-testid":"createAuthorizationScope",component:A=>e(ye,{...A,to:tn({realm:s,id:t})}),children:i("createAuthorizationScope")})}),children:!U&&r(Ve,{"aria-label":i("scopes"),variant:"compact",children:[e(qe,{children:r(re,{children:[e(j,{}),e(j,{children:i("common:name")}),e(j,{children:i("common:permissions")}),e(j,{}),e(j,{})]})}),c.map((A,C)=>r(Ue,{isExpanded:N(A.id),children:[r(re,{children:[e(M,{expand:{rowIndex:C,isExpanded:N(A.id),onToggle:(b,B,L)=>{p([...f.slice(0,B),{id:A.id,isExpanded:L},...f.slice(B+1)])}}}),e(M,{"data-testid":`name-column-${A.name}`,children:e(ye,{to:Pn({realm:s,id:t,scopeId:A.id}),children:A.name})}),e(M,{children:e(F,{row:A})}),e(M,{width:10,children:e(_,{variant:"link",component:b=>e(ye,{...b,to:mt({realm:s,id:t,permissionType:"scope",selectedId:A.id})}),children:i("createPermission")})}),e(M,{isActionCell:!0,actions:{items:[{title:i("common:delete"),onClick:()=>{h(A),l()}}]}})]}),r(re,{isExpanded:N(A.id),children:[e(M,{}),e(M,{colSpan:4,children:e(at,{children:N(A.id)&&r(ot,{isHorizontal:!0,className:"keycloak_resource_details",children:[e(He,{name:"resources",array:A.resources,convert:b=>b.name,link:b=>Ln({id:t,realm:s,resourceId:b._id})}),e(He,{name:"associatedPermissions",array:A.permissions,convert:b=>b.name,link:b=>gt({id:t,realm:s,permissionId:b.id,permissionType:b.type})})]})})})]},`child-${A.id}`)]},A.id))]})}),U&&!q&&e(Ee,{message:i("emptyAuthorizationScopes"),instructions:i("emptyAuthorizationInstructions"),onPrimaryAction:()=>a(tn({id:t,realm:s})),primaryActionText:i("createAuthorizationScope")}),U&&q&&e(Ee,{isSearchVariant:!0,message:i("common:noSearchResults"),instructions:i("common:noSearchResultsInstructions")})]})},Yt=({name:t,save:i,reset:a,isActive:n=!0,...s})=>{const{t:o}=E("common");return r(ve,{...s,children:[e(_,{isDisabled:!n,"data-testid":t+"Save",onClick:i,type:i?"button":"submit",children:o("save")}),e(_,{isDisabled:!n,"data-testid":t+"Revert",variant:"link",onClick:a,children:o("revert")})]})},Ms=({onConfirm:t,closeDialog:i})=>{const{t:a}=E("clients"),[n,s]=u.exports.useState({});return r(ze,{title:a("import"),isOpen:!0,variant:"small",onClose:i,actions:[e(_,{id:"modal-confirm",onClick:()=>{t(n),i()},"data-testid":"confirm",children:a("confirm")},"confirm"),e(_,{"data-testid":"cancel",id:"modal-cancel",variant:Ce.link,onClick:()=>{i()},children:a("common:cancel")},"cancel")],children:[e(Re,{children:e(Hi,{id:"import-resource",onChange:s})}),Object.keys(n).length!==0&&r(V,{children:[e(Ge,{}),e("p",{className:"pf-u-my-lg",children:a("importResources")}),r(Re,{isHorizontal:!0,children:[e(v,{label:a("policyEnforcementMode"),labelIcon:e(I,{helpText:"clients-help:policyEnforcementMode",fieldLabelId:"clients:policyEnforcementMode"}),fieldId:"policyEnforcementMode",hasNoPaddingTop:!0,children:e(ht,{id:"policyEnforcementMode",name:"policyEnforcementMode",label:a(`policyEnforcementModes.${n.policyEnforcementMode}`),isChecked:!0,isDisabled:!0,className:"pf-u-mb-md"})}),e(v,{label:a("decisionStrategy"),labelIcon:e(I,{helpText:"clients-help:decisionStrategy",fieldLabelId:"clients:decisionStrategy"}),fieldId:"decisionStrategy",hasNoPaddingTop:!0,children:e(ht,{id:"decisionStrategy",name:"decisionStrategy",isChecked:!0,isDisabled:!0,label:a(`decisionStrategies.${n.decisionStrategy}`),className:"pf-u-mb-md"})}),e(v,{hasNoPaddingTop:!0,label:a("allowRemoteResourceManagement"),fieldId:"allowRemoteResourceManagement",labelIcon:e(I,{helpText:a("allowRemoteResourceManagement"),fieldLabelId:"clients:allowRemoteResourceManagement"}),children:e(ue,{id:"allowRemoteResourceManagement",label:a("common:on"),labelOff:a("common:off"),isChecked:n.allowRemoteResourceManagement,isDisabled:!0,"aria-label":a("allowRemoteResourceManagement")})})]}),e("div",{className:"pf-u-mt-md",children:Object.entries(n).filter(([,o])=>Array.isArray(o)).map(([o,l])=>r(u.exports.Fragment,{children:[e(Ge,{}),e("p",{className:"pf-u-my-sm",children:r("strong",{children:[l.length," ",a(o)]})})]},o))}),e(Ge,{}),e($e,{variant:"warning",className:"pf-u-mt-lg",isInline:!0,title:a("importWarning")})]})]})},Sn=["ENFORCING","PERMISSIVE","DISABLED"],Fs=({clientId:t})=>{const{t:i}=E("clients"),[a,n]=u.exports.useState(),[s,o]=Te(),l=Pe({}),{control:c,reset:m,handleSubmit:g}=l,{adminClient:h}=se(),{addAlert:f,addError:p}=pe();ce(()=>h.clients.getResourceServer({id:t}),S=>{n(S),m(S)},[]);const d=async S=>{try{await h.clients.importResource({id:t},S),f(i("importResourceSuccess"),te.success),m({...S})}catch(y){p("clients:importResourceError",y)}},T=async S=>{try{await h.clients.updateResourceServer({id:t},S),f(i("updateResourceSuccess"),te.success)}catch(y){p("clients:resourceSaveError",y)}};return a?r(fe,{variant:"light",children:[s&&e(Ms,{onConfirm:d,closeDialog:o}),r(de,{role:"view-clients",isHorizontal:!0,onSubmit:g(T),children:[e(v,{label:i("import"),fieldId:"import",labelIcon:e(I,{helpText:"clients-help:import",fieldLabelId:"clients:import"}),children:e(_,{variant:"secondary",onClick:o,children:i("import")})}),e(Ge,{}),e(v,{label:i("policyEnforcementMode"),labelIcon:e(I,{helpText:"clients-help:policyEnforcementMode",fieldLabelId:"clients:policyEnforcementMode"}),fieldId:"policyEnforcementMode",hasNoPaddingTop:!0,children:e(K,{name:"policyEnforcementMode","data-testid":"policyEnforcementMode",defaultValue:Sn[0],control:c,render:({field:S})=>e(V,{children:Sn.map(y=>e(ht,{id:y,"data-testid":y,isChecked:S.value===y,name:"policyEnforcementMode",onChange:()=>S.onChange(y),label:i(`policyEnforcementModes.${y}`),className:"pf-u-mb-md"},y))})})}),e(Ke,{...l,children:e(Ki,{isLimited:!0})}),e(v,{hasNoPaddingTop:!0,label:i("allowRemoteResourceManagement"),fieldId:"allowRemoteResourceManagement",labelIcon:e(I,{helpText:"clients-help:allowRemoteResourceManagement",fieldLabelId:"clients:allowRemoteResourceManagement"}),children:e(K,{name:"allowRemoteResourceManagement","data-testid":"allowRemoteResourceManagement",defaultValue:!1,control:c,render:({field:S})=>e(ue,{id:"allowRemoteResourceManagement",label:i("common:on"),labelOff:i("common:off"),isChecked:S.value,onChange:S.onChange,"aria-label":i("allowRemoteResourceManagement")})})}),e(Yt,{name:"authenticationSettings",reset:()=>m(a),isActive:!0})]})]}):e(Ne,{})},Bs=({client:t})=>{const{adminClient:i}=se(),{t:a}=E("sessions");return e(fe,{variant:"light",className:"pf-u-p-0",children:e($i,{loader:(s,o)=>i.clients.listSessions({id:t.id,first:s,max:o}),hiddenColumns:["clients"],emptyInstructions:a("noSessionsForClient")})})},Fe=({name:t,label:i})=>{const{t:a}=E("clients"),{control:n}=Y();return e(v,{hasNoPaddingTop:!0,label:a(i),fieldId:i,labelIcon:e(I,{helpText:a(`clients-help:${i}`),fieldLabelId:`clients:${i}`}),children:e(K,{name:t,defaultValue:"false",control:n,render:({field:s})=>e(ue,{id:t,"data-testid":i,label:a("common:on"),labelOff:a("common:off"),isChecked:s.value==="true",onChange:o=>s.onChange(o.toString()),"aria-label":a(i)})})})},zs=()=>{const{t}=E("clients"),{control:i}=Y(),[a,n]=u.exports.useState(!1);return r(de,{isHorizontal:!0,role:"manage-clients",className:"keycloak__capability-config__form",children:[e(v,{label:t("nameIdFormat"),fieldId:"nameIdFormat",labelIcon:e(I,{helpText:"clients-help:nameIdFormat",fieldLabelId:"clients:nameIdFormat"}),children:e(K,{name:"attributes.saml_name_id_format",defaultValue:"username",control:i,render:({field:s})=>e(W,{toggleId:"samlNameIdFormat",onToggle:n,onSelect:(o,l)=>{s.onChange(l.toString()),n(!1)},selections:s.value,variant:H.single,"aria-label":t("nameIdFormat"),isOpen:a,children:["username","email","transient","persistent"].map(o=>e(z,{selected:o===s.value,value:o},o))})})}),e(Fe,{name:D("attributes.saml.force.name.id.format"),label:"forceNameIdFormat"}),e(Fe,{name:D("attributes.saml.force.post.binding"),label:"forcePostBinding"}),e(Fe,{name:D("attributes.saml.artifact.binding"),label:"forceArtifactBinding"}),e(Fe,{name:D("attributes.saml.authnstatement"),label:"includeAuthnStatement"}),e(Fe,{name:D("attributes.saml.onetimeuse.condition"),label:"includeOneTimeUseCondition"}),e(Fe,{name:D("attributes.saml.server.signature.keyinfo.ext"),label:"optimizeLookup"})]})},vn=["RSA_SHA1","RSA_SHA256","RSA_SHA256_MGF1","RSA_SHA512","RSA_SHA512_MGF1","DSA_SHA1"],Cn=["NONE","KEY_ID","CERT_SUBJECT"],Pt=[{name:"EXCLUSIVE",value:"http://www.w3.org/2001/10/xml-exc-c14n#"},{name:"EXCLUSIVE_WITH_COMMENTS",value:"http://www.w3.org/2001/10/xml-exc-c14n#WithComments"},{name:"INCLUSIVE",value:"http://www.w3.org/TR/2001/REC-xml-c14n-20010315"},{name:"INCLUSIVE_WITH_COMMENTS",value:"http://www.w3.org/TR/2001/REC-xml-c14n-20010315#WithComments"}],Us=()=>{const{t}=E("clients"),[i,a]=u.exports.useState(!1),[n,s]=u.exports.useState(!1),[o,l]=u.exports.useState(!1),{control:c,watch:m}=Y(),g=m(D("attributes.saml.server.signature")),h=m(D("attributes.saml.assertion.signature"));return r(de,{isHorizontal:!0,role:"manage-clients",className:"keycloak__capability-config__form",children:[e(Fe,{name:D("attributes.saml.server.signature"),label:"signDocuments"}),e(Fe,{name:D("attributes.saml.assertion.signature"),label:"signAssertions"}),(g==="true"||h==="true")&&r(V,{children:[e(v,{label:t("signatureAlgorithm"),fieldId:"signatureAlgorithm",labelIcon:e(I,{helpText:"clients-help:signatureAlgorithm",fieldLabelId:"clients:signatureAlgorithm"}),children:e(K,{name:D("attributes.saml.signature.algorithm"),defaultValue:vn[0],control:c,render:({field:f})=>e(W,{toggleId:"signatureAlgorithm",onToggle:a,onSelect:(p,d)=>{f.onChange(d.toString()),a(!1)},selections:f.value,variant:H.single,"aria-label":t("signatureAlgorithm"),isOpen:i,children:vn.map(p=>e(z,{selected:p===f.value,value:p},p))})})}),e(v,{label:t("signatureKeyName"),fieldId:"signatureKeyName",labelIcon:e(I,{helpText:"clients-help:signatureKeyName",fieldLabelId:"clients:signatureKeyName"}),children:e(K,{name:D("attributes.saml.server.signature.keyinfo.xmlSigKeyInfoKeyNameTransformer"),defaultValue:Cn[0],control:c,render:({field:f})=>e(W,{toggleId:"signatureKeyName",onToggle:s,onSelect:(p,d)=>{f.onChange(d.toString()),s(!1)},selections:f.value,variant:H.single,"aria-label":t("signatureKeyName"),isOpen:n,children:Cn.map(p=>e(z,{selected:p===f.value,value:p},p))})})}),e(v,{label:t("canonicalization"),fieldId:"canonicalization",labelIcon:e(I,{helpText:"clients-help:canonicalization",fieldLabelId:"clients:canonicalization"}),children:e(K,{name:"attributes.saml_signature_canonicalization_method",defaultValue:Pt[0].value,control:c,render:({field:f})=>e(W,{toggleId:"canonicalization",onToggle:l,onSelect:(p,d)=>{f.onChange(d.toString()),l(!1)},selections:Pt.find(p=>p.value===f.value)?.name,variant:H.single,"aria-label":t("canonicalization"),isOpen:o,children:Pt.map(p=>e(z,{selected:p.value===f.value,value:p.value,children:p.name},p.name))})})})]})]})},Tn=({client:t,save:i,reset:a})=>{const{t:n}=E("clients"),{register:s,watch:o}=Y(),{hasAccess:l}=We(),c=l("manage-clients")||t.access?.configure,m=o("protocol");return r(de,{isHorizontal:!0,fineGrainedAccess:t.access?.configure,role:"manage-clients",children:[!t.bearerOnly&&e(Qi,{protocol:m}),m!=="saml"&&e(v,{label:n("adminURL"),fieldId:"kc-admin-url",labelIcon:e(I,{helpText:"clients-help:adminURL",fieldLabelId:"clients:adminURL"}),children:e(ee,{id:"kc-admin-url",type:"url",...s("adminUrl")})}),t.bearerOnly&&e(Yt,{className:"keycloak__form_actions",name:"settings",save:i,reset:a,isActive:!c})]})},Vs=({access:t})=>{const{t:i}=E("clients"),{register:a,control:n,watch:s}=Y(),[o,l]=u.exports.useState(!1),c=Be().themes.login,m=s("consentRequired"),g=s(D("attributes.display.on.consent.screen"));return r(de,{isHorizontal:!0,fineGrainedAccess:t,role:"manage-clients",children:[e(v,{label:i("loginTheme"),labelIcon:e(I,{helpText:"clients-help:loginTheme",fieldLabelId:"clients:loginTheme"}),fieldId:"loginTheme",children:e(K,{name:"attributes.login_theme",defaultValue:"",control:n,render:({field:h})=>e(W,{toggleId:"loginTheme",onToggle:l,onSelect:(f,p)=>{h.onChange(p.toString()),l(!1)},selections:h.value||i("common:choose"),variant:H.single,"aria-label":i("loginTheme"),isOpen:o,children:[e(z,{value:"",children:i("common:choose")},"empty"),...c.map(f=>e(z,{selected:f.name===h.value,value:f.name},f.name))]})})}),e(v,{label:i("consentRequired"),labelIcon:e(I,{helpText:"clients-help:consentRequired",fieldLabelId:"clients:consentRequired"}),fieldId:"kc-consent",hasNoPaddingTop:!0,children:e(K,{name:"consentRequired",defaultValue:!1,control:n,render:({field:h})=>e(ue,{id:"kc-consent-switch",label:i("common:on"),labelOff:i("common:off"),isChecked:h.value,onChange:h.onChange,"aria-label":i("consentRequired")})})}),e(v,{label:i("displayOnClient"),labelIcon:e(I,{helpText:"clients-help:displayOnClient",fieldLabelId:"clients:displayOnClient"}),fieldId:"kc-display-on-client",hasNoPaddingTop:!0,children:e(K,{name:D("attributes.display.on.consent.screen"),defaultValue:!1,control:n,render:({field:h})=>e(ue,{id:"kc-display-on-client-switch",label:i("common:on"),labelOff:i("common:off"),isChecked:h.value==="true",onChange:f=>h.onChange(""+f),isDisabled:!m,"aria-label":i("displayOnClient")})})}),e(v,{label:i("consentScreenText"),labelIcon:e(I,{helpText:"clients-help:consentScreenText",fieldLabelId:"clients:consentScreenText"}),fieldId:"kc-consent-screen-text",children:e(it,{id:"kc-consent-screen-text",...a(D("attributes.consent.screen.text")),isDisabled:!(m&&g==="true")})})]})},qs=({save:t,reset:i,client:{access:a}})=>{const{t:n}=E("clients"),{register:s,control:o,watch:l,formState:{errors:c}}=Y(),{hasAccess:m}=We(),g=m("manage-clients")||a?.configure,h=l("protocol"),f=l("frontchannelLogout");return r(de,{isHorizontal:!0,fineGrainedAccess:a?.configure,role:"manage-clients",children:[e(v,{label:n("frontchannelLogout"),labelIcon:e(I,{helpText:"clients-help:frontchannelLogout",fieldLabelId:"clients:frontchannelLogout"}),fieldId:"kc-frontchannelLogout",hasNoPaddingTop:!0,children:e(K,{name:"frontchannelLogout",defaultValue:!0,control:o,render:({field:p})=>e(ue,{id:"kc-frontchannelLogout-switch",label:n("common:on"),labelOff:n("common:off"),isChecked:p.value,onChange:p.onChange,"aria-label":n("frontchannelLogout")})})}),h==="openid-connect"&&f&&e(v,{label:n("frontchannelLogoutUrl"),fieldId:"frontchannelLogoutUrl",labelIcon:e(I,{helpText:"clients-help:frontchannelLogoutUrl",fieldLabelId:"clients:frontchannelLogoutUrl"}),helperTextInvalid:c.attributes?.[Me("frontchannel.logout.url")]?.message,validated:c.attributes?.[Me("frontchannel.logout.url")]?.message?Ie.error:Ie.default,children:e(ee,{id:"frontchannelLogoutUrl",type:"url",...s(D("attributes.frontchannel.logout.url"),{validate:p=>(p.startsWith("https://")||p.startsWith("http://"))&&!p.includes("*")||p===""||n("frontchannelUrlInvalid").toString()}),validated:c.attributes?.[Me("frontchannel.logout.url")]?.message?Ie.error:Ie.default})}),h==="openid-connect"&&r(V,{children:[e(v,{label:n("backchannelLogoutUrl"),fieldId:"backchannelLogoutUrl",labelIcon:e(I,{helpText:"clients-help:backchannelLogoutUrl",fieldLabelId:"clients:backchannelLogoutUrl"}),helperTextInvalid:c.attributes?.[Me("backchannel.logout.url")]?.message,validated:c.attributes?.[Me("backchannel.logout.url")]?.message?Ie.error:Ie.default,children:e(ee,{id:"backchannelLogoutUrl",type:"url",...s(D("attributes.backchannel.logout.url"),{validate:p=>(p.startsWith("https://")||p.startsWith("http://"))&&!p.includes("*")||p===""||n("backchannelUrlInvalid").toString()}),validated:c.attributes?.[Me("backchannel.logout.url")]?.message?Ie.error:Ie.default})}),e(v,{label:n("backchannelLogoutSessionRequired"),labelIcon:e(I,{helpText:"clients-help:backchannelLogoutSessionRequired",fieldLabelId:"clients:backchannelLogoutSessionRequired"}),fieldId:"backchannelLogoutSessionRequired",hasNoPaddingTop:!0,children:e(K,{name:D("attributes.backchannel.logout.session.required"),defaultValue:"true",control:o,render:({field:p})=>e(ue,{id:"backchannelLogoutSessionRequired",label:n("common:on"),labelOff:n("common:off"),isChecked:p.value==="true",onChange:d=>p.onChange(d.toString()),"aria-label":n("backchannelLogoutSessionRequired")})})}),e(v,{label:n("backchannelLogoutRevokeOfflineSessions"),labelIcon:e(I,{helpText:"clients-help:backchannelLogoutRevokeOfflineSessions",fieldLabelId:"clients:backchannelLogoutRevokeOfflineSessions"}),fieldId:"backchannelLogoutRevokeOfflineSessions",hasNoPaddingTop:!0,children:e(K,{name:D("attributes.backchannel.logout.revoke.offline.tokens"),defaultValue:"false",control:o,render:({field:p})=>e(ue,{id:"backchannelLogoutRevokeOfflineSessions",label:n("common:on"),labelOff:n("common:off"),isChecked:p.value==="true",onChange:d=>p.onChange(d.toString()),"aria-label":n("backchannelLogoutRevokeOfflineSessions")})})})]}),e(Yt,{className:"keycloak__form_actions",name:"settings",save:t,reset:i,isActive:g})]})},js=t=>{const{t:i}=E("clients"),{watch:a}=Y(),n=a("protocol"),{client:s}=t;return e(Nn,{className:"pf-u-px-lg pf-u-pb-lg",sections:[{title:i("generalSettings"),panel:e(Re,{isHorizontal:!0,children:e(Wi,{protocol:s.protocol,hasConfigureAccess:s.access?.configure})})},{title:"My Siop",panel:e(Tn,{...t})},{title:"My Siop-2",isHidden:n==="siop-2",panel:e(Tn,{...t})},{title:i("samlCapabilityConfig"),isHidden:n!=="saml"||s.bearerOnly,panel:e(zs,{})},{title:i("signatureAndEncryption"),isHidden:n!=="saml"||s.bearerOnly,panel:e(Us,{})},{title:i("capabilityConfig"),isHidden:n!=="openid-connect"&&n!=="SIOP-2"||s.bearerOnly,panel:e(Ji,{})},{title:i("loginSettings"),isHidden:s.bearerOnly,panel:e(Vs,{access:s.access?.configure})},{title:i("logoutSettings"),isHidden:s.bearerOnly,panel:e(qs,{...t})}]})},ti=({id:t,label:i,text:a,variant:n="plain"})=>{const{t:s}=E("clients"),o=hi(),[l,c]=u.exports.useState(0),m=u.exports.useMemo(()=>{switch(l){case 0:return s("copyToClipboard");case 1:return s("copySuccess");case 2:return s("clipboardCopyError")}},[l]);u.exports.useEffect(()=>{if(l!==0)return o(()=>c(0),1e3)},[l]);const g=async h=>{try{await navigator.clipboard.writeText(h),c(1)}catch{c(2)}};return e(Oi,{id:`copy-button-${t}`,textId:i,"aria-label":s("copyToClipboard"),onClick:()=>g(a),exitDelay:600,variant:n,children:m})},In=({id:t,buttonLabel:i,secret:a,toggle:n})=>{const{t:s}=E("clients"),o=Y();return r(tt,{hasGutter:!0,children:[e(ke,{isFilled:!0,children:r(Ut,{children:[e(Ft,{id:t,value:a,isReadOnly:!0}),e(ti,{id:t,text:a,label:"clientSecret",variant:"control"})]})}),e(ke,{children:e(_,{variant:"secondary",isDisabled:o.formState.isDirty,onClick:n,children:s(i)})})]})},kn=({time:t})=>{const{t:i}=E("clients"),a=Jt();return e("div",{className:"pf-u-my-md",children:(s=>s?i("secretExpiresOn",{time:a(new Date(s*1e3),{dateStyle:"full",timeStyle:"long"})}):void 0)(t)})},Gs=({client:t,secret:i,toggle:a})=>{const{t:n}=E("clients"),{adminClient:s}=se(),{addAlert:o,addError:l}=pe(),[c,m]=u.exports.useState(t.attributes?.["client.secret.rotated"]),g=t.attributes?.["client.secret.expiration.time"],h=t.attributes?.["client.secret.rotated.expiration.time"],f=T=>new Date().getTime()>=T*1e3,[p,d]=xe({titleKey:"clients:invalidateRotatedSecret",messageKey:"clients:invalidateRotatedSecretExplain",continueButtonLabel:"common:confirm",onConfirm:async()=>{try{await s.clients.invalidateSecret({id:t.id}),m(void 0),o(n("invalidateRotatedSuccess"))}catch(T){l("clients:invalidateRotatedError",T)}}});return r(V,{children:[e(d,{}),r(v,{label:n("clientSecret"),fieldId:"kc-client-secret",className:"pf-u-my-md",children:[e(In,{id:"kc-client-secret",secret:i,toggle:a,buttonLabel:"regenerate"}),e(kn,{time:g}),f(g)&&e($e,{variant:"warning",isInline:!0,title:n("secretHasExpired")})]}),c&&r(v,{label:n("secretRotated"),fieldId:"secretRotated",children:[e(In,{id:"secretRotated",secret:c,toggle:p,buttonLabel:"invalidateSecret"}),e(kn,{time:h})]})]})},Hs=()=>{const{control:t}=Y(),i=_e(Be().providers.clientSignature.providers),{t:a}=E("clients"),[n,s]=u.exports.useState(!1);return e(v,{label:a("signatureAlgorithm"),fieldId:"kc-signature-algorithm",labelIcon:e(I,{helpText:"clients-help:signature-algorithm",fieldLabelId:"clients:signatureAlgorithm"}),children:e(K,{name:D("attributes.token.endpoint.auth.signing.alg"),defaultValue:"",control:t,render:({field:o})=>r(W,{maxHeight:200,toggleId:"kc-signature-algorithm",onToggle:s,onSelect:(l,c)=>{o.onChange(c.toString()),s(!1)},selections:o.value||a("anyAlgorithm"),variant:H.single,"aria-label":a("signatureAlgorithm"),isOpen:n,children:[e(z,{selected:o.value==="",value:"",children:a("anyAlgorithm")},"any"),e(V,{children:i.map(l=>e(z,{selected:l===o.value,value:l},l))})]})})})},$s=()=>{const{t}=E("clients"),{register:i,control:a,formState:{errors:n}}=Y();return r(V,{children:[e(v,{label:t("allowRegexComparison"),labelIcon:e(I,{helpText:"clients-help:allowRegexComparison",fieldLabelId:"clients:allowRegexComparison"}),fieldId:"allowRegexComparison",hasNoPaddingTop:!0,children:e(K,{name:D("attributes.x509.allow.regex.pattern.comparison"),defaultValue:"false",control:a,render:({field:s})=>e(ue,{id:"allowRegexComparison",label:t("common:on"),labelOff:t("common:off"),isChecked:s.value==="true",onChange:o=>s.onChange(o.toString()),"aria-label":t("allowRegexComparison")})})}),e(v,{label:t("subject"),fieldId:"kc-subject",labelIcon:e(I,{helpText:"clients-help:subject",fieldLabelId:"clients:subject"}),helperTextInvalid:t("common:required"),validated:n.attributes?.[Me("x509.subjectdn")]?Ie.error:Ie.default,isRequired:!0,children:e(ee,{type:"text",id:"kc-subject",validated:n.attributes?.[Me("x509.subjectdn")]?Ie.error:Ie.default,...i(D("attributes.x509.subjectdn"),{required:!0})})})]})};const Ws=({client:t,save:i,refresh:a})=>{const{t:n}=E("clients"),{adminClient:s}=se(),{addAlert:o,addError:l}=pe(),c=t.id,[m,g]=u.exports.useState([]),{control:h,formState:{isDirty:f},handleSubmit:p}=Y(),d=Tt({control:h,name:"clientAuthenticatorType",defaultValue:""}),[T,S]=u.exports.useState(""),[y,k]=u.exports.useState(""),[R,G]=u.exports.useState(!1);ce(()=>Promise.all([s.authenticationManagement.getClientAuthenticatorProviders(),s.clients.getClientSecret({id:c})]),([A,C])=>{g(A),S(C.value)},[]);async function x(A,C){try{const b=await A(c);return o(n(`${C}Success`),te.success),b}catch(b){l(`clients:${C}Error`,b)}}const X=async()=>{const A=await x(C=>s.clients.generateNewClientSecret({id:C}),"clientSecret");S(A?.value||""),a()},[J,N]=xe({titleKey:"clients:confirmClientSecretTitle",messageKey:"clients:confirmClientSecretBody",continueButtonLabel:"common:yes",cancelButtonLabel:"common:no",onConfirm:X}),F=async()=>{const A=await x(C=>s.clients.generateRegistrationAccessToken({id:C}),"accessToken");k(A?.registrationAccessToken||"")},[U,q]=xe({titleKey:"clients:confirmAccessTokenTitle",messageKey:"clients:confirmAccessTokenBody",continueButtonLabel:"common:yes",cancelButtonLabel:"common:no",onConfirm:F});return e(fe,{children:r(de,{onSubmit:p(i),isHorizontal:!0,className:"pf-u-mt-md",role:"manage-clients",children:[e(N,{}),e(q,{}),r(St,{isFlat:!0,children:[r(Xe,{children:[e(v,{label:n("clientAuthenticator"),fieldId:"kc-client-authenticator-type",labelIcon:e(I,{helpText:"clients-help:client-authenticator-type",fieldLabelId:"clients:clientAuthenticator"}),children:e(K,{name:"clientAuthenticatorType",control:h,defaultValue:"",render:({field:A})=>e(W,{toggleId:"kc-client-authenticator-type",required:!0,onToggle:G,onSelect:(C,b)=>{A.onChange(b),G(!1)},selections:A.value,variant:H.single,"aria-label":n("clientAuthenticator"),isOpen:R,children:m.map(C=>e(z,{selected:C.id===A.value,value:C.id,children:C.displayName},C.id))})})}),(d==="client-jwt"||d==="client-secret-jwt")&&e(Hs,{}),d==="client-jwt"&&e($e,{variant:"info",isInline:!0,className:"kc-signedJWTAlert",title:n("signedJWTConfirm")}),d==="client-x509"&&e($s,{}),e(ve,{children:e(_,{variant:"primary",type:"submit",isDisabled:!f,children:n("common:save")})})]}),(d==="client-secret"||d==="client-secret-jwt")&&e(Ge,{}),(d==="client-secret"||d==="client-secret-jwt")&&e(Xe,{children:e(Gs,{client:t,secret:T,toggle:J})})]}),e(St,{isFlat:!0,children:e(Xe,{children:e(v,{label:n("registrationAccessToken"),fieldId:"kc-access-token",labelIcon:e(I,{helpText:"clients-help:registration-access-token",fieldLabelId:"clients:registrationAccessToken"}),children:r(tt,{hasGutter:!0,children:[e(ke,{isFilled:!0,children:e(Dn,{id:"kc-access-token",isReadOnly:!0,children:y})}),e(ke,{children:e(_,{variant:"secondary",onClick:U,children:n("regenerate")})})]})})})})]})})},xn=({id:t,keyInfo:i})=>e(it,{readOnly:!0,rows:5,id:t,"data-testid":"certificate",value:i?.certificate}),Xt=({keyInfo:t,plain:i=!1})=>{const{t:a}=E("clients");return e(gi,{prefix:"certificate",children:n=>i?e(xn,{id:n,keyInfo:t}):e(v,{label:a("certificate"),fieldId:n,labelIcon:e(I,{helpText:"clients-help:certificate",fieldLabelId:`clients:${n}`}),children:e(xn,{id:n,keyInfo:t})})})},ni=({hidePassword:t=!1,isSaml:i=!1})=>{const{t:a}=E("clients"),{register:n,formState:{errors:s}}=Y();return r(V,{children:[e(v,{label:a("keyAlias"),fieldId:"keyAlias",isRequired:!0,labelIcon:e(I,{helpText:"clients-help:keyAlias",fieldLabelId:"clients:keyAlias"}),helperTextInvalid:a("common:required"),validated:s.keyAlias?"error":"default",children:e(ee,{"data-testid":"keyAlias",id:"keyAlias",validated:s.keyAlias?"error":"default",...n("keyAlias",{required:!0})})}),!t&&e(v,{label:a("keyPassword"),fieldId:"keyPassword",isRequired:!0,labelIcon:e(I,{helpText:"clients-help:keyPassword",fieldLabelId:"clients:keyPassword"}),helperTextInvalid:a("common:required"),validated:s.keyPassword?"error":"default",children:e(Ft,{"data-testid":"keyPassword",id:"keyPassword",validated:s.keyPassword?"error":"default",...n("keyPassword",{required:!0})})}),i&&e(v,{label:a("realmCertificateAlias"),fieldId:"realmCertificateAlias",labelIcon:e(I,{helpText:"clients-help:realmCertificateAlias",fieldLabelId:"clients:realmCertificateAlias"}),children:e(ee,{"data-testid":"realmCertificateAlias",id:"realmCertificateAlias",...n("realmAlias")})}),e(v,{label:a("storePassword"),fieldId:"storePassword",isRequired:!0,labelIcon:e(I,{helpText:"clients-help:storePassword",fieldLabelId:"clients:storePassword"}),helperTextInvalid:a("common:required"),validated:s.storePassword?"error":"default",children:e(Ft,{"data-testid":"storePassword",id:"storePassword",validated:s.storePassword?"error":"default",...n("storePassword",{required:!0})})})]})},Rn="Certificate PEM",Js=new Map([["PKCS12","p12"],["JKS","jks"],["BCFKS","bcfks"]]),ii=t=>Js.get(t),Rt=({isSaml:t=!1,hasPem:i=!1,useFile:a=!1})=>{const{t:n}=E("clients"),[s,o]=u.exports.useState(),[l,c]=u.exports.useState(!1),{control:m,watch:g}=Y(),h=g("format"),{cryptoInfo:f}=Be(),p=[...f?.supportedKeystoreTypes??[],...i?Rn:[]];return r(Re,{className:"pf-u-pt-lg",children:[e(v,{label:n("archiveFormat"),labelIcon:e(I,{helpText:"clients-help:archiveFormat",fieldLabelId:"clients:archiveFormat"}),fieldId:"archiveFormat",children:e(K,{name:"format",defaultValue:p[0],control:m,render:({field:d})=>e(W,{toggleId:"archiveFormat",onToggle:c,onSelect:(T,S)=>{d.onChange(S.toString()),c(!1)},selections:d.value,variant:H.single,"aria-label":n("archiveFormat"),isOpen:l,children:p.map(T=>e(z,{selected:T===d.value,value:T},T))})})}),a&&e(v,{label:n("importFile"),labelIcon:e(I,{helpText:"clients-help:importFile",fieldLabelId:"clients:importFile"}),fieldId:"importFile",children:e(K,{name:"file",defaultValue:"",control:m,render:({field:d})=>e(Wn,{id:"importFile",value:d.value,filename:s,browseButtonText:n("browse"),onChange:(T,S)=>{o(S),d.onChange(T)}})})}),h!==Rn&&e(ni,{hidePassword:a,isSaml:t})]})},Qs=({clientId:t,save:i,toggleDialog:a})=>{const{t:n}=E("clients"),s=Pe({defaultValues:{keyAlias:t},mode:"onChange"}),{handleSubmit:o,formState:{isValid:l}}=s;return r(ze,{variant:st.medium,title:n("generateKeys"),isOpen:!0,onClose:a,actions:[e(_,{id:"modal-confirm","data-testid":"confirm",isDisabled:!l,onClick:()=>{o(c=>{i(c),a()})()},children:n("generate")},"confirm"),e(_,{id:"modal-cancel","data-testid":"cancel",variant:Ce.link,onClick:()=>{a()},children:n("common:cancel")},"cancel")],children:[e(De,{children:e(he,{children:n("clients-help:generateKeysDescription")})}),e(Ke,{...s,children:e(Rt,{})})]})},Ys=({save:t,toggleDialog:i})=>{const{t:a}=E("clients"),n=Pe(),{control:s,handleSubmit:o}=n,[l,c]=u.exports.useState(!1),m=Be().cryptoInfo?.supportedKeystoreTypes??[],g=m.concat(["Certificate PEM","Public Key PEM","JSON Web Key Set"]),h=Tt({control:s,name:"keystoreFormat",defaultValue:g[0]});return r(ze,{variant:st.medium,title:a("generateKeys"),isOpen:!0,onClose:i,actions:[e(_,{id:"modal-confirm","data-testid":"confirm",onClick:()=>{o(f=>{t(f),i()})()},children:a("import")},"confirm"),e(_,{id:"modal-cancel","data-testid":"cancel",variant:Ce.link,onClick:()=>{i()},children:a("common:cancel")},"cancel")],children:[e(De,{children:e(he,{children:a("clients-help:generateKeysDescription")})}),r(Re,{className:"pf-u-pt-lg",children:[e(v,{label:a("archiveFormat"),labelIcon:e(I,{helpText:"clients-help:archiveFormat",fieldLabelId:"clients:archiveFormat"}),fieldId:"archiveFormat",children:e(K,{name:"keystoreFormat",control:s,defaultValue:g[0],render:({field:f})=>e(W,{toggleId:"archiveFormat",onToggle:c,onSelect:(p,d)=>{f.onChange(d),c(!1)},selections:f.value,variant:H.single,"aria-label":a("archiveFormat"),isOpen:l,children:g.map(p=>e(z,{selected:p===f.value,value:p},p))})})}),m.includes(h)&&e(Ke,{...n,children:e(ni,{hidePassword:!0})}),e(v,{label:a("importFile"),fieldId:"importFile",children:e(K,{name:"file",control:s,defaultValue:{filename:""},render:({field:f})=>e(Wn,{id:"importFile",value:f.value.value,filename:f.value.filename,onChange:(p,d)=>f.onChange({value:p,filename:d})})})})]})]})},Lt="jwt.credential",Xs=({clientId:t,save:i,hasConfigureAccess:a})=>{const{t:n}=E("clients"),{control:s,register:o,getValues:l,formState:{isDirty:c}}=Y(),{adminClient:m}=se(),{addAlert:g,addError:h}=pe(),[f,p]=u.exports.useState(),[d,T,S]=Te(),[y,k,R]=Te(),[G,x]=u.exports.useState(0),X=()=>x(G+1),J=Tt({control:s,name:D("attributes.use.jwks.url"),defaultValue:"false"});ce(()=>m.clients.getKeyInfo({id:t,attr:Lt}),U=>p(U),[G]);const N=async U=>{try{const q=await m.clients.generateAndDownloadKey({id:t,attr:Lt},U);et.exports.saveAs(new Blob([q],{type:"application/octet-stream"}),`keystore.${ii(U.format??"")}`),g(n("generateSuccess"),te.success),X()}catch(q){h("clients:generateError",q)}},F=async U=>{try{const q=new FormData,{file:A,...C}=U;Object.entries(C).map(b=>q.append(b[0],b[1])),q.append("file",A.value),await m.clients.uploadCertificate({id:t,attr:Lt},q),g(n("importSuccess"),te.success),X()}catch(q){h("clients:importError",q)}};return r(fe,{variant:"light",className:"keycloak__form",children:[d&&e(Qs,{clientId:l("clientId"),toggleDialog:T,save:N}),y&&e(Ys,{toggleDialog:k,save:F}),r(St,{isFlat:!0,children:[e(Yi,{children:e(Xi,{children:n("jwksUrlConfig")})}),e(Xe,{children:e(De,{children:e(he,{children:n("keysIntro")})})}),e(Xe,{children:r(de,{role:"manage-clients",fineGrainedAccess:a,isHorizontal:!0,children:[e(v,{hasNoPaddingTop:!0,label:n("useJwksUrl"),fieldId:"useJwksUrl",labelIcon:e(I,{helpText:"clients-help:useJwksUrl",fieldLabelId:"clients:useJwksUrl"}),children:e(K,{name:D("attributes.use.jwks.url"),control:s,render:({field:U})=>e(ue,{"data-testid":"useJwksUrl",id:"useJwksUrl-switch",label:n("common:on"),labelOff:n("common:off"),isChecked:U.value==="true",onChange:q=>U.onChange(`${q}`),"aria-label":n("useJwksUrl")})})}),J!=="true"&&(f?e(Xt,{plain:!0,keyInfo:f}):"No client certificate configured"),J==="true"&&e(v,{label:n("jwksUrl"),fieldId:"jwksUrl",labelIcon:e(I,{helpText:"clients-help:jwksUrl",fieldLabelId:"clients:jwksUrl"}),children:e(ee,{id:"jwksUrl",type:"url",...o(D("attributes.jwks.url"))})}),r(ve,{children:[e(_,{"data-testid":"saveKeys",onClick:i,isDisabled:!c,children:n("common:save")}),e(_,{"data-testid":"generate",variant:"secondary",onClick:()=>S(!0),children:n("generateNewKeys")}),e(_,{"data-testid":"import",variant:"secondary",onClick:()=>R(!0),isDisabled:J==="true",children:n("import")})]})]})})]})]})},Zs=({clientId:t,close:i})=>{const{t:a}=E("clients"),{realm:n}=ge(),{adminClient:s}=se(),{addAlert:o,addError:l}=pe(),c=Pe({defaultValues:{realmAlias:n}}),m=async g=>{try{const h=await s.clients.downloadKey({id:t,attr:"saml.signing"},g);et.exports.saveAs(new Blob([h],{type:"application/octet-stream"}),`keystore.${ii(g.format??"")}`),o(a("samlKeysExportSuccess")),i()}catch(h){l("clients:samlKeysExportError",h)}};return e(ze,{variant:"medium",title:a("exportSamlKeyTitle"),isOpen:!0,onClose:i,actions:[e(_,{id:"modal-confirm","data-testid":"confirm",type:"submit",form:"export-saml-key-form",children:a("common:export")},"confirm"),e(_,{id:"modal-cancel","data-testid":"cancel",variant:"link",onClick:()=>{i()},children:a("common:cancel")},"cancel")],children:e(Re,{id:"export-saml-key-form",className:"pf-u-pt-lg",onSubmit:c.handleSubmit(m),children:e(Ke,{...c,children:e(Rt,{isSaml:!0})})})})},si=async(t,i,a,n,s)=>{try{const o=new FormData,{file:l,...c}=t;Object.entries(c).map(([m,g])=>o.append(m==="format"?"keystoreFormat":m,g.toString())),o.append("file",l),await n.clients.uploadKey({id:i,attr:a},o),s()}catch(o){s(o)}},ea=({id:t,attr:i,onClose:a,onCancel:n})=>{const{t:s}=E("clients"),[o,l]=u.exports.useState(!1),[c,m]=u.exports.useState(),g=Pe({mode:"onChange"}),{handleSubmit:h,formState:{isValid:f}}=g,{adminClient:p}=se(),{addAlert:d,addError:T}=pe(),S=k=>{si(k,t,i,p,R=>{R?T("clients:importError",R):d(s("importSuccess"),te.success)})},y=async()=>{try{const k=await p.clients.generateKey({id:t,attr:i});m(k),et.exports.saveAs(new Blob([k.privateKey],{type:"application/octet-stream"}),"private.key"),d(s("generateSuccess"),te.success)}catch(k){T("clients:generateError",k)}};return e(ze,{variant:st.medium,"aria-labelledby":s("enableClientSignatureRequired"),header:r(De,{children:[e(Ht,{headingLevel:"h1",children:s("enableClientSignatureRequired")}),e(he,{children:s("enableClientSignatureRequiredExplain")})]}),isOpen:!0,onClose:a,actions:[e(_,{id:"modal-confirm","data-testid":"confirm",variant:"primary",isDisabled:!f&&!c,onClick:()=>{o&&h(S)(),a()},children:s("confirm")},"confirm"),e(_,{id:"modal-cancel","data-testid":"cancel",variant:Ce.link,onClick:n,children:s("common:cancel")},"cancel")],children:r(Ke,{...g,children:[r(Re,{isHorizontal:!0,children:[e(v,{label:s("selectMethod"),fieldId:"selectMethod",hasNoPaddingTop:!0,children:r(Zi,{children:[e(ln,{children:e(ht,{isChecked:!o,name:"selectMethodType",onChange:()=>l(!1),label:s("selectMethodType.generate"),id:"selectMethodType-generate"})}),e(ln,{children:e(ht,{isChecked:o,name:"selectMethodType",onChange:()=>l(!0),label:s("selectMethodType.import"),id:"selectMethodType-import"})})]})}),!o&&e(v,{label:s("certificate"),fieldId:"certificate",labelIcon:e(I,{helpText:"clients-help:certificate",fieldLabelId:"clients:certificate"}),children:r(tt,{hasGutter:!0,children:[e(ke,{isFilled:!0,children:e(Xt,{plain:!0,keyInfo:c})}),e(ke,{children:e(_,{variant:"secondary","data-testid":"generate",onClick:y,children:s("generate")})})]})})]}),o&&e(Rt,{useFile:!0})]})})},ta=({id:t,attr:i,onClose:a})=>{const{t:n}=E("clients"),s=Y(),{handleSubmit:o}=s,{adminClient:l}=se(),{addAlert:c,addError:m}=pe(),g=h=>{si(h,t,i,l,f=>{f?m("clients:importError",f):c(n("importSuccess"),te.success)})};return e(Gt,{open:!0,toggleDialog:a,continueButtonLabel:"clients:import",titleKey:"clients:importKey",onConfirm:()=>{o(g)(),a()},children:e(Ke,{...s,children:e(Rt,{useFile:!0,hasPem:!0})})})},_t=["saml.signing","saml.encryption"],Ze={"saml.signing":{name:D("attributes.saml.client.signature"),title:"signingKeysConfig",key:"clientSignature"},"saml.encryption":{name:D("attributes.saml.encrypt"),title:"encryptionKeysConfig",key:"encryptAssertions"}},na=({clientId:t,keyInfo:i,attr:a,onChanged:n,onGenerate:s,onImport:o})=>{const{t:l}=E("clients"),{control:c,watch:m}=Y(),g=Ze[a].title,h=Ze[a].key,f=Ze[a].name,[p,d]=Te(),T=m(f);return r(V,{children:[p&&e(Zs,{clientId:t,close:d}),r(Mt,{title:l(g),className:"kc-form-panel__panel",children:[e(De,{className:"pf-u-pb-lg",children:e(he,{children:l(`${g}Explain`)})}),e(de,{role:"manage-clients",isHorizontal:!0,children:e(v,{labelIcon:e(I,{helpText:`clients-help:${h}`,fieldLabelId:`clients:${h}`}),label:l(h),fieldId:h,hasNoPaddingTop:!0,children:e(K,{name:f,control:c,defaultValue:"false",render:({field:S})=>e(ue,{"data-testid":h,id:h,label:l("common:on"),labelOff:l("common:off"),isChecked:S.value==="true",onChange:y=>{const k=y.toString();k==="true"?(n(a),S.onChange(k)):s(a,!1)},"aria-label":l(h)})})})})]}),i?.certificate&&T==="true"&&e(St,{isFlat:!0,children:e(Xe,{className:"kc-form-panel__body",children:r(Re,{isHorizontal:!0,children:[e(Xt,{keyInfo:i}),r(ve,{children:[e(_,{variant:"secondary",onClick:()=>s(a,!0),children:l("regenerate")}),e(_,{variant:"secondary",onClick:()=>o(a),children:l("importKey")}),e(_,{variant:"tertiary",onClick:d,children:l("common:export")})]})]})})})]})},ia=({clientId:t,save:i})=>{const{t:a}=E("clients"),[n,s]=u.exports.useState(),[o,l]=u.exports.useState(),[c,m]=u.exports.useState(),[g,h]=u.exports.useState(),[f,p]=u.exports.useState(0),{setValue:d}=Y(),{adminClient:T}=se(),{addAlert:S,addError:y}=pe();ce(()=>Promise.all(_t.map(N=>T.clients.getKeyInfo({id:t,attr:N}))),N=>l(N),[f]);const k=async N=>{const F=_t.indexOf(N);try{const U=[...o||[]];U[F]=await T.clients.generateKey({id:t,attr:N}),l(U),et.exports.saveAs(new Blob([U[F].privateKey],{type:"application/octet-stream"}),"private.key"),S(a("generateSuccess"),te.success)}catch(U){y("clients:generateError",U)}},R=c?Ze[c].key:"",[G,x]=xe({titleKey:a("disableSigning",{key:a(R)}),messageKey:a("disableSigningExplain",{key:a(R)}),continueButtonLabel:"common:yes",cancelButtonLabel:"common:no",onConfirm:()=>{d(Ze[c].name,"false"),i()}}),[X,J]=xe({titleKey:"clients:reGenerateSigning",messageKey:"clients:reGenerateSigningExplain",continueButtonLabel:"common:yes",cancelButtonLabel:"common:no",onConfirm:()=>{k(c)}});return r(fe,{variant:"light",className:"keycloak__form",children:[n&&e(ea,{id:t,attr:n,onClose:()=>{s(void 0),i(),p(f+1)},onCancel:()=>{d(Ze[c].name,"false"),s(void 0)}}),e(x,{}),e(J,{}),_t.map((N,F)=>r(u.exports.Fragment,{children:[g===N&&e(ta,{id:t,attr:N,onClose:()=>h(void 0)}),e(na,{clientId:t,keyInfo:o?.[F],attr:N,onChanged:s,onGenerate:(U,q)=>{m(U),q?X():G()},onImport:()=>h(N)})]},N))]})},Dt="dedicated",sa=({clientId:t,protocol:i,clientName:a,fineGrainedAccess:n})=>{const{t:s}=E("clients"),{adminClient:o}=se(),{addAlert:l,addError:c}=pe(),{realm:m}=ge(),g=Hn(),[h,f]=u.exports.useState("name"),[p,d]=u.exports.useState(rn.none),[T,S]=u.exports.useState(!1),[y,k]=u.exports.useState(),[R,G]=u.exports.useState([]),x=O=>G(O.filter(({id:P})=>P!==Dt)),[X,J]=u.exports.useState(0),N=()=>J(X+1),F=O=>O.id===Dt,{hasAccess:U}=We(),q=U("manage-clients")||n,A=async(O,P,$)=>{const Q=await o.clients.listDefaultClientScopes({id:t}),ne=await o.clients.listOptionalClientScopes({id:t}),ie=await o.clientScopes.find(),we=be=>ie.find(Le=>be===Le.id),lt=ne.map(be=>{const Le=we(be.id);return{...be,type:dn.optional,description:Le?.description}}),rt=Q.map(be=>{const Le=we(be.id);return{...be,type:dn.default,description:Le?.description}}),Je=[...lt,...rt],ct=Je.map(be=>be.name);k(ie.filter(be=>!ct.includes(be.name)).filter(be=>be.protocol===i));const w=h==="name"?os($):ls(p),me=Number(O),Z=g(Je.filter(w),$n("name")).slice(me,me+Number(P));return me===0&&q?[{id:Dt,name:s("dedicatedScopeName",{clientName:a}),type:rn.none,description:s("dedicatedScopeDescription")},...Z]:Z},C=O=>e(ts,{isDisabled:F(O)||!q,clientScope:O,type:O.type,onSelect:async P=>{try{await ns(o,t,O,O.type,P),l(s("clientScopeSuccess"),te.success),N()}catch($){c("clients:clientScopeError",$)}}}),[b,B]=xe({titleKey:s("client-scopes:deleteClientScope",{count:R.length,name:R[0]?.name}),messageKey:"client-scopes:deleteConfirm",continueButtonLabel:"common:delete",continueButtonVariant:Ce.danger,onConfirm:async()=>{try{await cn(o,t,R[0],R[0].type),l(s("clientScopeRemoveSuccess"),te.success),N()}catch(O){c("clients:clientScopeRemoveError",O)}}});return r(V,{children:[y&&e(Mi,{clientScopes:y,clientName:a,open:T,toggleDialog:()=>S(!T),onAdd:async O=>{try{await Promise.all(O.map(async P=>await es(o,t,P.scope,P.type))),l(s("clientScopeSuccess"),te.success),N()}catch(P){c("clients:clientScopeError",P)}}}),e(kt,{loader:A,ariaLabelKey:"clients:clientScopeList",searchPlaceholderKey:h==="name"?"clients:searchByName":void 0,canSelectAll:!0,isPaginated:!0,isSearching:h==="type",onSelect:O=>x([...O]),searchTypeComponent:e(is,{searchType:h,onSelect:O=>f(O)}),toolbarItem:r(V,{children:[e(ss,{searchType:h,type:p,onSelect:O=>f(O),onType:O=>{d(O),N()}}),e(()=>{const[O,P]=u.exports.useState(!1);return q?r(V,{children:[e(B,{}),e(Se,{children:e(_,{onClick:()=>S(!0),children:s("addClientScope")})}),e(Se,{children:e(as,{clientId:t,selectedRows:R,refresh:N})}),e(Se,{children:e(jt,{toggle:e(bi,{onToggle:()=>P(!O)}),isOpen:O,isPlain:!0,dropdownItems:[e(Ye,{isDisabled:R.length===0,onClick:async()=>{try{await Promise.all(R.map($=>cn(o,t,{...$},$.type))),P(!1),x([]),l(s("clients:clientScopeRemoveSuccess")),N()}catch($){c("clients:clientScopeRemoveError",$)}},children:s("common:remove")},"deleteAll")]})})]}):e("span",{})},{})]}),columns:[{name:"name",displayKey:"clients:assignedClientScope",cellRenderer:O=>F(O)?e(ye,{to:fi({realm:m,clientId:t}),children:O.name}):O.name},{name:"type",displayKey:"clients:assignedType",cellRenderer:C},{name:"description"}],actions:q?[{title:s("common:remove"),onRowClick:async O=>(x([O]),b(),!0)}]:[],emptyState:e(Ee,{message:s("clients:emptyClientScopes"),instructions:s("clients:emptyClientScopesInstructions"),primaryActionText:s("clients:emptyClientScopesPrimaryAction"),onPrimaryAction:()=>S(!0)})},X)]})},Nt=({text:t,user:i,label:a})=>{const{t:n}=E("clients");return i?e(Jn,{id:a,actions:e(Qn,{children:e(ti,{id:"code",text:t,label:a})}),children:e(it,{id:`text-area-${a}`,rows:20,value:t})}):r(jn,{variant:"large",children:[e(Ht,{headingLevel:"h4",size:"lg",children:n(`${a}No`)}),e(Gn,{children:n(`${a}IsDisabled`)})]})};const aa=({protocolMappers:t})=>{const[i,a]=u.exports.useState(0);return u.exports.useEffect(()=>{a(i+1)},[t]),e(kt,{loader:()=>Promise.resolve(t),ariaLabelKey:"clients:effectiveProtocolMappers",searchPlaceholderKey:"clients:searchForProtocol",columns:[{name:"mapperName",displayKey:"common:name"},{name:"containerName",displayKey:"clients:parentClientScope"},{name:"type.category",displayKey:"common:category"},{name:"type.priority",displayKey:"common:priority"}]},i)},oa=({effectiveRoles:t})=>{const[i,a]=u.exports.useState(0);return u.exports.useEffect(()=>{a(i+1)},[t]),e(kt,{loader:()=>Promise.resolve(t),ariaLabelKey:"client:effectiveRoleScopeMappings",searchPlaceholderKey:"clients:searchForRole",columns:[{name:"name",displayKey:"clients:role"},{name:"containerId",displayKey:"clients:origin"}]},i)},la=({clientId:t,protocol:i})=>{const a="openid",{t:n}=E("clients"),{enabled:s}=An(),{adminClient:o}=se(),{realm:l}=ge(),c=Be().protocolMapperTypes[i],[m,g]=u.exports.useState([]),[h,f]=u.exports.useState(!1),[p,d]=u.exports.useState([a]),[T,S]=u.exports.useState(0),[y,k]=u.exports.useState(""),R=()=>k(`${new Date().getTime()}`),[G,x]=u.exports.useState([]),[X,J]=u.exports.useState([]),[N,F]=u.exports.useState(""),[U,q]=u.exports.useState(""),[A,C]=u.exports.useState(""),b=u.exports.useRef(null),B=u.exports.useRef(null),L=u.exports.useRef(null),O=u.exports.useRef(null),P=u.exports.useRef(null),$=Pe();return ce(()=>o.clients.listOptionalClientScopes({id:t}),Q=>g(Q),[]),ce(async()=>{const Q=p.join(" "),ne=await o.clients.evaluatePermission({id:t,roleContainer:l,scope:Q,type:"granted"});return{mapperList:await o.clients.evaluateListProtocolMapper({id:t,scope:Q}),effectiveRoles:ne}},({mapperList:Q,effectiveRoles:ne})=>{x(ne),Q.map(ie=>{ie.type=c.filter(we=>we.id===ie.protocolMapper)[0]}),J(Q),R()},[p]),ce(async()=>{const Q=p.join(" "),ne=$.getValues("user");return ne?await Promise.all([o.clients.evaluateGenerateAccessToken({id:t,userId:ne[0],scope:Q}),o.clients.evaluateGenerateUserInfo({id:t,userId:ne[0],scope:Q}),o.clients.evaluateGenerateIdToken({id:t,userId:ne[0],scope:Q})]):[]},([Q,ne,ie])=>{F(Qe(Q)),q(Qe(ne)),C(Qe(ie))},[$.getValues("user"),p]),r(V,{children:[r(fe,{variant:"light",children:[s&&e(De,{className:"keycloak__section_intro__help",children:r(he,{children:[e(cs,{})," ",n("clients-help:evaluateExplain")]})}),r(Re,{isHorizontal:!0,children:[e(v,{label:n("scopeParameter"),fieldId:"scopeParameter",labelIcon:e(I,{helpText:"clients-help:scopeParameter",fieldLabelId:"clients:scopeParameter"}),children:r(tt,{hasGutter:!0,children:[e(ke,{isFilled:!0,children:e(W,{toggleId:"scopeParameter",variant:H.typeaheadMulti,typeAheadAriaLabel:n("scopeParameter"),onToggle:()=>f(!h),isOpen:h,selections:p,onSelect:(Q,ne)=>{const ie=ne;p.includes(ie)?ie!==a&&d(p.filter(we=>we!==ie)):d([...p,ie])},"aria-labelledby":n("scopeParameter"),placeholderText:n("scopeParameterPlaceholder"),children:m.map((Q,ne)=>e(z,{value:Q.name},ne))})}),e(ke,{children:e(Dn,{className:"keycloak__scopes_evaluate__clipboard-copy",children:p.join(" ")})})]})}),e(Ke,{...$,children:e(Un,{name:"user",label:"users",helpText:"clients-help:user",defaultValue:"",variant:H.typeahead,isRequired:!0})})]})]}),r(ds,{hasGutter:!0,className:"keycloak__scopes_evaluate__tabs",children:[r(un,{span:8,children:[e(ut,{"aria-labelledby":"pf-tab-0-effectiveProtocolMappers",eventKey:0,id:"effectiveProtocolMappers",ref:b,children:e(aa,{protocolMappers:X})}),e(ut,{"aria-labelledby":"pf-tab-0-effectiveRoleScopeMappings",eventKey:1,id:"effectiveRoleScopeMappings",ref:B,hidden:!0,children:e(oa,{effectiveRoles:G})}),e(ut,{"aria-labelledby":n("generatedAccessToken"),eventKey:2,id:"tab-generated-access-token",ref:L,hidden:!0,children:e(Nt,{text:N,user:$.getValues("user"),label:"generatedAccessToken"})}),e(ut,{"aria-labelledby":n("generatedIdToken"),eventKey:3,id:"tab-generated-id-token",ref:O,hidden:!0,children:e(Nt,{text:A,user:$.getValues("user"),label:"generatedIdToken"})}),e(ut,{"aria-labelledby":n("generatedUserInfo"),eventKey:4,id:"tab-generated-user-info",ref:P,hidden:!0,children:e(Nt,{text:U,user:$.getValues("user"),label:"generatedUserInfo"})})]}),e(un,{span:4,children:r(rs,{id:"tabs",isVertical:!0,activeKey:T,onSelect:(Q,ne)=>S(ne),children:[e(oe,{id:"effectiveProtocolMappers","aria-controls":"effectiveProtocolMappers",eventKey:0,title:r(le,{children:[n("effectiveProtocolMappers")," ",e(I,{fieldLabelId:"clients:effectiveProtocolMappers",helpText:"clients-help:effectiveProtocolMappers",noVerticalAlign:!1,unWrap:!0})]}),tabContentRef:b}),e(oe,{id:"effectiveRoleScopeMappings","aria-controls":"effectiveRoleScopeMappings",eventKey:1,title:r(le,{children:[n("effectiveRoleScopeMappings")," ",e(I,{fieldLabelId:"clients:effectiveRoleScopeMappings",helpText:"clients-help:effectiveRoleScopeMappings",noVerticalAlign:!1,unWrap:!0})]}),tabContentRef:B}),e(oe,{id:"generatedAccessToken","aria-controls":"generatedAccessToken",eventKey:2,title:r(le,{children:[n("generatedAccessToken")," ",e(I,{fieldLabelId:"clients:generatedAccessToken",helpText:"clients-help:generatedAccessToken",noVerticalAlign:!1,unWrap:!0})]}),tabContentRef:L}),e(oe,{id:"generatedIdToken","aria-controls":"generatedIdToken",eventKey:3,title:r(le,{children:[n("generatedIdToken")," ",e(I,{fieldLabelId:"clients:generatedIdToken",helpText:"clients-help:generatedIdToken",noVerticalAlign:!1,unWrap:!0})]}),tabContentRef:O}),e(oe,{id:"generatedUserInfo","aria-controls":"generatedUserInfo",eventKey:4,title:r(le,{children:[n("generatedUserInfo")," ",e(I,{fieldLabelId:"clients:generatedUserInfo",helpText:"clients-help:generatedUserInfo",noVerticalAlign:!1,unWrap:!0})]}),tabContentRef:P})]},y)})]})]})};const ra=({client:t})=>{const{t:i}=E("clients"),{adminClient:a}=se(),{addAlert:n,addError:s}=pe(),{realm:o}=ge(),[l,c]=u.exports.useState(),{hasAccess:m}=We(),g=m("manage-clients");ce(()=>a.clients.getServiceAccountUser({id:t.id}),f=>c(f),[]);const h=async f=>{try{const p=f.filter(d=>d.client===void 0).map(d=>d.role).flat();await a.users.addRealmRoleMappings({id:l?.id,roles:p}),await Promise.all(f.filter(d=>d.client!==void 0).map(d=>a.users.addClientRoleMappings({id:l?.id,clientUniqueId:d.client.id,roles:[d.role]}))),n(i("roleMappingUpdatedSuccess"),te.success)}catch(p){s("clients:roleMappingUpdatedError",p)}};return l?r(V,{children:[r(fe,{className:"pf-u-pb-0",children:[e(_n,{className:"pf-c-alert__icon keycloak--service-account--info-text"}),e("span",{className:"pf-u-pl-sm",children:r(Bn,{i18nKey:"clients-help:manageServiceAccountUser",children:["",e(ye,{to:yi({realm:o,id:l.id,tab:"settings"}),children:{link:l.username}})]})})]}),e(us,{name:t.clientId,id:l.id,type:"users",isManager:g||t.access?.configure,save:h})]}):e(Ne,{})},ca=({onChange:t,value:i,save:a,client:n,toggleDownloadDialog:s,toggleDeleteDialog:o})=>{const{t:l}=E("clients"),[c,m]=xe({titleKey:"clients:disableConfirmTitle",messageKey:"clients:disableConfirm",continueButtonLabel:"common:disable",onConfirm:()=>{t(!i),a()}}),g=u.exports.useMemo(()=>{const d=Fi(l,n.protocol??"openid-connect");return[{text:n.bearerOnly?e(Vt,{"data-testid":"bearer-only-explainer-tooltip",content:l("explainBearerOnly"),children:e(Kt,{"data-testid":"bearer-only-explainer-label",icon:e(_n,{}),children:d})}):e(Kt,{children:d})}]},[n,l]),{hasAccess:h}=We(),f=h("manage-clients")||n.access?.configure,p=[e(Ye,{onClick:s,children:l("downloadAdapterConfig")},"download"),e(Ye,{onClick:()=>Ti(n),children:l("common:export")},"export"),...!yt(n)&&f?[e(Ge,{},"divider"),e(Ye,{"data-testid":"delete-client",onClick:o,children:l("common:delete")},"delete")]:[]];return r(V,{children:[e(m,{}),e(Li,{titleKey:n.clientId,subKey:"clients:clientsExplain",badges:g,divider:!1,isReadOnly:!f,helpTextKey:"clients-help:enableDisable",dropdownItems:p,isEnabled:i,onToggle:d=>{d?(t(d),a()):c()}})]})};function Mo(){const{t}=E("clients"),{adminClient:i}=se(),{addAlert:a,addError:n}=pe(),{realm:s}=ge(),{profileInfo:o}=Be(),{hasAccess:l}=We(),c=!o?.disabledFeatures?.includes("ADMIN_FINE_GRAINED_AUTHZ")&&l("manage-authorization"),m=l("manage-clients"),g=l("view-users"),h=nt(),[f,p]=Te(),[d,T]=Te(),S=Pe(),{clientId:y}=$t(),[k,R]=u.exports.useState(0),G=Tt({control:S.control,name:"clientAuthenticatorType",defaultValue:"client-secret"}),[x,X]=u.exports.useState(),J=async()=>{const ae=await i.clients.listRoles({id:y});return wn(ae,dt=>dt.name?.toUpperCase())},N=ae=>Et(On({realm:s,clientId:y,tab:ae})),F=N("settings"),U=N("keys"),q=N("credentials"),A=N("roles"),C=N("clientScopes"),b=N("authorization"),B=N("serviceAccount"),L=N("sessions"),O=N("permissions"),P=N("advanced"),$=ae=>Et(nn({realm:s,clientId:y,tab:ae})),Q=$("setup"),ne=$("evaluate"),ie=ae=>Et(sn({realm:s,clientId:y,tab:ae})),we=ie("settings"),lt=ie("resources"),rt=ie("scopes"),Je=ie("policies"),ct=ie("permissions"),w=ie("evaluate"),me=ie("export"),[Z,be]=xe({titleKey:"clients:clientDeleteConfirmTitle",messageKey:"clients:clientDeleteConfirm",continueButtonLabel:"common:delete",continueButtonVariant:Ce.danger,onConfirm:async()=>{try{await i.clients.del({id:y}),a(t("clientDeletedSuccess"),te.success),h(Si({realm:s}))}catch(ae){n("clients:clientDeleteError",ae)}}}),Le=ae=>{S.reset({...ae}),Ii(ae,S.setValue),ae.attributes?.["acr.loa.map"]&&S.setValue(D("attributes.acr.loa.map"),Object.entries(JSON.parse(ae.attributes["acr.loa.map"])).flatMap(([dt,At])=>({key:dt,value:At})))};ce(()=>i.clients.findOne({id:y}),ae=>{if(!ae)throw new Error(t("common:notFound"));X(ki(ae)),Le(ae)},[y,k]);const Oe=async({confirmed:ae=!1,messageKey:dt="clientSaveSuccess"}={confirmed:!1,messageKey:"clientSaveSuccess"})=>{if(!await S.trigger())return;if(!x?.publicClient&&x?.clientAuthenticatorType!==G&&!ae){T();return}const At=an(S.getValues()),ft=an(At);ft.attributes?.["acr.loa.map"]&&(ft.attributes["acr.loa.map"]=JSON.stringify(Object.fromEntries(ft.attributes["acr.loa.map"].filter(({key:Ae})=>Ae!=="").map(({key:Ae,value:ai})=>[Ae,ai]))));try{const Ae={...x,...ft};Ae.clientId=Ae.clientId?.trim(),await i.clients.update({id:y},Ae),Le(Ae),X(Ae),a(t(dt),te.success)}catch(Ae){n("clients:clientSaveError",Ae)}};return x?r(V,{children:[e(Gt,{continueButtonLabel:"common:yes",cancelButtonLabel:"common:no",titleKey:t("changeAuthenticatorConfirmTitle",{clientAuthenticatorType:G}),open:d,toggleDialog:T,onConfirm:()=>Oe({confirmed:!0}),children:e(V,{children:t("changeAuthenticatorConfirm",{clientAuthenticatorType:G})})}),e(be,{}),f&&e(ps,{id:x.id,protocol:x.protocol,open:!0,toggleDialog:p}),e(K,{name:"enabled",control:S.control,defaultValue:!0,render:({field:ae})=>e(ca,{value:ae.value,onChange:ae.onChange,client:x,save:Oe,toggleDeleteDialog:Z,toggleDownloadDialog:p})}),e(fe,{variant:"light",className:"pf-u-p-0",children:e(Ke,{...S,children:r(Ot,{"data-testid":"client-tabs",isBox:!0,mountOnEnter:!0,children:[e(oe,{id:"settings","data-testid":"clientSettingsTab",title:e(le,{children:t("common:settings")}),...F,children:e(js,{client:x,save:()=>Oe(),reset:()=>Le(x)})}),(!x.publicClient&&!yt(x)||x.protocol==="saml")&&r(oe,{id:"keys","data-testid":"keysTab",title:e(le,{children:t("keys")}),...U,children:[x.protocol==="openid-connect"&&e(Xs,{clientId:y,save:Oe,hasConfigureAccess:x.access?.configure}),x.protocol==="saml"&&e(ia,{clientId:y,save:Oe})]}),!x.publicClient&&!yt(x)&&(m||x.access?.configure)&&e(oe,{id:"credentials",title:e(le,{children:t("credentials")}),...q,children:e(Ws,{client:x,save:Oe,refresh:()=>R(k+1)},k)}),e(oe,{id:"roles","data-testid":"rolesTab",title:e(le,{children:t("roles")}),...A,children:e(Pi,{loader:J,paginated:!1,messageBundle:"clients",toCreate:vi({realm:s,clientId:x.id}),toDetail:ae=>Ci({realm:s,clientId:x.id,id:ae,tab:"details"}),isReadOnly:!(m||x.access?.configure)})}),!yt(x)&&!x.bearerOnly&&e(oe,{id:"clientScopes","data-testid":"clientScopesTab",title:e(le,{children:t("clientScopes")}),...C,children:r(Ot,{defaultLocation:nn({realm:s,clientId:y,tab:"setup"}),children:[e(oe,{id:"setup",title:e(le,{children:t("setup")}),...Q,children:e(sa,{clientName:x.clientId,clientId:y,protocol:x.protocol,fineGrainedAccess:x.access?.manage})}),e(oe,{id:"evaluate",title:e(le,{children:t("evaluate")}),...ne,children:e(la,{clientId:y,protocol:x.protocol})})]})}),x.authorizationServicesEnabled&&e(oe,{id:"authorization","data-testid":"authorizationTab",title:e(le,{children:t("authorization")}),...b,children:r(Ot,{mountOnEnter:!0,unmountOnExit:!0,defaultLocation:sn({realm:s,clientId:y,tab:"settings"}),children:[e(oe,{id:"settings","data-testid":"authorizationSettings",title:e(le,{children:t("settings")}),...we,children:e(Fs,{clientId:y})}),e(oe,{id:"resources","data-testid":"authorizationResources",title:e(le,{children:t("resources")}),...lt,children:e(Ns,{clientId:y})}),e(oe,{id:"scopes","data-testid":"authorizationScopes",title:e(le,{children:t("scopes")}),...rt,children:e(Ks,{clientId:y})}),e(oe,{id:"policies","data-testid":"authorizationPolicies",title:e(le,{children:t("policies")}),...Je,children:e(_s,{clientId:y})}),e(oe,{id:"permissions","data-testid":"authorizationPermissions",title:e(le,{children:t("common:permissions")}),...ct,children:e(Ls,{clientId:y})}),e(oe,{id:"evaluate","data-testid":"authorizationEvaluate",title:e(le,{children:t("evaluate")}),...w,children:e(ws,{client:x,save:Oe})}),e(oe,{id:"export","data-testid":"authorizationExport",title:e(le,{children:t("common:export")}),...me,children:e(Os,{})})]})}),x.serviceAccountsEnabled&&g&&e(oe,{id:"serviceAccount","data-testid":"serviceAccountTab",title:e(le,{children:t("serviceAccount")}),...B,children:e(ra,{client:x})}),e(oe,{id:"sessions","data-testid":"sessionsTab",title:e(le,{children:t("sessions")}),...L,children:e(Bs,{client:x})}),c&&(m||x.access?.manage)&&e(oe,{id:"permissions","data-testid":"permissionsTab",title:e(le,{children:t("common:permissions")}),...O,children:e(Ei,{id:x.id,type:"clients"})}),e(oe,{id:"advanced","data-testid":"advancedTab",title:e(le,{children:t("advanced")}),...P,children:e(Cs,{save:Oe,client:x})})]})})})]}):e(Ne,{})}export{Mo as default};
//# sourceMappingURL=ClientDetails.d4a82208.js.map
