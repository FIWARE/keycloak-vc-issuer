import{u as v,az as F,aA as P,l as M,ax as Q,r as A,ad as V,aX as j,h as r,F as D,j as n,q as K,b3 as h,cl as x,aE as U,b1 as Y,P as Z,bN as R,c7 as ee,bE as k,bM as te,ah as ne,cm as ie,cn as ae}from"./index.7cbfb18a.js";import{u as $}from"./ConfirmDialog.4dc691c5.js";import{V as se,f as oe}from"./ViewHeader.083cd951.js";import{K as W}from"./KeycloakDataTable.ae870e97.js";import{j as L}from"./joinPath.69b856b1.js";import{L as re}from"./ListEmptyState.fef0510e.js";import{u as le,F as w}from"./useFormatDate.88f4c3f1.js";import{z as ce,ag as u,ai as E}from"./Td.1e0c90e7.js";import{i as me,g as de}from"./utils.988d95db.js";import{R as pe,u as ue}from"./RoutableTabs.58e36a71.js";import{T as B,a as N}from"./Tabs.fae3d04f.js";import{c as S}from"./HelpItem.719382e8.js";import"./Modal.11970fe7.js";import"./Text.28ece842.js";import"./EmptyStateBody.1533f3a6.js";import"./TableToolbar.51ae2a5f.js";import"./FormGroup.60c77f60.js";import"./EmptyStateSecondaryActions.511adeb0.js";import"./plus-circle-icon.aa8a939a.js";import"./star-icon.a6efdd26.js";import"./check.51c67984.js";import"./grip-vertical-icon.7e109111.js";import"./Checkbox.7d63c785.js";import"./plus-icon.f70ae4c8.js";import"./MenuList.22670a64.js";const fe=()=>({className:ce.modifiers.wrap}),ye=({rootUrl:e,baseUrl:a},l)=>a?.startsWith("http")?a:(e==="${authBaseUrl}"||e==="${authAdminUrl}")&&a?e.replace(/\$\{(authAdminUrl|authBaseUrl)\}/,L(l,a)):e?.startsWith("http")?a?L(e,a):e:a,he=()=>{const{t:e}=v("clients"),{adminClient:a}=F(),{addAlert:l,addError:c}=P(),{realm:s}=M(),f=le(),C=Q(),[m,d]=A.exports.useState(),T=async()=>{try{return await a.realms.getClientsInitialAccess({realm:s})}catch{return[]}},[g,y]=$({titleKey:"clients:tokenDeleteConfirmTitle",messageKey:e("tokenDeleteConfirm",{id:m?.id}),continueButtonLabel:"common:delete",continueButtonVariant:V.danger,onConfirm:async()=>{try{await a.realms.delClientsInitialAccess({realm:s,id:m.id}),l(e("tokenDeleteSuccess"),j.success),d(void 0)}catch(i){c("tokenDeleteError",i)}}});return r(D,{children:[n(y,{}),n(W,{ariaLabelKey:"clients:initialAccessToken",searchPlaceholderKey:"clients:searchInitialAccessToken",loader:T,toolbarItem:n(K,{component:i=>n(h,{...i,to:x({realm:s})}),children:e("common:create")}),actions:[{title:e("common:delete"),onRowClick:i=>{d(i),g()}}],columns:[{name:"id",displayKey:"common:id"},{name:"timestamp",displayKey:"clients:timestamp",cellRenderer:i=>f(new Date(i.timestamp*1e3),w)},{name:"expiration",displayKey:"clients:expires",cellRenderer:i=>f(new Date(i.timestamp*1e3+i.expiration*1e3),w)},{name:"count",displayKey:"clients:count"},{name:"remainingCount",displayKey:"clients:remainingCount",transforms:[fe]}],emptyState:n(re,{message:e("noTokens"),instructions:e("noTokensInstructions"),primaryActionText:e("common:create"),onPrimaryAction:()=>C(x({realm:s}))})},m?.id)]})};function _e(){const{t:e}=v("clients"),{addAlert:a,addError:l}=P(),{adminClient:c}=F(),{realm:s}=M(),[f,C]=A.exports.useState(0),m=()=>C(new Date().getTime()),[d,T]=A.exports.useState(),{hasAccess:g}=U(),y=g("manage-clients"),i=async(t,o,p)=>{const b={first:t,max:o};return p&&(b.clientId=p,b.search=!0),await c.clients.find({...b})},I=t=>ue(R({realm:s,tab:t})),_=I("list"),z=I("initial-access-token"),[O,q]=$({titleKey:e("clientDelete",{clientId:d?.clientId}),messageKey:"clients:clientDeleteConfirm",continueButtonLabel:"common:delete",continueButtonVariant:V.danger,onConfirm:async()=>{try{await c.clients.del({id:d.id}),a(e("clientDeletedSuccess"),j.success),m()}catch(t){l("clients:clientDeleteError",t)}}}),H=t=>r(h,{to:te({realm:s,clientId:t.id,tab:"settings"}),children:[t.clientId,!t.enabled&&n(ne,{isRead:!0,className:"pf-u-ml-sm",children:e("common:disabled")},`${t.id}-disabled`)]},t.id),X=t=>n(E,{wrapModifier:"truncate",children:k()(t.name)}),G=t=>n(E,{wrapModifier:"truncate",children:k()(t.description)}),J=()=>y?r(D,{children:[n(S,{children:n(K,{component:t=>n(h,{...t,to:ie({realm:s})}),children:e("createClient")})}),n(S,{children:n(K,{component:t=>n(h,{...t,to:ae({realm:s})}),variant:"link","data-testid":"importClient",children:e("importClient")})})]}):n("span",{});return r(D,{children:[n(se,{titleKey:"clients:clientList",subKey:"clients:clientsExplain",helpUrl:Y.clientsUrl,divider:!1}),n(Z,{variant:"light",className:"pf-u-p-0",children:r(pe,{mountOnEnter:!0,isBox:!0,defaultLocation:R({realm:s,tab:"list"}),children:[r(B,{"data-testid":"list",title:n(N,{children:e("clientsList")}),..._,children:[n(q,{}),n(W,{loader:i,isPaginated:!0,ariaLabelKey:"clients:clientList",searchPlaceholderKey:"clients:searchForClient",toolbarItem:n(J,{}),actionResolver:t=>{const o=t.data,p=[{title:e("common:export"),onClick(){ee(o)}}];return!me(o)&&(y||o.access?.configure)&&p.push({title:e("common:delete"),onClick(){T(o),O()}}),p},columns:[{name:"clientId",displayKey:"common:clientId",transforms:[u(20)],cellRenderer:H},{name:"clientName",displayKey:"common:clientName",transforms:[u(20)],cellRenderer:X},{name:"protocol",displayKey:"common:type",transforms:[u(10)],cellRenderer:t=>de(e,t.protocol??"openid-connect")},{name:"description",displayKey:"common:description",transforms:[u(30)],cellRenderer:G},{name:"baseUrl",displayKey:"clients:homeURL",transforms:[u(20)],cellFormatters:[oe(),k()],cellRenderer:t=>ye(t,c.baseUrl)}]},f)]}),n(B,{"data-testid":"initialAccessToken",title:n(N,{children:e("initialAccessToken")}),...z,children:n(he,{})})]})})]})}export{_e as default};
//# sourceMappingURL=ClientsSection.9121bc7f.js.map
